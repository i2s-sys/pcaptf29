import matplotlib.pyplot as plt

# 数据
epochs = list(range(100))
# N=2的e100
k_values = {
    16: [0, 11, 15, 15, 16, 16, 16, 15, 16, 16, 15, 16, 15, 15, 16, 16, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 15, 16, 16, 16, 16, 16, 15, 16, 15, 16, 16, 16, 16, 16, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 15, 16, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16],
    24: [0, 23, 21, 24, 22, 23, 23, 24, 24, 23, 24, 24, 24, 24, 23, 24, 24, 24, 24, 23, 24, 24, 24, 23, 22, 22, 24, 23, 24, 23, 24, 22, 23, 24, 23, 24, 23, 23, 23, 22, 23, 23, 23, 24, 24, 24, 23, 23, 24, 24, 24, 23, 23, 24, 24, 24, 22, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 23, 24, 23, 24, 24, 24, 24, 24, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 23, 23, 24, 24, 23, 24, 23, 24, 23, 23, 24, 24, 24, 23],
    32: [0, 30, 28, 32, 31, 32, 32, 32, 31, 31, 31, 29, 30, 31, 31, 32, 32, 31, 32, 32, 32, 32, 32, 31, 31, 31, 31, 32, 31, 32, 32, 32, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 31, 31, 32, 32, 31, 32, 32, 31, 31, 32, 32, 31, 32, 32, 32, 32, 32, 32, 31, 31, 31, 32, 32, 31, 31, 32, 32, 31, 31, 32, 32, 32],
    40: [0, 36, 39, 38, 39, 39, 40, 40, 39, 39, 39, 40, 39, 40, 40, 40, 39, 38, 40, 39, 39, 39, 40, 40, 40, 40, 40, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 39, 40, 40, 39, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 39, 39, 40, 39, 40, 39, 39, 39, 39, 40, 40, 40, 40, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40]
}

# N=5的时候的e100
# k_values = {
#     16: [0, 15, 14, 13, 13, 11, 12, 13, 13, 15, 15, 15, 15, 14, 15, 15, 15, 15, 15, 14, 14, 15, 15, 15, 15, 15, 15, 15, 15, 14, 15, 15, 14, 15, 15, 15, 15, 15, 15, 15, 14, 15, 14, 14, 14, 14, 14, 14, 15, 14, 15, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 15, 15, 15, 15, 14, 15, 15, 14, 14, 14, 14, 14, 15, 15, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16, 16],
#     24: [0, 21, 20, 19, 18, 21, 21, 22, 22, 23, 23, 23, 22, 22, 23, 23, 22, 23, 22, 22, 23, 23, 24, 24, 24, 23, 22, 22, 21, 22, 23, 23, 23, 22, 22, 23, 23, 23, 23, 23, 23, 24, 24, 24, 23, 23, 23, 23, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 24, 23, 23, 23, 23, 23, 24, 23, 23, 23, 23, 23, 23, 23, 23, 22, 22, 21, 22, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23, 23],
#     32: [0, 30, 27, 27, 26, 28, 31, 31, 32, 31, 30, 30, 30, 31, 30, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 32, 32, 31, 30, 30, 28, 28, 29, 29, 30, 31, 31, 31, 32, 32, 32, 31, 31, 31, 31, 31, 30, 29, 30, 30, 31, 32, 32, 32, 32, 32, 31, 30, 30, 29, 30, 30, 31, 32, 32, 32, 32, 32, 32, 32, 32, 31, 31, 31, 30, 30, 30, 30, 29, 30, 30, 30, 30, 30, 30, 30, 31, 32, 32, 32, 32, 31, 31, 31, 31, 32, 32, 32, 31],
#     40: [0, 37, 36, 34, 34, 37, 38, 38, 38, 38, 37, 37, 36, 37, 38, 38, 39, 38, 38, 38, 39, 40, 39, 39, 39, 39, 39, 39, 39, 39, 40, 40, 40, 40, 39, 38, 38, 38, 38, 38, 39, 39, 39, 39, 39, 39, 39, 39, 38, 38, 39, 39, 39, 39, 39, 40, 40, 39, 39, 39, 39, 39, 39, 39, 39, 39, 40, 40, 40, 40, 39, 38, 38, 38, 38, 38, 39, 40, 40, 40, 40, 40, 39, 39, 39, 39, 39, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40]
# }
# epochs = list(range(4,100))
# k_values = {
#     16: [11, 13, 15, 16, 14, 14, 13, 11, 13, 13, 14, 15, 15, 15, 15, 14, 14, 15, 15, 16, 16, 16, 16, 15, 15, 13],
#     24: [18, 21, 21, 22, 21, 22, 21, 22, 22, 23, 24, 24, 24, 24, 24, 24, 24, 23, 23, 22, 21, 22, 22, 23, 24, 23],
#     32: [25, 27, 29, 30, 30, 31, 29, 29, 29, 28, 30, 29, 29, 30, 30, 31, 32, 32, 31, 31, 31, 31, 30, 30, 30, 30],
#     40: [36, 35, 36, 37, 37, 38, 38, 38, 37, 38, 38, 38, 38, 38, 39, 39, 39, 38, 38, 38, 39, 40, 40, 40, 40, 40]
# }  # e4-30

# 绘制函数
def plot_early_stopping(k, values):
    plt.figure()
    plt.plot(epochs, values, label=f'K={k}')
    early_stop_epoch = epochs[values.index(k)]
    early_stop_value = values[values.index(k)]
    plt.axvline(x=early_stop_epoch, color='red', linestyle='--', label='Early Stopping')
    plt.text(early_stop_epoch, early_stop_value, f'Epoch={early_stop_epoch}', color='red', ha='right')
    plt.xlabel('Epoch')
    plt.ylabel('TSM Value')
    plt.title(f'Early Stopping for K={k}')
    plt.legend()
    plt.show()

# 绘制所有图
for k, values in k_values.items():
    plot_early_stopping(k, values)

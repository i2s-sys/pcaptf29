2024-11-18 10:58:43.582052: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPacket_ES3_8.py
2024-11-18 10:58:45.742425: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-18 10:58:45.750565: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 10:58:45.753064: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-18 10:58:45.765876: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-18 10:58:45.765926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 10:58:45.769867: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 10:58:45.769931: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 10:58:45.771092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 10:58:45.771407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 10:58:45.774339: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 10:58:45.775059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 10:58:45.775249: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 10:58:45.775669: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 10:58:45.775702: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 10:58:46.390640: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-18 10:58:46.390694: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-18 10:58:46.390704: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-18 10:58:46.391470: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21291 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
init data completed!
2024-11-18 11:00:41.283797: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 11:00:41.284712: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-18 11:00:41.284757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 11:00:41.284825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 11:00:41.284845: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 11:00:41.284864: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 11:00:41.284898: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 11:00:41.284918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 11:00:41.284938: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 11:00:41.284958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 11:00:41.285279: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 11:00:41.335809: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 11:00:41.336267: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-18 11:00:41.336303: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 11:00:41.336338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 11:00:41.336352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 11:00:41.336366: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 11:00:41.336379: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 11:00:41.336393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 11:00:41.336407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 11:00:41.336421: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 11:00:41.336727: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 11:00:41.336778: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-18 11:00:41.336788: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-18 11:00:41.336796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-18 11:00:41.337155: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21291 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-18 11:00:41.718241: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-18 11:00:41.734224: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-18 11:00:42.610083: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 11:00:43.173807: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 11:00:43.177752: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 11:00:45.430957: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-18 11:00:45.577764: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-18 11:01:18.430733: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 7.269213738540809, duration: 170.86 seconds
Macro-F1: 0.9647930638437009
Micro-F1: 0.9609681940188604
Epoch 2 completed, average loss: 0.6317781256276368, duration: 83.85 seconds
Macro-F1: 0.8981409677143543
Micro-F1: 0.9045297988075727
Epoch 3 completed, average loss: 0.49027620530707905, duration: 83.56 seconds
Macro-F1: 0.9985821174321884
Micro-F1: 0.9983847597330103
Epoch 3, Intersection size: 6
Epoch 4 completed, average loss: 0.1564712164234705, duration: 85.43 seconds
Macro-F1: 0.9997761611168764
Micro-F1: 0.9997814674932897
Epoch 4, Intersection size: 7
Epoch 5 completed, average loss: 0.5797580388962741, duration: 85.42 seconds
Macro-F1: 0.9992952140357864
Micro-F1: 0.9993729067198746
Epoch 5, Intersection size: 8
Epoch 6 completed, average loss: 0.19725243229946185, duration: 77.94 seconds
Macro-F1: 0.9998168499822203
Micro-F1: 0.9998479773866362
Epoch 6, Intersection size: 8
Epoch 7 completed, average loss: 0.3090208447889049, duration: 75.84 seconds
Macro-F1: 0.9998936402019939
Micro-F1: 0.9999287393999857
Epoch 7, Intersection size: 8
Epoch 8 completed, average loss: 0.2094675578101246, duration: 84.58 seconds
Macro-F1: 0.9998974027681341
Micro-F1: 0.9999287393999857
Epoch 8, Intersection size: 7
Epoch 9 completed, average loss: 0.21192604784725358, duration: 84.88 seconds
Macro-F1: 0.9998173839530199
Micro-F1: 0.9998669802133068
Epoch 9, Intersection size: 7
Epoch 10 completed, average loss: 0.15703440908462019, duration: 84.49 seconds
Macro-F1: 0.9998969793225966
Micro-F1: 0.9999287393999857
Epoch 10, Intersection size: 6
Epoch 11 completed, average loss: 0.10531307773405853, duration: 84.67 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 11, Intersection size: 6
Epoch 12 completed, average loss: 0.24862640845820652, duration: 85.08 seconds
Macro-F1: 0.9998864075869026
Micro-F1: 0.9999144872799829
Epoch 12, Intersection size: 7
Epoch 13 completed, average loss: 0.16435671738303512, duration: 84.87 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 13, Intersection size: 6
Epoch 14 completed, average loss: 0.11607902473946055, duration: 85.06 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 14, Intersection size: 7
Epoch 15 completed, average loss: 0.12676324565832522, duration: 75.07 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 15, Intersection size: 7
Epoch 16 completed, average loss: 0.10886341528343228, duration: 84.58 seconds
Macro-F1: 0.9998812344334236
Micro-F1: 0.9999239886933181
Epoch 16, Intersection size: 8
Epoch 17 completed, average loss: 0.10631357427372856, duration: 84.47 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 17, Intersection size: 7
Epoch 18 completed, average loss: 0.18435699438905853, duration: 84.81 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 18, Intersection size: 7
Epoch 19 completed, average loss: 0.1073221550991767, duration: 72.60 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 19, Intersection size: 8
Epoch 20 completed, average loss: 0.15850889358105436, duration: 73.64 seconds
Macro-F1: 0.9999037462065137
Micro-F1: 0.9999382408133209
Epoch 20, Intersection size: 8
TSMRecord—100 [6, 7, 8, 8, 8, 7, 7, 6, 6, 7, 6, 7, 7, 8, 7, 7, 8, 8]
loss_history—100 [7.269213738540809, 0.6317781256276368, 0.49027620530707905, 0.1564712164234705, 0.5797580388962741, 0.19725243229946185, 0.3090208447889049, 0.2094675578101246, 0.21192604784725358, 0.15703440908462019, 0.10531307773405853, 0.24862640845820652, 0.16435671738303512, 0.11607902473946055, 0.12676324565832522, 0.10886341528343228, 0.10631357427372856, 0.18435699438905853, 0.1073221550991767, 0.15850889358105436]
Total training time: 26949.77 seconds
scaling_factor_value： [[ 9.7271895e-01  1.0405983e+00  9.6879524e-01  9.0002376e-01
   1.0102718e+00  9.9007440e-01  9.8542136e-01  1.0236359e+00
   9.7467345e-01  9.9512696e-01  9.6832025e-01  1.0351905e+00
   9.2699903e-01  9.7453505e-01  1.0310649e+00  9.3102312e-01
   9.6594465e-01  9.0341192e-01  8.9613640e-01  9.7030723e-01
   9.7485387e-01  1.0059991e+00  1.0074450e+00  1.0104883e+00
   1.0142852e+00  1.0289494e+00  9.6057028e-01  1.0001613e+00
   1.0415802e+00  9.6241623e-01  9.3186754e-01  1.0074985e+00
  -1.2219772e-09  9.7227824e-01 -2.1805647e-07  6.6488564e-01
   9.6361250e-01  9.0867323e-01  9.6701097e-01 -1.1980406e-06
   9.5647538e-01 -6.4852334e-06  8.6669898e-01  9.8812097e-01
   9.4181788e-01  9.4362956e-01 -3.1669404e-06  9.7501034e-01
  -7.0503484e-07  9.5430249e-01  1.0150236e+00  1.0173777e+00
   1.0023302e+00  7.1719515e-01  9.8746079e-01 -1.4813686e-06
   7.3659825e-01  9.2297310e-01  9.4584399e-01  9.4156402e-01
   4.3582347e-01  9.5515865e-01  7.6480160e-07  7.1146148e-01
   9.0208542e-01  1.3696997e-01  9.9350983e-01  7.6242775e-01
   5.7988203e-01  9.8957348e-01  6.8991113e-01  6.7752200e-01
   9.7038704e-01  7.4704719e-01  9.9125952e-01  9.7890103e-01
   8.2167643e-01  8.9456427e-01  9.5798647e-01  7.0634395e-01
   1.1870202e-05  9.3050903e-01  9.0712128e-06  9.6729779e-01
   1.3225696e-05 -4.1325592e-07  4.8726887e-01  2.9893508e-06
   9.0849650e-01  2.8766899e-06  9.1285455e-01 -1.5792428e-05
  -3.1573284e-06 -4.4690482e-06  4.9112118e-06  8.5690719e-01
   1.5984524e-05  9.1641736e-01 -1.6398526e-05  3.2172239e-01
   5.0414962e-01  7.9400772e-01  1.0006797e+00 -1.0413620e-05
   9.9184829e-01 -6.8634799e-06  2.2546725e-05  1.5210442e-05
   1.4042929e-05  9.0407479e-01 -7.0707788e-06  6.6404134e-01
  -1.1231514e-06 -3.0014789e-06 -1.9358589e-05]]
start testing...
sorted_indices： [ 28   1  11  14  25   7  51  50  24  23   4  31  22  21  52 102  27   9
  66 104  74   5  69  43  54   6  75  47  20   8  13   0  33  72  19   2
  10  83  38  16  36  29  26  78  40  61  49  58  45  44  59  30  15  81
  12  57  97  90  37  88 109  17  64   3  18  77  42  95  76 101  67  73
  56  53  63  79  70  71  35 111  68 100  86  60  99  65 106  96 107 108
  84  80  82  94  87  89  62  32  34  85  48 112  39  55 113  92  46  93
  41 105 110 103  91  98 114]
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 0.9999324826142731 14810 14811
1 1.0 30657 30657
2 0.9998914636131763 36850 36854
3 0.9999072184078679 32331 32334
4 0.9999719180005616 71218 71220
5 0.9998781428977619 24616 24619
Top-1 accuracy: 0.9999382408133209
Top-3 accuracy: 0.9999904985866648
Top-5 accuracy: 1.0
Macro-F1: 0.9999037462065137
Micro-F1: 0.9999382408133209
loss_history [7.269213738540809, 0.6317781256276368, 0.49027620530707905, 0.1564712164234705, 0.5797580388962741, 0.19725243229946185, 0.3090208447889049, 0.2094675578101246, 0.21192604784725358, 0.15703440908462019, 0.10531307773405853, 0.24862640845820652, 0.16435671738303512, 0.11607902473946055, 0.12676324565832522, 0.10886341528343228, 0.10631357427372856, 0.18435699438905853, 0.1073221550991767, 0.15850889358105436]
macro_F1List [0.9609681940188604, 0.9045297988075727, 0.9983847597330103, 0.9997814674932897, 0.9993729067198746, 0.9998479773866362, 0.9999287393999857, 0.9999287393999857, 0.9998669802133068, 0.9999287393999857, 0.9999429915199886, 0.9999144872799829, 0.9999429915199886, 0.9999429915199886, 0.9999382408133209, 0.9999239886933181, 0.9999382408133209, 0.9999382408133209, 0.9999382408133209, 0.9999382408133209]
micro_F1List [0.9647930638437009, 0.8981409677143543, 0.9985821174321884, 0.9997761611168764, 0.9992952140357864, 0.9998168499822203, 0.9998936402019939, 0.9998974027681341, 0.9998173839530199, 0.9998969793225966, 0.999911950071283, 0.9998864075869026, 0.999911950071283, 0.999911950071283, 0.999905846928069, 0.9998812344334236, 0.999905846928069, 0.999905846928069, 0.999905846928069, 0.9999037462065137]
starting retraining
K= 8 top_k_indices [28  1 11 14 25  7 51 50]
init data completed!
2024-11-18 19:29:36.975803: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 19:29:36.976440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-18 19:29:36.976547: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 19:29:36.976701: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 19:29:36.976725: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 19:29:36.976754: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 19:29:36.976945: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 19:29:36.977081: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 19:29:36.977206: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 19:29:36.977240: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 19:29:36.977601: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 19:29:36.977697: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-18 19:29:36.977708: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-18 19:29:36.977721: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-18 19:29:36.978091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21291 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
start retraining...

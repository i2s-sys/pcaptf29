2024-11-18 10:56:41.716458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPacket_ES3_1.py
2024-11-18 10:56:43.885726: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-18 10:56:43.894220: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 10:56:43.895237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-18 10:56:43.901524: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-18 10:56:43.901556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 10:56:43.904591: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 10:56:43.904658: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 10:56:43.905834: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 10:56:43.906127: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 10:56:43.909174: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 10:56:43.909858: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 10:56:43.910033: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 10:56:43.910420: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 10:56:43.910451: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 10:56:44.567170: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-18 10:56:44.567223: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-18 10:56:44.567232: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-18 10:56:44.567955: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 20412 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
init data completed!
2024-11-18 10:58:37.232304: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 10:58:37.233196: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-18 10:58:37.233239: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 10:58:37.233300: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 10:58:37.233320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 10:58:37.233340: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 10:58:37.233370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 10:58:37.233388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 10:58:37.233408: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 10:58:37.233428: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 10:58:37.233756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 10:58:37.293640: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 10:58:37.294031: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-18 10:58:37.294067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 10:58:37.294107: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 10:58:37.294123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 10:58:37.294139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 10:58:37.294155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 10:58:37.294171: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 10:58:37.294186: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 10:58:37.294203: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 10:58:37.294513: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 10:58:37.294561: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-18 10:58:37.294570: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-18 10:58:37.294578: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-18 10:58:37.294937: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 20412 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-18 10:58:37.752757: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-18 10:58:37.768379: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-18 10:58:38.699837: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 10:58:39.300855: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 10:58:39.319558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 10:58:57.157060: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-18 10:58:57.313419: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-18 10:59:29.147324: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 6.93805988231984, duration: 162.89 seconds
Macro-F1: 0.8974259278627392
Micro-F1: 0.9040357253141404
Epoch 2 completed, average loss: 0.6601159511629666, duration: 71.55 seconds
Macro-F1: 0.9907283868561341
Micro-F1: 0.9892919071711918
Epoch 3 completed, average loss: 0.4916743439352074, duration: 70.86 seconds
Macro-F1: 0.9981077305712401
Micro-F1: 0.9987363120264139
Epoch 3, Intersection size: 0
Epoch 4 completed, average loss: 0.1565075792490675, duration: 71.19 seconds
Macro-F1: 0.9971254410328031
Micro-F1: 0.9982089835863085
Epoch 4, Intersection size: 1
Epoch 5 completed, average loss: 0.25221079750074393, duration: 71.66 seconds
Macro-F1: 0.9997841895798542
Micro-F1: 0.9997957196132925
Epoch 5, Intersection size: 1
Epoch 6 completed, average loss: 0.2969064538638698, duration: 71.38 seconds
Macro-F1: 0.9981782684945495
Micro-F1: 0.9978479298795696
Epoch 6, Intersection size: 0
Epoch 7 completed, average loss: 0.12079099433121347, duration: 70.84 seconds
Macro-F1: 0.9997674982968136
Micro-F1: 0.9997719660799544
Epoch 7, Intersection size: 0
Epoch 8 completed, average loss: 0.24867013277782574, duration: 60.32 seconds
Macro-F1: 0.9997091283009834
Micro-F1: 0.9997007054799402
Epoch 8, Intersection size: 0
Epoch 9 completed, average loss: 0.24463637540559144, duration: 70.90 seconds
Macro-F1: 0.9994521239375737
Micro-F1: 0.9993871588398774
Epoch 9, Intersection size: 0
Epoch 10 completed, average loss: 0.13013437618679885, duration: 70.49 seconds
Macro-F1: 0.9991406970869675
Micro-F1: 0.9990023515998004
Epoch 10, Intersection size: 0
Epoch 11 completed, average loss: 0.13787574941816197, duration: 70.23 seconds
Macro-F1: 0.9997935210448383
Micro-F1: 0.9998004703199601
Epoch 11, Intersection size: 0
Epoch 12 completed, average loss: 0.1301466190091856, duration: 70.58 seconds
Macro-F1: 0.9999046301942051
Micro-F1: 0.9999334901066533
Epoch 12, Intersection size: 0
Epoch 13 completed, average loss: 0.1581731497453065, duration: 70.96 seconds
Macro-F1: 0.9993373652539704
Micro-F1: 0.9992446376398489
Epoch 13, Intersection size: 0
Epoch 14 completed, average loss: 0.12712297343535134, duration: 69.16 seconds
Macro-F1: 0.9995400156447819
Micro-F1: 0.999491674386565
Epoch 14, Intersection size: 1
Epoch 15 completed, average loss: 0.09826873796454376, duration: 69.15 seconds
Macro-F1: 0.9999002847518746
Micro-F1: 0.9999287393999857
Epoch 15, Intersection size: 1
Epoch 16 completed, average loss: 0.16099619501917692, duration: 66.96 seconds
Macro-F1: 0.9998903230975554
Micro-F1: 0.9999239886933181
Epoch 16, Intersection size: 1
Epoch 17 completed, average loss: 0.149571043112749, duration: 65.90 seconds
Macro-F1: 0.9994737862096256
Micro-F1: 0.9994109123732156
Epoch 17, Intersection size: 1
Epoch 18 completed, average loss: 0.09972326783329861, duration: 59.29 seconds
Macro-F1: 0.9997307948118198
Micro-F1: 0.9997244590132782
Epoch 18, Intersection size: 1
Epoch 19 completed, average loss: 0.10925757600315418, duration: 66.29 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 19, Intersection size: 0
Epoch 20 completed, average loss: 0.12237908645342004, duration: 69.88 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 20, Intersection size: 0
TSMRecord—100 [0, 1, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 1, 1, 1, 1, 0, 0]
loss_history—100 [6.93805988231984, 0.6601159511629666, 0.4916743439352074, 0.1565075792490675, 0.25221079750074393, 0.2969064538638698, 0.12079099433121347, 0.24867013277782574, 0.24463637540559144, 0.13013437618679885, 0.13787574941816197, 0.1301466190091856, 0.1581731497453065, 0.12712297343535134, 0.09826873796454376, 0.16099619501917692, 0.149571043112749, 0.09972326783329861, 0.10925757600315418, 0.12237908645342004]
Total training time: 22881.36 seconds
scaling_factor_value： [[ 9.68691289e-01  1.01989710e+00  9.77708936e-01  9.21501279e-01
   9.94649589e-01  1.00335371e+00  9.47314024e-01  1.00356793e+00
   9.80241597e-01  1.01057041e+00  9.54553425e-01  1.02121997e+00
   9.14690733e-01  9.83719647e-01  1.02814162e+00  9.50611174e-01
   9.53437269e-01  8.46836507e-01  9.46240544e-01  9.26626027e-01
   9.96020675e-01  1.02361250e+00  9.96521354e-01  9.99405801e-01
   1.03118491e+00  1.02929604e+00  9.84918416e-01  9.77498829e-01
   1.02665377e+00  9.70013261e-01  9.24749374e-01  1.00743353e+00
  -1.57832051e-06  9.91460085e-01 -3.13057262e-06  2.42929976e-03
   9.74646866e-01  8.20406377e-01  9.42364991e-01  1.59191295e-05
   8.95582616e-01  5.53656446e-06  9.46400881e-01  1.00488436e+00
   9.82135475e-01  9.45116580e-01  1.43545385e-05  9.92225289e-01
  -1.44408095e-05  9.85013723e-01  1.01296496e+00  1.00593841e+00
   9.75137770e-01  2.05886841e-01  9.67793882e-01 -5.84652298e-07
   7.66721249e-01  9.63108480e-01  9.82663393e-01  9.19070244e-01
   8.28735605e-02  9.46890771e-01  7.16703057e-01  6.57200694e-01
   9.22146797e-01  6.11005500e-02  9.60461974e-01  3.54428291e-01
   5.89334965e-01  9.89650846e-01  7.39297092e-01 -3.48294407e-06
   9.81480122e-01  7.04029024e-01  8.23539078e-01  9.75033641e-01
   8.07481527e-01  8.54218841e-01  9.82360423e-01  7.05221474e-01
  -5.70871453e-06  9.87135351e-01  1.12549387e-05  9.62450862e-01
  -1.11778445e-06  4.88230526e-01  8.19662154e-01 -8.31485158e-06
   8.31504464e-01  8.83440043e-06  7.89547920e-01  2.91746637e-05
   1.38026431e-01  3.35245639e-01 -1.20653604e-05  6.17655337e-01
  -1.27808710e-06  9.31835890e-01  5.56017312e-07  6.73667610e-01
   7.81802833e-01  9.23499525e-01  9.94128764e-01 -2.13040357e-06
   9.91086006e-01  1.66624723e-05  7.00520104e-07 -1.11904319e-06
  -3.15529815e-06  7.95844138e-01  3.02336548e-06  6.38692081e-01
  -1.79001040e-06  2.68034864e-06 -1.28457032e-07]]
start testing...
sorted_indices： [ 24  25  14  28  21  11   1  50   9  31  51  43   7   5  23  22  20   4
 102  47  33 104  69  81  49  26  13  58  78  44  72   8   2  27  52  75
  36  29   0  54  57  83  66  10  16  15   6  61  42  18  45  38  97  19
  30 101  64   3  59  12  40  77  17  88  74  37  86  76 109  90 100  56
  70  62  79  73  99  63 111  95  68  85  67  93  53  92  60  65  35  91
 105  39  46  82  89  41 110 113 106  98 114  55  84 107  96  32 112 103
  34 108  71  80  87  94  48]
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 1.0 14811 14811
1 0.9999673810222788 30656 30657
2 0.9998914636131763 36850 36854
3 0.9999072184078679 32331 32334
4 0.9999719180005616 71218 71220
5 0.9998781428977619 24616 24619
Top-1 accuracy: 0.9999382408133209
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
loss_history [6.93805988231984, 0.6601159511629666, 0.4916743439352074, 0.1565075792490675, 0.25221079750074393, 0.2969064538638698, 0.12079099433121347, 0.24867013277782574, 0.24463637540559144, 0.13013437618679885, 0.13787574941816197, 0.1301466190091856, 0.1581731497453065, 0.12712297343535134, 0.09826873796454376, 0.16099619501917692, 0.149571043112749, 0.09972326783329861, 0.10925757600315418, 0.12237908645342004]
macro_F1List [0.9040357253141404, 0.9892919071711918, 0.9987363120264139, 0.9982089835863085, 0.9997957196132925, 0.9978479298795696, 0.9997719660799544, 0.9997007054799402, 0.9993871588398774, 0.9990023515998004, 0.9998004703199601, 0.9999334901066533, 0.9992446376398489, 0.999491674386565, 0.9999287393999857, 0.9999239886933181, 0.9994109123732156, 0.9997244590132782, 0.9999382408133209, 0.9999382408133209]
micro_F1List [0.8974259278627392, 0.9907283868561341, 0.9981077305712401, 0.9971254410328031, 0.9997841895798542, 0.9981782684945495, 0.9997674982968136, 0.9997091283009834, 0.9994521239375737, 0.9991406970869675, 0.9997935210448383, 0.9999046301942051, 0.9993373652539704, 0.9995400156447819, 0.9999002847518746, 0.9998903230975554, 0.9994737862096256, 0.9997307948118198, 0.999905846928069, 0.999905846928069]
starting retraining
K= 1 top_k_indices [24]
init data completed!
2024-11-18 17:43:11.248032: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-18 17:43:11.248796: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-18 17:43:11.248840: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-18 17:43:11.248908: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-18 17:43:11.248926: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-18 17:43:11.248948: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-18 17:43:11.248970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-18 17:43:11.248987: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-18 17:43:11.249011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-18 17:43:11.249030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-18 17:43:11.249366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-18 17:43:11.249439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-18 17:43:11.249450: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-18 17:43:11.249457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-18 17:43:11.249825: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 20412 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
start retraining...
Macro-F1: 0.8257009871117947
Micro-F1: 0.8080286942682724
Epoch 1 completed, average loss: 22.92690097677771, duration: 7185.76 seconds
Macro-F1: 0.8441733816705854
Micro-F1: 0.8202807667640561
Epoch 2 completed, average loss: 21.020271770028916, duration: 1157.21 seconds
Macro-F1: 0.8533579271416601
Micro-F1: 0.8262381529252476
Epoch 3 completed, average loss: 20.885878832642017, duration: 1006.59 seconds

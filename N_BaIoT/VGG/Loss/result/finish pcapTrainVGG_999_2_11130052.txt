2024-11-13 00:52:24.998991: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_999_2.py
2024-11-13 00:52:27.294723: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-13 00:52:27.303795: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-13 00:52:27.306471: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-13 00:52:27.317597: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-13 00:52:27.317650: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-13 00:52:27.321403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-13 00:52:27.321486: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-13 00:52:27.322817: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-13 00:52:27.323160: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-13 00:52:27.326411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-13 00:52:27.327173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-13 00:52:27.327378: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-13 00:52:27.327808: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-13 00:52:27.327844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-13 00:52:28.169794: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-13 00:52:28.169862: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-13 00:52:28.169872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-13 00:52:28.170608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15710 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 2
init data completed!
2024-11-13 00:54:26.570636: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-13 00:54:26.571608: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-13 00:54:26.571659: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-13 00:54:26.571724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-13 00:54:26.571743: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-13 00:54:26.571760: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-13 00:54:26.571791: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-13 00:54:26.571808: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-13 00:54:26.571825: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-13 00:54:26.571844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-13 00:54:26.572165: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-13 00:54:26.622583: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-13 00:54:26.622965: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-13 00:54:26.623016: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-13 00:54:26.623060: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-13 00:54:26.623076: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-13 00:54:26.623092: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-13 00:54:26.623108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-13 00:54:26.623123: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-13 00:54:26.623139: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-13 00:54:26.623155: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-13 00:54:26.623459: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-13 00:54:26.623520: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-13 00:54:26.623531: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-13 00:54:26.623539: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-13 00:54:26.623901: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15710 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-13 00:54:27.002051: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-13 00:54:27.019509: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-13 00:54:27.896263: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-13 00:54:28.632030: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-13 00:54:28.636372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-13 00:54:31.510665: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-13 00:54:31.697741: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-13 00:55:08.295431: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 7.6071245420762015, duration: 170.56 seconds
Macro-F1: 0.889673858925295
Micro-F1: 0.8930045844319342
Epoch 2 completed, average loss: 0.591742170962203, duration: 74.92 seconds
Macro-F1: 0.9970925642040974
Micro-F1: 0.9970783153994157
Epoch 3 completed, average loss: 0.23711301707982124, duration: 76.29 seconds
Macro-F1: 0.9635967890087769
Micro-F1: 0.9769163163020499
Epoch 4 completed, average loss: 0.052823030300294394, duration: 88.14 seconds
Macro-F1: 0.9992673644226665
Micro-F1: 0.9994156630798832
Epoch 5 completed, average loss: 0.12952788556388084, duration: 76.21 seconds
Macro-F1: 0.9993067547403691
Micro-F1: 0.9993206489465308
Epoch 6 completed, average loss: 0.054159639713554746, duration: 88.86 seconds
Macro-F1: 0.9995445042001115
Micro-F1: 0.9995676856932468
Epoch 7 completed, average loss: 0.03371883920276682, duration: 75.61 seconds
Macro-F1: 0.9988816865813751
Micro-F1: 0.9990166037198033
Epoch 8 completed, average loss: 0.04992101015743032, duration: 77.93 seconds
Macro-F1: 0.9989799978368205
Micro-F1: 0.9992113826931757
Epoch 9 completed, average loss: 0.0651335430297318, duration: 88.87 seconds
Macro-F1: 0.9992009532442161
Micro-F1: 0.9992968954131927
Epoch 10 completed, average loss: 0.027517282826565518, duration: 75.48 seconds
Macro-F1: 0.9995357246304611
Micro-F1: 0.9995391814532412
Epoch 11 completed, average loss: 0.02275413399885097, duration: 89.48 seconds
Macro-F1: 0.999613123136989
Micro-F1: 0.9996531984132639
Epoch 12 completed, average loss: 0.021838848568037795, duration: 77.47 seconds
Macro-F1: 0.9996113671733503
Micro-F1: 0.9996294448799259
Epoch 13 completed, average loss: 0.05112135329643958, duration: 78.97 seconds
Macro-F1: 0.9995047708423309
Micro-F1: 0.9994869236798973
Epoch 14 completed, average loss: 0.014351092799659102, duration: 86.94 seconds
Macro-F1: 0.9990998961516127
Micro-F1: 0.9991828784531699
Epoch 15 completed, average loss: 0.05260574068829172, duration: 77.12 seconds
Macro-F1: 0.9998974030124032
Micro-F1: 0.9999287393999857
Epoch 16 completed, average loss: 0.01667635967539168, duration: 87.86 seconds
Macro-F1: 0.9997181120430443
Micro-F1: 0.9997339604266134
Epoch 17 completed, average loss: 0.04076371331227693, duration: 76.79 seconds
Macro-F1: 0.999715227530074
Micro-F1: 0.9997054561866078
Epoch 18 completed, average loss: 0.016288794853262338, duration: 78.93 seconds
Macro-F1: 0.9956147536776054
Micro-F1: 0.994693460652272
Epoch 19 completed, average loss: 0.012442172496358159, duration: 87.55 seconds
Macro-F1: 0.9998147192001753
Micro-F1: 0.9998242238532982
Epoch 20 completed, average loss: 0.043287162836909227, duration: 76.47 seconds
Macro-F1: 0.9997726232305818
Micro-F1: 0.9997577139599515
Epoch 21 completed, average loss: 0.016489105658509272, duration: 87.97 seconds
Macro-F1: 0.9998648479898824
Micro-F1: 0.9999144872799829
Epoch 22 completed, average loss: 0.049058190416214016, duration: 67.96 seconds
Macro-F1: 0.9998922529427339
Micro-F1: 0.9999287393999857
Epoch 23 completed, average loss: 0.01801478106290058, duration: 67.46 seconds
Macro-F1: 0.9998886227811452
Micro-F1: 0.9999144872799829
Epoch 24 completed, average loss: 0.010883171321807822, duration: 75.39 seconds
Macro-F1: 0.9998484506497519
Micro-F1: 0.9998812323333096
Epoch 25 completed, average loss: 0.027409793515998128, duration: 67.27 seconds
Macro-F1: 0.9998283552003834
Micro-F1: 0.9998479773866362
Epoch 26 completed, average loss: 0.009931511589766219, duration: 75.61 seconds
Macro-F1: 0.9990410201221617
Micro-F1: 0.9989215895864509
Epoch 27 completed, average loss: 0.020575272677216823, duration: 67.86 seconds
Macro-F1: 0.9995442523280195
Micro-F1: 0.9995439321599088
Epoch 28 completed, average loss: 0.01935276935126343, duration: 67.74 seconds
Macro-F1: 0.9998847351521672
Micro-F1: 0.9999097365733153
Epoch 29 completed, average loss: 0.020409336472527267, duration: 75.43 seconds
Macro-F1: 0.9998719293391707
Micro-F1: 0.9999049858666477
Epoch 30 completed, average loss: 0.010066344584367795, duration: 67.81 seconds
Macro-F1: 0.9998623115623476
Micro-F1: 0.9998812323333096
loss_history [7.6071245420762015, 0.591742170962203, 0.23711301707982124, 0.052823030300294394, 0.12952788556388084, 0.054159639713554746, 0.03371883920276682, 0.04992101015743032, 0.0651335430297318, 0.027517282826565518, 0.02275413399885097, 0.021838848568037795, 0.05112135329643958, 0.014351092799659102, 0.05260574068829172, 0.01667635967539168, 0.04076371331227693, 0.016288794853262338, 0.012442172496358159, 0.043287162836909227, 0.016489105658509272, 0.049058190416214016, 0.01801478106290058, 0.010883171321807822, 0.027409793515998128, 0.009931511589766219, 0.020575272677216823, 0.01935276935126343, 0.020409336472527267, 0.010066344584367795]
macro_F1List [0.8930045844319342, 0.9970783153994157, 0.9769163163020499, 0.9994156630798832, 0.9993206489465308, 0.9995676856932468, 0.9990166037198033, 0.9992113826931757, 0.9992968954131927, 0.9995391814532412, 0.9996531984132639, 0.9996294448799259, 0.9994869236798973, 0.9991828784531699, 0.9999287393999857, 0.9997339604266134, 0.9997054561866078, 0.994693460652272, 0.9998242238532982, 0.9997577139599515, 0.9999144872799829, 0.9999287393999857, 0.9999144872799829, 0.9998812323333096, 0.9998479773866362, 0.9989215895864509, 0.9995439321599088, 0.9999097365733153, 0.9999049858666477, 0.9998812323333096]
micro_F1List [0.889673858925295, 0.9970925642040974, 0.9635967890087769, 0.9992673644226665, 0.9993067547403691, 0.9995445042001115, 0.9988816865813751, 0.9989799978368205, 0.9992009532442161, 0.9995357246304611, 0.999613123136989, 0.9996113671733503, 0.9995047708423309, 0.9990998961516127, 0.9998974030124032, 0.9997181120430443, 0.999715227530074, 0.9956147536776054, 0.9998147192001753, 0.9997726232305818, 0.9998648479898824, 0.9998922529427339, 0.9998886227811452, 0.9998484506497519, 0.9998283552003834, 0.9990410201221617, 0.9995442523280195, 0.9998847351521672, 0.9998719293391707, 0.9998623115623476]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 1.0 14811 14811
1 0.9996411912450663 30646 30657
2 0.9998914636131763 36850 36854
3 0.9999072184078679 32331 32334
4 0.9999438360011232 71216 71220
5 0.9998781428977619 24616 24619
Top-1 accuracy: 0.9998812323333096
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.9998623115623476
Micro-F1: 0.9998812323333096

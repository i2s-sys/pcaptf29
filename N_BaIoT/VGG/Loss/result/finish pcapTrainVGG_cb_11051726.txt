2024-11-05 09:26:54.768527: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_cb.py
2024-11-05 09:26:56.980428: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-05 09:26:56.989566: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-05 09:26:56.990506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-05 09:26:57.005842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-05 09:26:57.005875: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-05 09:26:57.008894: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-05 09:26:57.008960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-05 09:26:57.010214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-05 09:26:57.010516: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-05 09:26:57.013687: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-05 09:26:57.014430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-05 09:26:57.014613: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-05 09:26:57.016972: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-05 09:26:57.017006: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-05 09:26:57.702587: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-05 09:26:57.702634: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-05 09:26:57.702643: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-05 09:26:57.707801: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19180 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 2
init data completed!
2024-11-05 09:29:25.821085: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-05 09:29:25.823852: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-05 09:29:25.823907: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-05 09:29:25.823970: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-05 09:29:25.823990: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-05 09:29:25.824007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-05 09:29:25.824040: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-05 09:29:25.824067: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-05 09:29:25.824091: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-05 09:29:25.824114: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-05 09:29:25.826828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-05 09:29:25.889348: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-05 09:29:25.891289: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-05 09:29:25.891326: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-05 09:29:25.891356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-05 09:29:25.891369: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-05 09:29:25.891381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-05 09:29:25.891393: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-05 09:29:25.891404: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-05 09:29:25.891415: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-05 09:29:25.891427: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-05 09:29:25.893842: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-05 09:29:25.893902: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-05 09:29:25.893909: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-05 09:29:25.893916: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-05 09:29:25.896356: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19180 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-05 09:29:26.390073: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-05 09:29:26.419078: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-05 09:29:27.538098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-05 09:29:28.460399: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-05 09:29:28.467225: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-05 09:29:31.681428: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-05 09:29:31.873747: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-05 09:30:11.379330: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 18.052377733649774, duration: 183.21 seconds
Macro-F1: 0.9988605458548497
Micro-F1: 0.9991638756264994
Epoch 2 completed, average loss: 1.1910171439344002, duration: 109.06 seconds
Macro-F1: 0.9993371264988883
Micro-F1: 0.9996009406399202
Epoch 3 completed, average loss: 1.0444673434857294, duration: 109.84 seconds
Macro-F1: 0.9923899551646413
Micro-F1: 0.991334711038267
Epoch 4 completed, average loss: 0.42093998362186563, duration: 110.16 seconds
Macro-F1: 0.9997793677719508
Micro-F1: 0.9998574787999714
Epoch 5 completed, average loss: 0.914336667341112, duration: 110.00 seconds
Macro-F1: 0.9996907317753466
Micro-F1: 0.9998052210266277
Epoch 6 completed, average loss: 0.317688373240293, duration: 111.57 seconds
Macro-F1: 0.9998459817242232
Micro-F1: 0.99990023515998
Epoch 7 completed, average loss: 0.12918205454638051, duration: 111.52 seconds
Macro-F1: 0.9997959842281036
Micro-F1: 0.9998717309199744
Epoch 8 completed, average loss: 0.14657645455260762, duration: 110.59 seconds
Macro-F1: 0.9998771738097948
Micro-F1: 0.9999192379866505
Epoch 9 completed, average loss: 0.07890232691779936, duration: 109.69 seconds
Macro-F1: 0.9998571311626997
Micro-F1: 0.9999097365733153
Epoch 10 completed, average loss: 0.18287027065398714, duration: 111.75 seconds
Macro-F1: 0.9998466708902192
Micro-F1: 0.99990023515998
Epoch 11 completed, average loss: 0.1068734673852891, duration: 110.93 seconds
Macro-F1: 0.9997945772361336
Micro-F1: 0.9998717309199744
Epoch 12 completed, average loss: 0.06638570284072373, duration: 115.36 seconds
Macro-F1: 0.9971971264088441
Micro-F1: 0.996988051972731
Epoch 13 completed, average loss: 0.03047405347253546, duration: 109.29 seconds
Macro-F1: 0.9998637146982166
Micro-F1: 0.9999144872799829
Epoch 14 completed, average loss: 0.22252184313904322, duration: 110.82 seconds
Macro-F1: 0.9998817291480836
Micro-F1: 0.9999239886933181
Epoch 15 completed, average loss: 0.13633923101678272, duration: 108.86 seconds
Macro-F1: 0.9998577519334203
Micro-F1: 0.9999097365733153
Epoch 16 completed, average loss: 0.12235713603357838, duration: 108.92 seconds
Macro-F1: 0.9998727218021909
Micro-F1: 0.9999192379866505
Epoch 17 completed, average loss: 0.087172028869817, duration: 109.83 seconds
Macro-F1: 0.9998653211190104
Micro-F1: 0.9999144872799829
Epoch 18 completed, average loss: 0.11520882254138329, duration: 109.04 seconds
Macro-F1: 0.9998637146982166
Micro-F1: 0.9999144872799829
Epoch 19 completed, average loss: 0.05247859478655215, duration: 110.24 seconds
Macro-F1: 0.9998653211190104
Micro-F1: 0.9999144872799829
Epoch 20 completed, average loss: 0.1033962533736095, duration: 108.43 seconds
Macro-F1: 0.9998637146982166
Micro-F1: 0.9999144872799829
Epoch 21 completed, average loss: 0.0907988674553661, duration: 107.80 seconds
Macro-F1: 0.9998637146982166
Micro-F1: 0.9999144872799829
Epoch 22 completed, average loss: 0.06001082771093565, duration: 107.70 seconds
Macro-F1: 0.9998907367359418
Micro-F1: 0.9999287393999857
Epoch 23 completed, average loss: 0.220323602812104, duration: 82.61 seconds
Macro-F1: 0.9998814348433432
Micro-F1: 0.9999192379866505
Epoch 24 completed, average loss: 0.02457043048624557, duration: 81.34 seconds
Macro-F1: 0.9998400265513023
Micro-F1: 0.999876481626642
Epoch 25 completed, average loss: 0.04003899534685942, duration: 82.89 seconds
Macro-F1: 0.9998574170563953
Micro-F1: 0.9998907337466448
Epoch 26 completed, average loss: 0.0376831441408808, duration: 83.31 seconds
Macro-F1: 0.9998089905749977
Micro-F1: 0.9998432266799686
Epoch 27 completed, average loss: 0.05732164405532748, duration: 83.27 seconds
Macro-F1: 0.9997909393885535
Micro-F1: 0.9998289745599658
Epoch 28 completed, average loss: 0.06303490542040885, duration: 83.62 seconds
Macro-F1: 0.9998584002625392
Micro-F1: 0.9998954844533124
Epoch 29 completed, average loss: 0.02917681718556811, duration: 83.97 seconds
Macro-F1: 0.9996652621301085
Micro-F1: 0.9997292097199458
Epoch 30 completed, average loss: 0.04505583962317568, duration: 83.26 seconds
Macro-F1: 0.9998401309176238
Micro-F1: 0.9998859830399772
loss_history [18.052377733649774, 1.1910171439344002, 1.0444673434857294, 0.42093998362186563, 0.914336667341112, 0.317688373240293, 0.12918205454638051, 0.14657645455260762, 0.07890232691779936, 0.18287027065398714, 0.1068734673852891, 0.06638570284072373, 0.03047405347253546, 0.22252184313904322, 0.13633923101678272, 0.12235713603357838, 0.087172028869817, 0.11520882254138329, 0.05247859478655215, 0.1033962533736095, 0.0907988674553661, 0.06001082771093565, 0.220323602812104, 0.02457043048624557, 0.04003899534685942, 0.0376831441408808, 0.05732164405532748, 0.06303490542040885, 0.02917681718556811, 0.04505583962317568]
macro_F1List [0.9991638756264994, 0.9996009406399202, 0.991334711038267, 0.9998574787999714, 0.9998052210266277, 0.99990023515998, 0.9998717309199744, 0.9999192379866505, 0.9999097365733153, 0.99990023515998, 0.9998717309199744, 0.996988051972731, 0.9999144872799829, 0.9999239886933181, 0.9999097365733153, 0.9999192379866505, 0.9999144872799829, 0.9999144872799829, 0.9999144872799829, 0.9999144872799829, 0.9999144872799829, 0.9999287393999857, 0.9999192379866505, 0.999876481626642, 0.9998907337466448, 0.9998432266799686, 0.9998289745599658, 0.9998954844533124, 0.9997292097199458, 0.9998859830399772]
micro_F1List [0.9988605458548497, 0.9993371264988883, 0.9923899551646413, 0.9997793677719508, 0.9996907317753466, 0.9998459817242232, 0.9997959842281036, 0.9998771738097948, 0.9998571311626997, 0.9998466708902192, 0.9997945772361336, 0.9971971264088441, 0.9998637146982166, 0.9998817291480836, 0.9998577519334203, 0.9998727218021909, 0.9998653211190104, 0.9998637146982166, 0.9998653211190104, 0.9998637146982166, 0.9998637146982166, 0.9998907367359418, 0.9998814348433432, 0.9998400265513023, 0.9998574170563953, 0.9998089905749977, 0.9997909393885535, 0.9998584002625392, 0.9996652621301085, 0.9998401309176238]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows

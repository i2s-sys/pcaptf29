2024-11-03 02:02:01.220556: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_999_1.py
2024-11-03 02:02:03.271973: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-03 02:02:03.280191: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:02:03.281307: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-03 02:02:03.304556: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-03 02:02:03.304594: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:02:03.307697: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:02:03.307783: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:02:03.309002: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:02:03.309283: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:02:03.312281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:02:03.312946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:02:03.313116: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:02:03.313489: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:02:03.313520: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:02:03.893504: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:02:03.893553: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:02:03.893562: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:02:03.894221: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 1
init data completed!
2024-11-03 02:03:52.953944: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:03:52.954755: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-03 02:03:52.954789: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:03:52.954842: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:03:52.954859: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:03:52.954874: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:03:52.954902: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:03:52.954918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:03:52.954934: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:03:52.954951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:03:52.955313: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:03:53.850241: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:03:53.850619: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-03 02:03:53.850651: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:03:53.850686: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:03:53.850699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:03:53.850712: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:03:53.850724: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:03:53.850736: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:03:53.850749: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:03:53.850761: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:03:53.851076: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:03:53.851129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:03:53.851139: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:03:53.851146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:03:53.851499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-03 02:03:55.413000: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-03 02:03:55.545796: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-03 02:03:58.108143: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:03:58.688893: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:03:58.709271: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:04:00.874801: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-03 02:04:01.053645: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-03 02:04:42.227970: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 14.890865761582328, duration: 427.18 seconds
Macro-F1: 0.9784750530813976
Micro-F1: 0.9735243117413716
Epoch 2 completed, average loss: 1.6586080428424292, duration: 299.11 seconds
Macro-F1: 0.9973344147204668
Micro-F1: 0.9978574312929048
Epoch 3 completed, average loss: 1.276289209331356, duration: 289.21 seconds
Macro-F1: 0.9983403958076728
Micro-F1: 0.9986032922397207
Epoch 4 completed, average loss: 1.2556895004027855, duration: 289.26 seconds
Macro-F1: 0.9985189157236158
Micro-F1: 0.9987030570797406
Epoch 5 completed, average loss: 0.4596605944176706, duration: 298.91 seconds
Macro-F1: 0.9979945849777604
Micro-F1: 0.9980474595596095
Epoch 6 completed, average loss: 0.27245781931748597, duration: 290.65 seconds
Macro-F1: 0.9993409752971029
Micro-F1: 0.9993776574265422
Epoch 7 completed, average loss: 0.5565901140109902, duration: 287.47 seconds
Macro-F1: 0.9982031664562587
Micro-F1: 0.99888358393311
Epoch 8 completed, average loss: 0.30908535397308534, duration: 283.21 seconds
Macro-F1: 0.9980971270506132
Micro-F1: 0.9982184849996437
Epoch 9 completed, average loss: 0.18336351909225157, duration: 289.68 seconds
Macro-F1: 0.9994822233222814
Micro-F1: 0.9994726715598945
Epoch 10 completed, average loss: 0.21827133628204293, duration: 288.34 seconds
Macro-F1: 0.9995963503345561
Micro-F1: 0.9995961899332526
Epoch 11 completed, average loss: 0.11887489853967499, duration: 280.87 seconds
Macro-F1: 0.9996259228667043
Micro-F1: 0.9997719660799544
Epoch 12 completed, average loss: 0.08857213068902951, duration: 287.39 seconds
Macro-F1: 0.99981484653973
Micro-F1: 0.9998859830399772
Epoch 13 completed, average loss: 0.08023777313001686, duration: 286.33 seconds
Macro-F1: 0.9993823012218613
Micro-F1: 0.9994774222665621
Epoch 14 completed, average loss: 0.08657838438350637, duration: 300.17 seconds
Macro-F1: 0.9994623264589816
Micro-F1: 0.9995201786265707
Epoch 15 completed, average loss: 0.05144369562274537, duration: 285.87 seconds
Macro-F1: 0.9995106454490176
Micro-F1: 0.9994964250932327
Epoch 16 completed, average loss: 0.14251667788170408, duration: 308.52 seconds
Macro-F1: 0.9993899254233033
Micro-F1: 0.999577187106582
Epoch 17 completed, average loss: 0.05510391753016583, duration: 307.84 seconds
Macro-F1: 0.9998735247646066
Micro-F1: 0.9999192379866505
Epoch 18 completed, average loss: 0.04701780163994567, duration: 286.06 seconds
Macro-F1: 0.9990334108950655
Micro-F1: 0.9994204137865508
Epoch 19 completed, average loss: 0.0591706798406676, duration: 306.97 seconds
Macro-F1: 0.9995834977603445
Micro-F1: 0.9996626998265992
Epoch 20 completed, average loss: 0.023917071986377627, duration: 309.50 seconds
Macro-F1: 0.9927991401472965
Micro-F1: 0.9917052661583411
Epoch 21 completed, average loss: 0.1674709476321187, duration: 312.92 seconds
Macro-F1: 0.9998426203101803
Micro-F1: 0.99990023515998
Epoch 22 completed, average loss: 0.014772149658915636, duration: 308.04 seconds
Macro-F1: 0.9994116303741857
Micro-F1: 0.999391909546545
Epoch 23 completed, average loss: 0.05131447030589413, duration: 286.47 seconds
Macro-F1: 0.9996061780999845
Micro-F1: 0.9996959547732726
Epoch 24 completed, average loss: 0.02631071793539548, duration: 288.56 seconds
Macro-F1: 0.9998847351521672
Micro-F1: 0.9999097365733153
Epoch 25 completed, average loss: 0.06891063321530475, duration: 287.98 seconds
Macro-F1: 0.9997557371233184
Micro-F1: 0.9997672153732867
Epoch 26 completed, average loss: 0.027440234555422625, duration: 286.77 seconds
Macro-F1: 0.9993999653574
Micro-F1: 0.999391909546545
Epoch 27 completed, average loss: 0.12755206392538254, duration: 285.20 seconds
Macro-F1: 0.9994858275357599
Micro-F1: 0.9994394166132212
Epoch 28 completed, average loss: 0.018468332803332585, duration: 285.45 seconds
Macro-F1: 0.9997143274129128
Micro-F1: 0.999714957599943
Epoch 29 completed, average loss: 0.020138692804475535, duration: 282.97 seconds
Macro-F1: 0.9851779756684578
Micro-F1: 0.9825981614765197
Epoch 30 completed, average loss: 0.01278923216478391, duration: 295.96 seconds
Macro-F1: 0.9998537462784277
Micro-F1: 0.9999097365733153
loss_history [14.890865761582328, 1.6586080428424292, 1.276289209331356, 1.2556895004027855, 0.4596605944176706, 0.27245781931748597, 0.5565901140109902, 0.30908535397308534, 0.18336351909225157, 0.21827133628204293, 0.11887489853967499, 0.08857213068902951, 0.08023777313001686, 0.08657838438350637, 0.05144369562274537, 0.14251667788170408, 0.05510391753016583, 0.04701780163994567, 0.0591706798406676, 0.023917071986377627, 0.1674709476321187, 0.014772149658915636, 0.05131447030589413, 0.02631071793539548, 0.06891063321530475, 0.027440234555422625, 0.12755206392538254, 0.018468332803332585, 0.020138692804475535, 0.01278923216478391]
macro_F1List [0.9735243117413716, 0.9978574312929048, 0.9986032922397207, 0.9987030570797406, 0.9980474595596095, 0.9993776574265422, 0.99888358393311, 0.9982184849996437, 0.9994726715598945, 0.9995961899332526, 0.9997719660799544, 0.9998859830399772, 0.9994774222665621, 0.9995201786265707, 0.9994964250932327, 0.999577187106582, 0.9999192379866505, 0.9994204137865508, 0.9996626998265992, 0.9917052661583411, 0.99990023515998, 0.999391909546545, 0.9996959547732726, 0.9999097365733153, 0.9997672153732867, 0.999391909546545, 0.9994394166132212, 0.999714957599943, 0.9825981614765197, 0.9999097365733153]
micro_F1List [0.9784750530813976, 0.9973344147204668, 0.9983403958076728, 0.9985189157236158, 0.9979945849777604, 0.9993409752971029, 0.9982031664562587, 0.9980971270506132, 0.9994822233222814, 0.9995963503345561, 0.9996259228667043, 0.99981484653973, 0.9993823012218613, 0.9994623264589816, 0.9995106454490176, 0.9993899254233033, 0.9998735247646066, 0.9990334108950655, 0.9995834977603445, 0.9927991401472965, 0.9998426203101803, 0.9994116303741857, 0.9996061780999845, 0.9998847351521672, 0.9997557371233184, 0.9993999653574, 0.9994858275357599, 0.9997143274129128, 0.9851779756684578, 0.9998537462784277]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 1.0 14811 14811
1 1.0 30657 30657
2 0.9998914636131763 36850 36854
3 0.9997216552236037 32325 32334
4 0.9999719180005616 71218 71220
5 0.9998375238636825 24615 24619
Top-1 accuracy: 0.9999097365733153
Top-3 accuracy: 0.9999904985866648
Top-5 accuracy: 1.0
Macro-F1: 0.9998537462784277
Micro-F1: 0.9999097365733153

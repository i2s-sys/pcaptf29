2024-11-03 02:11:25.094558: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_ce_Factor.py
2024-11-03 02:11:27.858109: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-03 02:11:27.873297: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:11:27.874929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-03 02:11:27.918961: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:11:27.919007: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:11:27.922068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:11:27.922146: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:11:27.923453: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:11:27.923757: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:11:27.926920: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:11:27.927660: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:11:27.927849: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:11:27.934117: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:11:27.934162: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:11:28.677201: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:11:28.677286: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:11:28.677299: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:11:28.682369: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21944 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:17:00.0, compute capability: 8.6)
BETA = 1, GAMMA = 0
init data completed!
2024-11-03 02:13:35.457432: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:13:35.459335: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:13:35.459381: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:13:35.459440: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:13:35.459460: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:13:35.459477: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:13:35.459507: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:13:35.459523: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:13:35.459540: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:13:35.459557: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:13:35.461675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
/home/xuke/zdh/pcap50tf2/N_BaIoT/VGG/Loss/pcapResnetPureSeed_Factor.py:116: RuntimeWarning: invalid value encountered in double_scalars
  new_value = (1.0 - beta) / (1.0 - np.power(beta, value) )
2024-11-03 02:13:36.406029: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:13:36.407500: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:17:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:13:36.407539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:13:36.407581: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:13:36.407596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:13:36.407610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:13:36.407623: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:13:36.407636: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:13:36.407649: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:13:36.407662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:13:36.409762: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:13:36.409828: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:13:36.409838: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:13:36.409846: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:13:36.412135: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21944 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:17:00.0, compute capability: 8.6)
2024-11-03 02:13:38.025062: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-03 02:13:38.184409: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-03 02:13:40.883108: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:13:41.404884: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:13:41.435672: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:13:44.891287: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-03 02:13:45.121915: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-03 02:14:27.817001: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 20.476534879565673, duration: 502.24 seconds
Macro-F1: 0.9987094280542842
Micro-F1: 0.999007102306468
Epoch 2 completed, average loss: 4.701770049375417, duration: 419.05 seconds
Macro-F1: 0.9988022199958949
Micro-F1: 0.9991496235064966
Epoch 3 completed, average loss: 1.7016989371817242, duration: 417.77 seconds
Macro-F1: 0.999185718085491
Micro-F1: 0.9995059265065679
Epoch 4 completed, average loss: 0.7769058782792756, duration: 445.03 seconds
Macro-F1: 0.9992347361478803
Micro-F1: 0.9995344307465736
Epoch 5 completed, average loss: 4.382262927501644, duration: 416.19 seconds
Macro-F1: 0.998963191926872
Micro-F1: 0.9992778925865222
Epoch 6 completed, average loss: 0.9424738882224573, duration: 408.54 seconds
Macro-F1: 0.9612075874580036
Micro-F1: 0.9504358773367538
Epoch 7 completed, average loss: 0.5362449670739614, duration: 436.66 seconds
Macro-F1: 0.9998136883319987
Micro-F1: 0.9998812323333096
Epoch 8 completed, average loss: 0.31715679459627216, duration: 414.47 seconds
Macro-F1: 0.9998449841955547
Micro-F1: 0.9999097365733153
Epoch 9 completed, average loss: 0.4862901221898646, duration: 439.13 seconds
Macro-F1: 0.9998692505236546
Micro-F1: 0.99990023515998
Epoch 10 completed, average loss: 0.705075079834893, duration: 427.19 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 11 completed, average loss: 0.1761368898211733, duration: 425.51 seconds
Macro-F1: 0.9997370383225005
Micro-F1: 0.999776716786622
Epoch 12 completed, average loss: 0.357372889741828, duration: 424.59 seconds
Macro-F1: 0.999766812559152
Micro-F1: 0.9998194731466306
Epoch 13 completed, average loss: 0.2482623096185564, duration: 439.47 seconds
Macro-F1: 0.9998912741625822
Micro-F1: 0.9999239886933181
Epoch 14 completed, average loss: 0.20803118286572314, duration: 459.35 seconds
Macro-F1: 0.9959372443373513
Micro-F1: 0.9953775624124088
Epoch 15 completed, average loss: 0.06110792325196483, duration: 428.26 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 16 completed, average loss: 0.42684113945868296, duration: 413.34 seconds
Macro-F1: 0.9996677888439662
Micro-F1: 0.9997529632532839
Epoch 17 completed, average loss: 0.04339304328977417, duration: 335.23 seconds
Macro-F1: 0.9998983562813523
Micro-F1: 0.9999334901066533
Epoch 18 completed, average loss: 0.29968339526467075, duration: 342.25 seconds
Macro-F1: 0.9998851710682101
Micro-F1: 0.9999192379866505
Epoch 19 completed, average loss: 0.10612072872111061, duration: 350.08 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 20 completed, average loss: 0.07745703761746191, duration: 318.64 seconds
Macro-F1: 0.9998395383385369
Micro-F1: 0.99990023515998
Epoch 21 completed, average loss: 0.05093691389496077, duration: 314.04 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 22 completed, average loss: 0.17977299524365822, duration: 365.65 seconds
Macro-F1: 0.9998891647733107
Micro-F1: 0.9999287393999857
Epoch 23 completed, average loss: 0.04108423993437084, duration: 361.29 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 24 completed, average loss: 0.08843359407615174, duration: 318.05 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 25 completed, average loss: 0.14394973372520647, duration: 324.69 seconds
Macro-F1: 0.999899743833681
Micro-F1: 0.9999334901066533
Epoch 26 completed, average loss: 0.12584626122970297, duration: 342.15 seconds
Macro-F1: 0.9998997440778093
Micro-F1: 0.9999334901066533
Epoch 27 completed, average loss: 0.1557258154574567, duration: 318.49 seconds
Macro-F1: 0.9998929473645326
Micro-F1: 0.9999287393999857
Epoch 28 completed, average loss: 0.03295712702530675, duration: 319.38 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
Epoch 29 completed, average loss: 0.07326438001378621, duration: 315.76 seconds
Macro-F1: 0.9999262400461407
Micro-F1: 0.9999477422266562
Epoch 30 completed, average loss: 0.09904220521523831, duration: 308.13 seconds
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886
loss_history [20.476534879565673, 4.701770049375417, 1.7016989371817242, 0.7769058782792756, 4.382262927501644, 0.9424738882224573, 0.5362449670739614, 0.31715679459627216, 0.4862901221898646, 0.705075079834893, 0.1761368898211733, 0.357372889741828, 0.2482623096185564, 0.20803118286572314, 0.06110792325196483, 0.42684113945868296, 0.04339304328977417, 0.29968339526467075, 0.10612072872111061, 0.07745703761746191, 0.05093691389496077, 0.17977299524365822, 0.04108423993437084, 0.08843359407615174, 0.14394973372520647, 0.12584626122970297, 0.1557258154574567, 0.03295712702530675, 0.07326438001378621, 0.09904220521523831]
macro_F1List [0.999007102306468, 0.9991496235064966, 0.9995059265065679, 0.9995344307465736, 0.9992778925865222, 0.9504358773367538, 0.9998812323333096, 0.9999097365733153, 0.99990023515998, 0.9999429915199886, 0.999776716786622, 0.9998194731466306, 0.9999239886933181, 0.9953775624124088, 0.9999429915199886, 0.9997529632532839, 0.9999334901066533, 0.9999192379866505, 0.9999382408133209, 0.99990023515998, 0.9999429915199886, 0.9999287393999857, 0.9999429915199886, 0.9999382408133209, 0.9999334901066533, 0.9999334901066533, 0.9999287393999857, 0.9999429915199886, 0.9999477422266562, 0.9999429915199886]
micro_F1List [0.9987094280542842, 0.9988022199958949, 0.999185718085491, 0.9992347361478803, 0.998963191926872, 0.9612075874580036, 0.9998136883319987, 0.9998449841955547, 0.9998692505236546, 0.999911950071283, 0.9997370383225005, 0.999766812559152, 0.9998912741625822, 0.9959372443373513, 0.999911950071283, 0.9996677888439662, 0.9998983562813523, 0.9998851710682101, 0.999905846928069, 0.9998395383385369, 0.999911950071283, 0.9998891647733107, 0.999911950071283, 0.999905846928069, 0.999899743833681, 0.9998997440778093, 0.9998929473645326, 0.999911950071283, 0.9999262400461407, 0.999911950071283]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 1.0 14811 14811
1 1.0 30657 30657
2 0.9998914636131763 36850 36854
3 0.9999072184078679 32331 32334
4 0.9999719180005616 71218 71220
5 0.9998781428977619 24616 24619
Top-1 accuracy: 0.9999429915199886
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.999911950071283
Micro-F1: 0.9999429915199886

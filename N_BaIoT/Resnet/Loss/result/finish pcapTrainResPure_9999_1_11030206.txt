2024-11-03 02:12:47.967426: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_9999_1.py
2024-11-03 02:12:50.239320: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-03 02:12:50.247593: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:12:50.248769: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-03 02:12:50.255109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:12:50.255142: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:12:50.258244: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:12:50.258312: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:12:50.259537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:12:50.259844: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:12:50.262831: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:12:50.263572: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:12:50.263759: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:12:50.264193: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:12:50.264226: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:12:50.948040: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:12:50.948099: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:12:50.948109: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:12:50.948924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15431 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 1
init data completed!
2024-11-03 02:14:48.893297: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:14:48.893872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:14:48.893911: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:14:48.893971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:14:48.893992: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:14:48.894013: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:14:48.894046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:14:48.894068: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:14:48.894089: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:14:48.894109: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:14:48.894435: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:14:49.878747: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:14:49.879174: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:14:49.879211: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:14:49.879256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:14:49.879272: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:14:49.879288: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:14:49.879304: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:14:49.879320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:14:49.879336: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:14:49.879352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:14:49.879656: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:14:49.879725: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:14:49.879736: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:14:49.879744: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:14:49.880128: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 15431 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-03 02:14:51.588058: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-03 02:14:51.734847: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-03 02:14:54.507479: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:14:55.174989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:14:55.199955: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:14:57.748190: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-03 02:14:57.959119: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-03 02:15:45.608422: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 16.942718139089642, duration: 530.69 seconds
Macro-F1: 0.995849586981918
Micro-F1: 0.9960474120525428
Epoch 2 completed, average loss: 1.9390408694537797, duration: 581.70 seconds
Macro-F1: 0.9988622442738994
Micro-F1: 0.9993111475331956
Epoch 3 completed, average loss: 1.3792228343195587, duration: 591.63 seconds
Macro-F1: 0.999085732375283
Micro-F1: 0.9994441673198888
Epoch 4 completed, average loss: 1.3613239767544207, duration: 578.81 seconds
Macro-F1: 0.9989703516158372
Micro-F1: 0.9992636404665194
Epoch 5 completed, average loss: 0.3802067301510247, duration: 577.73 seconds
Macro-F1: 0.9988636033023122
Micro-F1: 0.999106867146488
Epoch 6 completed, average loss: 0.5242820401870297, duration: 586.39 seconds
Macro-F1: 0.9984484915946052
Micro-F1: 0.9986460485997292
Epoch 7 completed, average loss: 0.2834113804998611, duration: 488.33 seconds
Macro-F1: 0.9988831519081355
Micro-F1: 0.9991211192664909
Epoch 8 completed, average loss: 0.3487037039111709, duration: 503.39 seconds
Macro-F1: 0.9987848491617112
Micro-F1: 0.9990688614931471
Epoch 9 completed, average loss: 0.2744058434138048, duration: 580.92 seconds
Macro-F1: 0.9994859642601067
Micro-F1: 0.9995201786265707
Epoch 10 completed, average loss: 0.1395037823846887, duration: 577.21 seconds
Macro-F1: 0.9985044067284577
Micro-F1: 0.9990403572531414
Epoch 11 completed, average loss: 0.09101002174355925, duration: 576.97 seconds
Macro-F1: 0.9995474911129273
Micro-F1: 0.9995676856932468
Epoch 12 completed, average loss: 0.07573206119075689, duration: 577.85 seconds
Macro-F1: 0.9992637351256776
Micro-F1: 0.9994869236798973
Epoch 13 completed, average loss: 0.06914766486656965, duration: 575.00 seconds
Macro-F1: 0.9948569916275393
Micro-F1: 0.9937813249720896
Epoch 14 completed, average loss: 0.126927608976361, duration: 421.71 seconds
Macro-F1: 0.9932091850231611
Micro-F1: 0.9958146274258296
Epoch 15 completed, average loss: 0.045562266243604085, duration: 565.01 seconds
Macro-F1: 0.9994311543766287
Micro-F1: 0.9994679208532269
Epoch 16 completed, average loss: 0.06430506657500136, duration: 578.91 seconds
Macro-F1: 0.9983680225651409
Micro-F1: 0.9989405924131215
Epoch 17 completed, average loss: 0.06518597751138824, duration: 577.52 seconds
Macro-F1: 0.9989432715352874
Micro-F1: 0.999007102306468
Epoch 18 completed, average loss: 0.05358299688439731, duration: 580.87 seconds
Macro-F1: 0.9919227303295379
Micro-F1: 0.994370412598874
Epoch 19 completed, average loss: 0.03597084083029319, duration: 578.54 seconds
Macro-F1: 0.9806881511703177
Micro-F1: 0.9800042756360009
Epoch 20 completed, average loss: 0.061091002100978356, duration: 513.19 seconds
Macro-F1: 0.9997056475752921
Micro-F1: 0.9997957196132925
Epoch 21 completed, average loss: 0.03717987788278215, duration: 483.66 seconds
Macro-F1: 0.9987344105714917
Micro-F1: 0.9985795387063826
Epoch 22 completed, average loss: 0.036464716564671214, duration: 583.57 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 23 completed, average loss: 0.056093241445710186, duration: 582.40 seconds
Macro-F1: 0.9998674304736935
Micro-F1: 0.9999144872799829
Epoch 24 completed, average loss: 0.02948981568741632, duration: 584.13 seconds
Macro-F1: 0.9994673919656812
Micro-F1: 0.9996817026532697
Epoch 25 completed, average loss: 0.0403817667633561, duration: 578.65 seconds
Macro-F1: 0.9999237934894728
Micro-F1: 0.9999477422266562
Epoch 26 completed, average loss: 0.03581831588105826, duration: 583.63 seconds
Macro-F1: 0.9997743225579435
Micro-F1: 0.9997909689066249
Epoch 27 completed, average loss: 0.0445900974309744, duration: 447.57 seconds
Macro-F1: 0.9985759422937289
Micro-F1: 0.9984085132663484
Epoch 28 completed, average loss: 0.028485307445443923, duration: 541.78 seconds
Macro-F1: 0.9994425038547382
Micro-F1: 0.9996722012399344
Epoch 29 completed, average loss: 0.012376540285887527, duration: 576.72 seconds
Macro-F1: 0.9999224703777615
Micro-F1: 0.9999382408133209
Epoch 30 completed, average loss: 0.035176919419580364, duration: 503.09 seconds
Macro-F1: 0.9998990502147923
Micro-F1: 0.9999334901066533
loss_history [16.942718139089642, 1.9390408694537797, 1.3792228343195587, 1.3613239767544207, 0.3802067301510247, 0.5242820401870297, 0.2834113804998611, 0.3487037039111709, 0.2744058434138048, 0.1395037823846887, 0.09101002174355925, 0.07573206119075689, 0.06914766486656965, 0.126927608976361, 0.045562266243604085, 0.06430506657500136, 0.06518597751138824, 0.05358299688439731, 0.03597084083029319, 0.061091002100978356, 0.03717987788278215, 0.036464716564671214, 0.056093241445710186, 0.02948981568741632, 0.0403817667633561, 0.03581831588105826, 0.0445900974309744, 0.028485307445443923, 0.012376540285887527, 0.035176919419580364]
macro_F1List [0.9960474120525428, 0.9993111475331956, 0.9994441673198888, 0.9992636404665194, 0.999106867146488, 0.9986460485997292, 0.9991211192664909, 0.9990688614931471, 0.9995201786265707, 0.9990403572531414, 0.9995676856932468, 0.9994869236798973, 0.9937813249720896, 0.9958146274258296, 0.9994679208532269, 0.9989405924131215, 0.999007102306468, 0.994370412598874, 0.9800042756360009, 0.9997957196132925, 0.9985795387063826, 0.9999382408133209, 0.9999144872799829, 0.9996817026532697, 0.9999477422266562, 0.9997909689066249, 0.9984085132663484, 0.9996722012399344, 0.9999382408133209, 0.9999334901066533]
micro_F1List [0.995849586981918, 0.9988622442738994, 0.999085732375283, 0.9989703516158372, 0.9988636033023122, 0.9984484915946052, 0.9988831519081355, 0.9987848491617112, 0.9994859642601067, 0.9985044067284577, 0.9995474911129273, 0.9992637351256776, 0.9948569916275393, 0.9932091850231611, 0.9994311543766287, 0.9983680225651409, 0.9989432715352874, 0.9919227303295379, 0.9806881511703177, 0.9997056475752921, 0.9987344105714917, 0.999905846928069, 0.9998674304736935, 0.9994673919656812, 0.9999237934894728, 0.9997743225579435, 0.9985759422937289, 0.9994425038547382, 0.9999224703777615, 0.9998990502147923]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 0.9999324826142731 14810 14811
1 0.9999673810222788 30656 30657
2 0.9998914636131763 36850 36854
3 0.9999072184078679 32331 32334
4 0.9999719180005616 71218 71220
5 0.9998781428977619 24616 24619
Top-1 accuracy: 0.9999334901066533
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.9998990502147923
Micro-F1: 0.9999334901066533

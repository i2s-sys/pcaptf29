2024-11-03 02:03:06.678370: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_999_2.py
2024-11-03 02:03:08.720177: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-03 02:03:08.728711: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:03:08.729843: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-03 02:03:08.735980: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-03 02:03:08.736011: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:03:08.738959: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:03:08.739046: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:03:08.740256: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:03:08.740537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:03:08.743517: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:03:08.744269: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:03:08.744437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:03:08.744800: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:03:08.744829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:03:09.337404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:03:09.337467: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:03:09.337477: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:03:09.338173: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21759 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 2
init data completed!
2024-11-03 02:04:56.494686: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:04:56.495228: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-03 02:04:56.495268: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:04:56.495320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:04:56.495338: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:04:56.495356: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:04:56.495386: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:04:56.495403: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:04:56.495422: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:04:56.495438: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:04:56.495760: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:04:57.441905: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:04:57.442353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-03 02:04:57.442407: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:04:57.442444: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:04:57.442458: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:04:57.442472: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:04:57.442485: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:04:57.442498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:04:57.442511: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:04:57.442525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:04:57.442829: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:04:57.442882: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:04:57.442892: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:04:57.442899: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:04:57.443255: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21759 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-03 02:04:59.096213: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-03 02:04:59.238564: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-03 02:05:01.869565: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:05:02.421609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:05:02.446870: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:05:04.659014: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-03 02:05:04.838428: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-03 02:05:47.190818: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 10.464385116188856, duration: 439.20 seconds
Macro-F1: 0.945219573137221
Micro-F1: 0.9261930212119053
Epoch 2 completed, average loss: 3.437570297952954, duration: 318.66 seconds
Macro-F1: 0.9960587555284149
Micro-F1: 0.9957671203591534
Epoch 3 completed, average loss: 1.127894531155225, duration: 315.98 seconds
Macro-F1: 0.9963742142880827
Micro-F1: 0.9962564431459179
Epoch 4 completed, average loss: 0.2815389177723865, duration: 325.86 seconds
Macro-F1: 0.9990853487501888
Micro-F1: 0.9993776574265422
Epoch 5 completed, average loss: 0.29255033423638677, duration: 321.95 seconds
Macro-F1: 0.9990780587946612
Micro-F1: 0.9993491531865365
Epoch 6 completed, average loss: 0.2600247057554567, duration: 325.46 seconds
Macro-F1: 0.9985861384151802
Micro-F1: 0.9987505641464168
Epoch 7 completed, average loss: 0.27231763428381595, duration: 322.33 seconds
Macro-F1: 0.9985519164610713
Micro-F1: 0.9987030570797406
Epoch 8 completed, average loss: 0.20033596739643694, duration: 328.19 seconds
Macro-F1: 0.9989793635835315
Micro-F1: 0.9992256348131785
Epoch 9 completed, average loss: 0.2215627122745413, duration: 324.08 seconds
Macro-F1: 0.9988661081378015
Micro-F1: 0.9990736121998147
Epoch 10 completed, average loss: 0.10827409940391247, duration: 323.46 seconds
Macro-F1: 0.9995462886007321
Micro-F1: 0.9995154279199031
Epoch 11 completed, average loss: 0.04411629436047358, duration: 323.69 seconds
Macro-F1: 0.9997248412483856
Micro-F1: 0.9997197083066106
Epoch 12 completed, average loss: 0.1425058935485769, duration: 335.46 seconds
Macro-F1: 0.9996448126414084
Micro-F1: 0.9996199434665907
Epoch 13 completed, average loss: 0.08185304178425279, duration: 320.40 seconds
Macro-F1: 0.9995986093064427
Micro-F1: 0.9995724363999144
Epoch 14 completed, average loss: 0.025720494951339795, duration: 339.23 seconds
Macro-F1: 0.9997364969267347
Micro-F1: 0.9997339604266134
Epoch 15 completed, average loss: 0.032538553287938025, duration: 341.39 seconds
Macro-F1: 0.9998431016115864
Micro-F1: 0.9998669802133068
Epoch 16 completed, average loss: 0.03228739846850233, duration: 347.25 seconds
Macro-F1: 0.9998875381329918
Micro-F1: 0.9999239886933181
Epoch 17 completed, average loss: 0.02457309358116665, duration: 344.89 seconds
Macro-F1: 0.9998997445658119
Micro-F1: 0.9999334901066533
Epoch 18 completed, average loss: 0.06006128056470729, duration: 342.88 seconds
Macro-F1: 0.9998443944033747
Micro-F1: 0.9998574787999714
Epoch 19 completed, average loss: 0.0233855299528951, duration: 345.42 seconds
Macro-F1: 0.999905846928069
Micro-F1: 0.9999382408133209
Epoch 20 completed, average loss: 0.03141189131797022, duration: 338.54 seconds
Macro-F1: 0.9998997440778093
Micro-F1: 0.9999334901066533
Epoch 21 completed, average loss: 0.017564822601136634, duration: 322.09 seconds
Macro-F1: 0.9998458628321121
Micro-F1: 0.9998622295066392
Epoch 22 completed, average loss: 0.02291118146300635, duration: 323.62 seconds
Macro-F1: 0.999927394659649
Micro-F1: 0.9999477422266562
Epoch 23 completed, average loss: 0.03746023633534719, duration: 326.11 seconds
Macro-F1: 0.9998569769282902
Micro-F1: 0.9998812323333096
Epoch 24 completed, average loss: 0.05131732793140373, duration: 335.38 seconds
Macro-F1: 0.9991079356263871
Micro-F1: 0.9989976008931328
Epoch 25 completed, average loss: 0.011185058008750748, duration: 318.64 seconds
Macro-F1: 0.9997844137028343
Micro-F1: 0.9997719660799544
Epoch 26 completed, average loss: 0.05094994666520502, duration: 311.47 seconds
Macro-F1: 0.9996974894834674
Micro-F1: 0.9996959547732726
Epoch 27 completed, average loss: 0.009981688216652861, duration: 319.94 seconds
Macro-F1: 0.9998999612261054
Micro-F1: 0.9999239886933181
Epoch 28 completed, average loss: 0.01742223673984589, duration: 331.11 seconds
Macro-F1: 0.9998997445658119
Micro-F1: 0.9999334901066533
Epoch 29 completed, average loss: 0.023038122748821593, duration: 329.45 seconds
Macro-F1: 0.9999116257772083
Micro-F1: 0.9999382408133209
Epoch 30 completed, average loss: 0.014488726432538346, duration: 329.39 seconds
Macro-F1: 0.9998125040303241
Micro-F1: 0.9998242238532982
loss_history [10.464385116188856, 3.437570297952954, 1.127894531155225, 0.2815389177723865, 0.29255033423638677, 0.2600247057554567, 0.27231763428381595, 0.20033596739643694, 0.2215627122745413, 0.10827409940391247, 0.04411629436047358, 0.1425058935485769, 0.08185304178425279, 0.025720494951339795, 0.032538553287938025, 0.03228739846850233, 0.02457309358116665, 0.06006128056470729, 0.0233855299528951, 0.03141189131797022, 0.017564822601136634, 0.02291118146300635, 0.03746023633534719, 0.05131732793140373, 0.011185058008750748, 0.05094994666520502, 0.009981688216652861, 0.01742223673984589, 0.023038122748821593, 0.014488726432538346]
macro_F1List [0.9261930212119053, 0.9957671203591534, 0.9962564431459179, 0.9993776574265422, 0.9993491531865365, 0.9987505641464168, 0.9987030570797406, 0.9992256348131785, 0.9990736121998147, 0.9995154279199031, 0.9997197083066106, 0.9996199434665907, 0.9995724363999144, 0.9997339604266134, 0.9998669802133068, 0.9999239886933181, 0.9999334901066533, 0.9998574787999714, 0.9999382408133209, 0.9999334901066533, 0.9998622295066392, 0.9999477422266562, 0.9998812323333096, 0.9989976008931328, 0.9997719660799544, 0.9996959547732726, 0.9999239886933181, 0.9999334901066533, 0.9999382408133209, 0.9998242238532982]
micro_F1List [0.945219573137221, 0.9960587555284149, 0.9963742142880827, 0.9990853487501888, 0.9990780587946612, 0.9985861384151802, 0.9985519164610713, 0.9989793635835315, 0.9988661081378015, 0.9995462886007321, 0.9997248412483856, 0.9996448126414084, 0.9995986093064427, 0.9997364969267347, 0.9998431016115864, 0.9998875381329918, 0.9998997445658119, 0.9998443944033747, 0.999905846928069, 0.9998997440778093, 0.9998458628321121, 0.999927394659649, 0.9998569769282902, 0.9991079356263871, 0.9997844137028343, 0.9996974894834674, 0.9998999612261054, 0.9998997445658119, 0.9999116257772083, 0.9998125040303241]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 1.0 14811 14811
1 0.999184525556969 30632 30657
2 0.9998914636131763 36850 36854
3 0.9999072184078679 32331 32334
4 0.9999719180005616 71218 71220
5 0.9998781428977619 24616 24619
Top-1 accuracy: 0.9998242238532982
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.9998125040303241
Micro-F1: 0.9998242238532982

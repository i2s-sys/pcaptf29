2024-11-03 02:04:39.864331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainResPure_9999_2.py
2024-11-03 02:04:42.015800: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-03 02:04:42.024157: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:04:42.025346: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-03 02:04:42.051353: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:04:42.051398: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:04:42.054411: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:04:42.054498: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:04:42.055688: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:04:42.056032: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:04:42.059093: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:04:42.059829: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:04:42.060027: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:04:42.060457: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:04:42.060491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:04:42.655448: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:04:42.655499: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:04:42.655509: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:04:42.656245: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 2
init data completed!
2024-11-03 02:06:33.030328: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:06:33.031233: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:06:33.031279: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:06:33.031352: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:06:33.031372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:06:33.031390: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:06:33.031418: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:06:33.031437: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:06:33.031456: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:06:33.031473: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:06:33.031817: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:06:34.000632: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-03 02:06:34.001086: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-03 02:06:34.001125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-03 02:06:34.001163: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:06:34.001178: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:06:34.001193: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-03 02:06:34.001207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-03 02:06:34.001222: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-03 02:06:34.001237: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-03 02:06:34.001251: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:06:34.001580: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-03 02:06:34.001646: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-03 02:06:34.001658: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-03 02:06:34.001666: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-03 02:06:34.002072: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-03 02:06:35.709794: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-03 02:06:35.860229: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-03 02:06:38.681824: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-03 02:06:39.317989: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-03 02:06:39.343185: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-03 02:06:41.653241: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-03 02:06:41.870459: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-03 02:07:29.730686: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 8.427032438311691, duration: 436.64 seconds
Macro-F1: 0.998498869943144
Micro-F1: 0.99888358393311
Epoch 2 completed, average loss: 1.8966855298426049, duration: 596.92 seconds
Macro-F1: 0.9988579364107935
Micro-F1: 0.9991591249198318
Epoch 3 completed, average loss: 0.3951112040233475, duration: 599.87 seconds
Macro-F1: 0.9986954787292796
Micro-F1: 0.9991306206798262
Epoch 4 completed, average loss: 0.35497043884841345, duration: 533.67 seconds
Macro-F1: 0.9991987620422204
Micro-F1: 0.9995106772132355
Epoch 5 completed, average loss: 0.3022031727894279, duration: 551.17 seconds
Macro-F1: 0.9985532998979797
Micro-F1: 0.9987458134397491
Epoch 6 completed, average loss: 0.27466745330191294, duration: 591.03 seconds
Macro-F1: 0.9990158276525581
Micro-F1: 0.9993111475331956
Epoch 7 completed, average loss: 0.1215987540579053, duration: 599.19 seconds
Macro-F1: 0.9324435552402298
Micro-F1: 0.9513860186702772
Epoch 8 completed, average loss: 0.10680179450403235, duration: 594.98 seconds
Macro-F1: 0.9975958777091174
Micro-F1: 0.9981994821729733
Epoch 9 completed, average loss: 0.09137052023205694, duration: 476.60 seconds
Macro-F1: 0.9995660065377522
Micro-F1: 0.9996341955865935
Epoch 10 completed, average loss: 0.05916431580804254, duration: 601.23 seconds
Macro-F1: 0.9991330073992274
Micro-F1: 0.9991733770398347
Epoch 11 completed, average loss: 0.07601325136290982, duration: 608.42 seconds
Macro-F1: 0.9997231505972177
Micro-F1: 0.9998289745599658
Epoch 12 completed, average loss: 0.02521336469771859, duration: 587.79 seconds
Macro-F1: 0.9997231505972177
Micro-F1: 0.9998289745599658
Epoch 13 completed, average loss: 0.05841512667622222, duration: 591.39 seconds
Macro-F1: 0.9996759876015413
Micro-F1: 0.9998004703199601
Epoch 14 completed, average loss: 0.01397094815767505, duration: 459.98 seconds
Macro-F1: 0.9997170482349605
Micro-F1: 0.9998242238532982
Epoch 15 completed, average loss: 0.027024792868199084, duration: 578.54 seconds
Macro-F1: 0.999737089675136
Micro-F1: 0.9998337252666334
Epoch 16 completed, average loss: 0.04815819341488028, duration: 574.43 seconds
Macro-F1: 0.9998608169544788
Micro-F1: 0.9999049858666477
Epoch 17 completed, average loss: 0.048662415202760705, duration: 598.65 seconds
Macro-F1: 0.9997801432801788
Micro-F1: 0.9998574787999714
Epoch 18 completed, average loss: 0.017458110318047483, duration: 523.47 seconds
Macro-F1: 0.9997252594577869
Micro-F1: 0.9998289745599658
Epoch 19 completed, average loss: 0.03279967630060664, duration: 558.57 seconds
Macro-F1: 0.9998401847279795
Micro-F1: 0.9998954844533124
Epoch 20 completed, average loss: 0.01619814028036676, duration: 598.72 seconds
Macro-F1: 0.9999154409650665
Micro-F1: 0.9999382408133209
Epoch 21 completed, average loss: 0.03513572911087474, duration: 592.89 seconds
Macro-F1: 0.9999116921277637
Micro-F1: 0.9999334901066533
Epoch 22 completed, average loss: 0.02128450663290982, duration: 599.96 seconds
Macro-F1: 0.9999313843208536
Micro-F1: 0.9999429915199886
Epoch 23 completed, average loss: 0.04151699669658661, duration: 466.09 seconds
Macro-F1: 0.9997149817775278
Micro-F1: 0.9996959547732726
Epoch 24 completed, average loss: 0.05155599060757161, duration: 602.80 seconds
Macro-F1: 0.9979402858467048
Micro-F1: 0.9987933205064253
Epoch 25 completed, average loss: 0.03269290442325137, duration: 599.80 seconds
Macro-F1: 0.9998199847779912
Micro-F1: 0.9998479773866362
Epoch 26 completed, average loss: 0.0062681979246420605, duration: 610.81 seconds
Macro-F1: 0.9996200287620275
Micro-F1: 0.999591439226585
Epoch 27 completed, average loss: 0.02410796355305688, duration: 574.56 seconds
Macro-F1: 0.9999154436826173
Micro-F1: 0.9999382408133209
Epoch 28 completed, average loss: 0.014911602107609513, duration: 508.66 seconds
Macro-F1: 0.9999376945344749
Micro-F1: 0.9999524929333238
Epoch 29 completed, average loss: 0.013367082878081043, duration: 595.03 seconds
Macro-F1: 0.9999359102390072
Micro-F1: 0.9999524929333238
Epoch 30 completed, average loss: 0.02441723410060926, duration: 594.22 seconds
Macro-F1: 0.9998478647504186
Micro-F1: 0.9998432266799686
loss_history [8.427032438311691, 1.8966855298426049, 0.3951112040233475, 0.35497043884841345, 0.3022031727894279, 0.27466745330191294, 0.1215987540579053, 0.10680179450403235, 0.09137052023205694, 0.05916431580804254, 0.07601325136290982, 0.02521336469771859, 0.05841512667622222, 0.01397094815767505, 0.027024792868199084, 0.04815819341488028, 0.048662415202760705, 0.017458110318047483, 0.03279967630060664, 0.01619814028036676, 0.03513572911087474, 0.02128450663290982, 0.04151699669658661, 0.05155599060757161, 0.03269290442325137, 0.0062681979246420605, 0.02410796355305688, 0.014911602107609513, 0.013367082878081043, 0.02441723410060926]
macro_F1List [0.99888358393311, 0.9991591249198318, 0.9991306206798262, 0.9995106772132355, 0.9987458134397491, 0.9993111475331956, 0.9513860186702772, 0.9981994821729733, 0.9996341955865935, 0.9991733770398347, 0.9998289745599658, 0.9998289745599658, 0.9998004703199601, 0.9998242238532982, 0.9998337252666334, 0.9999049858666477, 0.9998574787999714, 0.9998289745599658, 0.9998954844533124, 0.9999382408133209, 0.9999334901066533, 0.9999429915199886, 0.9996959547732726, 0.9987933205064253, 0.9998479773866362, 0.999591439226585, 0.9999382408133209, 0.9999524929333238, 0.9999524929333238, 0.9998432266799686]
micro_F1List [0.998498869943144, 0.9988579364107935, 0.9986954787292796, 0.9991987620422204, 0.9985532998979797, 0.9990158276525581, 0.9324435552402298, 0.9975958777091174, 0.9995660065377522, 0.9991330073992274, 0.9997231505972177, 0.9997231505972177, 0.9996759876015413, 0.9997170482349605, 0.999737089675136, 0.9998608169544788, 0.9997801432801788, 0.9997252594577869, 0.9998401847279795, 0.9999154409650665, 0.9999116921277637, 0.9999313843208536, 0.9997149817775278, 0.9979402858467048, 0.9998199847779912, 0.9996200287620275, 0.9999154436826173, 0.9999376945344749, 0.9999359102390072, 0.9998478647504186]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
Processed 90000 rows
Processed 100000 rows
Processed 110000 rows
Processed 120000 rows
Processed 130000 rows
Processed 140000 rows
Processed 150000 rows
Processed 160000 rows
Processed 170000 rows
Processed 180000 rows
Processed 190000 rows
Processed 200000 rows
Processed 210000 rows
0 0.9998649652285464 14809 14811
1 0.9992171445346902 30633 30657
2 0.9999457318065882 36852 36854
3 1.0 32334 32334
4 0.9999719180005616 71218 71220
5 0.9998781428977619 24616 24619
Top-1 accuracy: 0.9998432266799686
Top-3 accuracy: 0.9999904985866648
Top-5 accuracy: 1.0
Macro-F1: 0.9998478647504186
Micro-F1: 0.9998432266799686

2024-11-16 21:02:51.156525: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_cb.py
2024-11-16 21:02:53.574255: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-16 21:02:53.585007: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 21:02:53.587610: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-16 21:02:53.598366: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 21:02:53.598414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:02:53.602117: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:02:53.602188: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:02:53.603372: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 21:02:53.603684: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 21:02:53.606609: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 21:02:53.607353: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 21:02:53.607554: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:02:53.607988: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 21:02:53.608022: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:02:54.412805: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 21:02:54.412861: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 21:02:54.412872: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 21:02:54.413579: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 17104 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 2
init data completed!
2024-11-16 21:03:11.075771: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 21:03:11.076923: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 21:03:11.076972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:03:11.077073: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:03:11.077098: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:03:11.077129: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 21:03:11.077169: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 21:03:11.077200: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 21:03:11.077230: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 21:03:11.077253: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:03:11.077611: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 21:03:11.138402: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 21:03:11.138818: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 21:03:11.138852: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:03:11.138889: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:03:11.138904: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:03:11.138918: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 21:03:11.138932: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 21:03:11.138946: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 21:03:11.138960: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 21:03:11.138984: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:03:11.139305: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 21:03:11.139404: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 21:03:11.139416: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 21:03:11.139425: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 21:03:11.139917: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 17104 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-16 21:03:11.515203: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-16 21:03:11.531242: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-16 21:03:12.303602: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:03:13.169221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:03:13.173601: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:03:15.856976: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-16 21:03:15.985152: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-16 21:03:42.255822: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 22.465651375259945, duration: 99.73 seconds
Macro-F1: 0.8561216092318461
Micro-F1: 0.8626293543215274
Epoch 2 completed, average loss: 16.17902461798022, duration: 30.71 seconds
Macro-F1: 0.890182180633334
Micro-F1: 0.8924840888111548
Epoch 3 completed, average loss: 15.318605145370116, duration: 30.54 seconds
Macro-F1: 0.8893789285532252
Micro-F1: 0.892496234756838
Epoch 4 completed, average loss: 14.834969414682437, duration: 31.06 seconds
Macro-F1: 0.8820059626924222
Micro-F1: 0.8860467375989894
Epoch 5 completed, average loss: 14.567532589872707, duration: 30.41 seconds
Macro-F1: 0.8790379270090128
Micro-F1: 0.8834960890054899
Epoch 6 completed, average loss: 14.379210636161208, duration: 30.82 seconds
Macro-F1: 0.8726866855328382
Micro-F1: 0.8778846620997911
Epoch 7 completed, average loss: 14.228593405883098, duration: 30.67 seconds
Macro-F1: 0.8785718517988892
Micro-F1: 0.8831074187436234
Epoch 8 completed, average loss: 14.105063610480945, duration: 29.86 seconds
Macro-F1: 0.8770325506683265
Micro-F1: 0.881625613370257
Epoch 9 completed, average loss: 13.991394434469822, duration: 30.07 seconds
Macro-F1: 0.8769319612811105
Micro-F1: 0.8812612349997572
Epoch 10 completed, average loss: 13.880614347228, duration: 31.04 seconds
Macro-F1: 0.8527868455863523
Micro-F1: 0.8595807219550115
Epoch 11 completed, average loss: 13.773780260580661, duration: 29.94 seconds
Macro-F1: 0.8364566691561162
Micro-F1: 0.8452242141573142
Epoch 12 completed, average loss: 13.680400131565538, duration: 30.52 seconds
Macro-F1: 0.8462605468067936
Micro-F1: 0.8537385220813293
Epoch 13 completed, average loss: 13.5778569551695, duration: 31.05 seconds
Macro-F1: 0.8725616109472151
Micro-F1: 0.8769372783364913
Epoch 14 completed, average loss: 13.520099453894739, duration: 30.58 seconds
Macro-F1: 0.8600015480241174
Micro-F1: 0.8654472137200603
Epoch 15 completed, average loss: 13.42292293899681, duration: 38.48 seconds
Macro-F1: 0.866425862039941
Micro-F1: 0.8708643054948259
Epoch 16 completed, average loss: 13.34503455681031, duration: 30.66 seconds
Macro-F1: 0.8722087737530113
Micro-F1: 0.8762571053782248
Epoch 17 completed, average loss: 13.260868951297311, duration: 30.93 seconds
Macro-F1: 0.8660131808157345
Micro-F1: 0.8706578244182092
Epoch 18 completed, average loss: 13.188651241639654, duration: 29.13 seconds
Macro-F1: 0.86700991934586
Micro-F1: 0.8713137054851091
Epoch 19 completed, average loss: 13.09728036891639, duration: 26.80 seconds
Macro-F1: 0.8654888547152655
Micro-F1: 0.870062673079726
Epoch 20 completed, average loss: 13.012524572752792, duration: 26.35 seconds
Macro-F1: 0.8678250706910773
Micro-F1: 0.8721639216829422
loss_history [22.465651375259945, 16.17902461798022, 15.318605145370116, 14.834969414682437, 14.567532589872707, 14.379210636161208, 14.228593405883098, 14.105063610480945, 13.991394434469822, 13.880614347228, 13.773780260580661, 13.680400131565538, 13.5778569551695, 13.520099453894739, 13.42292293899681, 13.34503455681031, 13.260868951297311, 13.188651241639654, 13.09728036891639, 13.012524572752792]
macro_F1List [0.8626293543215274, 0.8924840888111548, 0.892496234756838, 0.8860467375989894, 0.8834960890054899, 0.8778846620997911, 0.8831074187436234, 0.881625613370257, 0.8812612349997572, 0.8595807219550115, 0.8452242141573142, 0.8537385220813293, 0.8769372783364913, 0.8654472137200603, 0.8708643054948259, 0.8762571053782248, 0.8706578244182092, 0.8713137054851091, 0.870062673079726, 0.8721639216829422]
micro_F1List [0.8561216092318461, 0.890182180633334, 0.8893789285532252, 0.8820059626924222, 0.8790379270090128, 0.8726866855328382, 0.8785718517988892, 0.8770325506683265, 0.8769319612811105, 0.8527868455863523, 0.8364566691561162, 0.8462605468067936, 0.8725616109472151, 0.8600015480241174, 0.866425862039941, 0.8722087737530113, 0.8660131808157345, 0.86700991934586, 0.8654888547152655, 0.8678250706910773]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.7687837837837838 28445 37000
1 0.9565428394952793 43362 45332
Top-1 accuracy: 0.8721639216829422
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8678250706910773
Micro-F1: 0.8721639216829422

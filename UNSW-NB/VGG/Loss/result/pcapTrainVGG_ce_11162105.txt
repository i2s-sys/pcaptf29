2024-11-16 13:05:24.355175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_ce.py
2024-11-16 13:05:26.337295: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-16 13:05:26.345826: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 13:05:26.346537: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-16 13:05:26.360271: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 13:05:26.360294: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:05:26.362982: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:05:26.363041: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:05:26.364175: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 13:05:26.364431: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 13:05:26.367248: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 13:05:26.367862: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 13:05:26.368059: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:05:26.370290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 13:05:26.370317: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:05:26.921875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 13:05:26.921918: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 13:05:26.921924: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 13:05:26.925169: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21528 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6)
BETA = 1, GAMMA = 0
init data completed!
2024-11-16 13:05:38.011272: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 13:05:38.012774: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 13:05:38.012800: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:05:38.012823: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:05:38.012832: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:05:38.012839: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 13:05:38.012857: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 13:05:38.012865: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 13:05:38.012872: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 13:05:38.012879: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:05:38.014996: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
/home/xuke/zdh/UNSW-NB/VGG/Loss/pcapVGGSeed.py:50: RuntimeWarning: invalid value encountered in double_scalars
  new_value = (1.0 - beta) / (1.0 - np.power(beta, value))
2024-11-16 13:05:38.049269: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 13:05:38.050491: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 13:05:38.050512: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:05:38.050531: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:05:38.050539: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:05:38.050546: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 13:05:38.050553: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 13:05:38.050560: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 13:05:38.050567: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 13:05:38.050574: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:05:38.052675: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 13:05:38.052701: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 13:05:38.052706: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 13:05:38.052710: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 13:05:38.054827: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 21528 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6)
2024-11-16 13:05:38.295854: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-16 13:05:38.306332: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-16 13:05:38.795564: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:05:39.363853: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:05:39.367301: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:05:42.380121: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-16 13:05:42.585484: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-16 13:06:16.421711: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 22.543166558702467, duration: 117.92 seconds
Macro-F1: 0.869876060179016
Micro-F1: 0.873584997327892
Epoch 2 completed, average loss: 16.20978304728528, duration: 23.93 seconds
Macro-F1: 0.8628651032124857
Micro-F1: 0.868447262303843
Epoch 3 completed, average loss: 15.54339711939531, duration: 24.17 seconds
Macro-F1: 0.8682597240166976
Micro-F1: 0.8737914784045085
Epoch 4 completed, average loss: 14.952498953911926, duration: 24.20 seconds
Macro-F1: 0.8783727282135452
Micro-F1: 0.8825122674051402
Epoch 5 completed, average loss: 14.621518115217098, duration: 24.53 seconds
Macro-F1: 0.8686622490208833
Micro-F1: 0.8742894621775251
Epoch 6 completed, average loss: 14.427903366924813, duration: 24.36 seconds
Macro-F1: 0.8597408522927634
Micro-F1: 0.8665646407229268
Epoch 7 completed, average loss: 14.264580104889184, duration: 24.32 seconds
Macro-F1: 0.8618088993792912
Micro-F1: 0.8682529271729097
Epoch 8 completed, average loss: 14.12439674282701, duration: 25.11 seconds
Macro-F1: 0.8586499419931882
Micro-F1: 0.8652650245348102
Epoch 9 completed, average loss: 14.009916833232491, duration: 24.29 seconds
Macro-F1: 0.8512160083190198
Micro-F1: 0.8587062138658116
Epoch 10 completed, average loss: 13.916166800142989, duration: 24.40 seconds
Macro-F1: 0.8488762855154109
Micro-F1: 0.8565685274255453
Epoch 11 completed, average loss: 13.829357324158561, duration: 24.05 seconds
Macro-F1: 0.8532741258224972
Micro-F1: 0.8603216246416946
Epoch 12 completed, average loss: 13.722461314511351, duration: 23.86 seconds
Macro-F1: 0.8557637050339411
Micro-F1: 0.8619370354175776
Epoch 13 completed, average loss: 13.66011464883151, duration: 24.21 seconds
Macro-F1: 0.8494378273289546
Micro-F1: 0.8554753923140456
Epoch 14 completed, average loss: 13.537805352792677, duration: 24.87 seconds
Macro-F1: 0.860628895865651
Micro-F1: 0.8650585434581937
Epoch 15 completed, average loss: 13.454477410494105, duration: 24.24 seconds
Macro-F1: 0.8603534287430736
Micro-F1: 0.8641475975319438
Epoch 16 completed, average loss: 13.359519498029531, duration: 24.32 seconds
Macro-F1: 0.8608610890702907
Micro-F1: 0.8645848515765439
Epoch 17 completed, average loss: 13.270095458424292, duration: 24.13 seconds
Macro-F1: 0.8653286772611103
Micro-F1: 0.8680464460962931
Epoch 18 completed, average loss: 13.173225223452093, duration: 24.14 seconds
Macro-F1: 0.8623735892006414
Micro-F1: 0.8652164407520769
Epoch 19 completed, average loss: 13.084659456248872, duration: 24.14 seconds
Macro-F1: 0.8646111373397924
Micro-F1: 0.8672205217898266
Epoch 20 completed, average loss: 13.025896722335203, duration: 22.44 seconds
Macro-F1: 0.8626881145128394
Micro-F1: 0.8654715056114269
loss_history [22.543166558702467, 16.20978304728528, 15.54339711939531, 14.952498953911926, 14.621518115217098, 14.427903366924813, 14.264580104889184, 14.12439674282701, 14.009916833232491, 13.916166800142989, 13.829357324158561, 13.722461314511351, 13.66011464883151, 13.537805352792677, 13.454477410494105, 13.359519498029531, 13.270095458424292, 13.173225223452093, 13.084659456248872, 13.025896722335203]
macro_F1List [0.873584997327892, 0.868447262303843, 0.8737914784045085, 0.8825122674051402, 0.8742894621775251, 0.8665646407229268, 0.8682529271729097, 0.8652650245348102, 0.8587062138658116, 0.8565685274255453, 0.8603216246416946, 0.8619370354175776, 0.8554753923140456, 0.8650585434581937, 0.8641475975319438, 0.8645848515765439, 0.8680464460962931, 0.8652164407520769, 0.8672205217898266, 0.8654715056114269]
micro_F1List [0.869876060179016, 0.8628651032124857, 0.8682597240166976, 0.8783727282135452, 0.8686622490208833, 0.8597408522927634, 0.8618088993792912, 0.8586499419931882, 0.8512160083190198, 0.8488762855154109, 0.8532741258224972, 0.8557637050339411, 0.8494378273289546, 0.860628895865651, 0.8603534287430736, 0.8608610890702907, 0.8653286772611103, 0.8623735892006414, 0.8646111373397924, 0.8626881145128394]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.8045135135135135 29767 37000
1 0.9152254478072884 41489 45332
Top-1 accuracy: 0.8654715056114269
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8626881145128394
Micro-F1: 0.8654715056114269

2024-11-16 21:00:34.015224: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_9999_2.py
2024-11-16 21:00:36.169384: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-16 21:00:36.178498: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 21:00:36.181018: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-16 21:00:36.210372: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 21:00:36.210414: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:00:36.213333: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:00:36.213410: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:00:36.214536: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 21:00:36.214830: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 21:00:36.217746: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 21:00:36.218432: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 21:00:36.218619: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:00:36.219036: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 21:00:36.219070: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:00:36.819681: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 21:00:36.819738: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 21:00:36.819748: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 21:00:36.820439: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
BETA = 0.9999, GAMMA = 2
init data completed!
2024-11-16 21:00:51.916874: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 21:00:51.917278: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 21:00:51.917315: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:00:51.917360: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:00:51.917374: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:00:51.917388: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 21:00:51.917416: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 21:00:51.917430: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 21:00:51.917443: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 21:00:51.917457: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:00:51.917769: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 21:00:51.965220: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 21:00:51.965538: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:b1:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.74GHz coreCount: 82 deviceMemorySize: 23.69GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 21:00:51.965575: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 21:00:51.965614: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:00:51.965630: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:00:51.965646: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 21:00:51.965662: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 21:00:51.965677: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 21:00:51.965693: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 21:00:51.965709: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:00:51.965999: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 21:00:51.966028: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 21:00:51.966038: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 21:00:51.966045: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 21:00:51.966358: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22422 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:b1:00.0, compute capability: 8.6)
2024-11-16 21:00:52.329550: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-16 21:00:52.344419: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-16 21:00:53.083596: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 21:00:53.787781: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 21:00:53.791958: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 21:00:55.917302: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-16 21:00:56.068154: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-16 21:01:26.105343: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 5.6139239394986955, duration: 94.87 seconds
Macro-F1: 0.8756231093619602
Micro-F1: 0.8789656512656074
Epoch 2 completed, average loss: 4.184129042291049, duration: 24.10 seconds
Macro-F1: 0.8806809440131269
Micro-F1: 0.8847349754651896
Epoch 3 completed, average loss: 4.0129142977879635, duration: 24.00 seconds
Macro-F1: 0.884306673735846
Micro-F1: 0.8884394888986057
Epoch 4 completed, average loss: 3.877068437565148, duration: 23.84 seconds
Macro-F1: 0.8816005859458058
Micro-F1: 0.8861439051644561
Epoch 5 completed, average loss: 3.790843753243468, duration: 23.88 seconds
Macro-F1: 0.8877208764868669
Micro-F1: 0.8916338726133217
Epoch 6 completed, average loss: 3.7357393874139833, duration: 23.52 seconds
Macro-F1: 0.8785828491046621
Micro-F1: 0.8833746295486566
Epoch 7 completed, average loss: 3.6956033731917555, duration: 23.41 seconds
Macro-F1: 0.8898531534272034
Micro-F1: 0.893480056357188
Epoch 8 completed, average loss: 3.663501722173503, duration: 24.07 seconds
Macro-F1: 0.889557917568726
Micro-F1: 0.8933828887917213
Epoch 9 completed, average loss: 3.6333203596124863, duration: 23.80 seconds
Macro-F1: 0.8903150428020254
Micro-F1: 0.8941480833697711
Epoch 10 completed, average loss: 3.6082536524625657, duration: 23.98 seconds
Macro-F1: 0.8802674457603665
Micro-F1: 0.8850629159986396
Epoch 11 completed, average loss: 3.5834515059055247, duration: 24.10 seconds
Macro-F1: 0.8847973480142167
Micro-F1: 0.8891318078025555
Epoch 12 completed, average loss: 3.5667348777925647, duration: 23.65 seconds
Macro-F1: 0.8685110169289907
Micro-F1: 0.8744109216343584
Epoch 13 completed, average loss: 3.533454375078941, duration: 24.02 seconds
Macro-F1: 0.8646474052286208
Micro-F1: 0.8709250352232425
Epoch 14 completed, average loss: 3.507467776776405, duration: 23.96 seconds
Macro-F1: 0.8644884062678788
Micro-F1: 0.8707549919836759
Epoch 15 completed, average loss: 3.4839504967648414, duration: 23.86 seconds
Macro-F1: 0.8610266620351474
Micro-F1: 0.8674998785405431
Epoch 16 completed, average loss: 3.451792783855608, duration: 23.94 seconds
Macro-F1: 0.8674388524474421
Micro-F1: 0.8729655540980421
Epoch 17 completed, average loss: 3.425090728318108, duration: 23.98 seconds
Macro-F1: 0.8651832174257663
Micro-F1: 0.8709493271146092
Epoch 18 completed, average loss: 3.397734212736042, duration: 37.03 seconds
Macro-F1: 0.8510514385809066
Micro-F1: 0.8580503327989117
Epoch 19 completed, average loss: 3.365370353004896, duration: 23.92 seconds
Macro-F1: 0.8511169649189869
Micro-F1: 0.8576738084827285
Epoch 20 completed, average loss: 3.3523795930376186, duration: 23.98 seconds
Macro-F1: 0.8385272204892702
Micro-F1: 0.8467303114220475
loss_history [5.6139239394986955, 4.184129042291049, 4.0129142977879635, 3.877068437565148, 3.790843753243468, 3.7357393874139833, 3.6956033731917555, 3.663501722173503, 3.6333203596124863, 3.6082536524625657, 3.5834515059055247, 3.5667348777925647, 3.533454375078941, 3.507467776776405, 3.4839504967648414, 3.451792783855608, 3.425090728318108, 3.397734212736042, 3.365370353004896, 3.3523795930376186]
macro_F1List [0.8789656512656074, 0.8847349754651896, 0.8884394888986057, 0.8861439051644561, 0.8916338726133217, 0.8833746295486566, 0.893480056357188, 0.8933828887917213, 0.8941480833697711, 0.8850629159986396, 0.8891318078025555, 0.8744109216343584, 0.8709250352232425, 0.8707549919836759, 0.8674998785405431, 0.8729655540980421, 0.8709493271146092, 0.8580503327989117, 0.8576738084827285, 0.8467303114220475]
micro_F1List [0.8756231093619602, 0.8806809440131269, 0.884306673735846, 0.8816005859458058, 0.8877208764868669, 0.8785828491046621, 0.8898531534272034, 0.889557917568726, 0.8903150428020254, 0.8802674457603665, 0.8847973480142167, 0.8685110169289907, 0.8646474052286208, 0.8644884062678788, 0.8610266620351474, 0.8674388524474421, 0.8651832174257663, 0.8510514385809066, 0.8511169649189869, 0.8385272204892702]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.6912972972972973 25578 37000
1 0.9735948116121063 44135 45332
Top-1 accuracy: 0.8467303114220474
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8385272204892702
Micro-F1: 0.8467303114220475

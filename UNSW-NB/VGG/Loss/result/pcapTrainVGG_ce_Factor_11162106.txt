2024-11-16 13:05:49.757066: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_ce_Factor.py
2024-11-16 13:05:52.197005: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-16 13:05:52.210567: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 13:05:52.211972: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-16 13:05:52.232263: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 13:05:52.232331: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:05:52.237534: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:05:52.237661: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:05:52.239794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 13:05:52.240320: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 13:05:52.245447: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 13:05:52.246599: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 13:05:52.246971: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:05:52.251000: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 13:05:52.251078: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:05:53.136203: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 13:05:53.136281: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 13:05:53.136290: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 13:05:53.141440: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19829 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6)
BETA = 1, GAMMA = 0
init data completed!
2024-11-16 13:06:04.656682: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 13:06:04.658125: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 13:06:04.658151: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:06:04.658173: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:06:04.658181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:06:04.658189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 13:06:04.658207: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 13:06:04.658214: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 13:06:04.658221: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 13:06:04.658229: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:06:04.660343: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
/home/xuke/zdh/UNSW-NB/VGG/Loss/pcapVGGSeed_Factor.py:50: RuntimeWarning: invalid value encountered in double_scalars
  new_value = (1.0 - beta) / (1.0 - np.power(beta, value) )
2024-11-16 13:06:04.695422: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 13:06:04.696875: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:31:00.0 name: NVIDIA GeForce RTX 3090 computeCapability: 8.6
coreClock: 1.695GHz coreCount: 82 deviceMemorySize: 23.59GiB deviceMemoryBandwidth: 871.81GiB/s
2024-11-16 13:06:04.696899: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 13:06:04.696921: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:06:04.696929: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:06:04.696936: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 13:06:04.696942: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 13:06:04.696950: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 13:06:04.696957: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 13:06:04.696965: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:06:04.699115: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 13:06:04.699140: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 13:06:04.699144: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 13:06:04.699148: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 13:06:04.701266: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 19829 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 3090, pci bus id: 0000:31:00.0, compute capability: 8.6)
2024-11-16 13:06:04.948540: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-16 13:06:04.959050: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-16 13:06:05.444125: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 13:06:06.018354: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 13:06:06.021618: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 13:06:09.073217: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-16 13:06:09.208675: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-16 13:06:37.235592: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 22.9005447820297, duration: 95.19 seconds
Macro-F1: 0.8557065135391844
Micro-F1: 0.8568721760676286
Epoch 2 completed, average loss: 16.09267405404759, duration: 21.91 seconds
Macro-F1: 0.8942981420162075
Micro-F1: 0.8965529806150707
Epoch 3 completed, average loss: 15.40768706145471, duration: 22.12 seconds
Macro-F1: 0.8903516479283761
Micro-F1: 0.8929213428557548
Epoch 4 completed, average loss: 14.93527752121841, duration: 21.64 seconds
Macro-F1: 0.8969051173403104
Micro-F1: 0.8996744886556868
Epoch 5 completed, average loss: 14.584666713299413, duration: 21.78 seconds
Macro-F1: 0.8937899092802792
Micro-F1: 0.8965286887237041
Epoch 6 completed, average loss: 14.38524060461798, duration: 21.35 seconds
Macro-F1: 0.890598487987114
Micro-F1: 0.893480056357188
Epoch 7 completed, average loss: 14.245381089872996, duration: 21.59 seconds
Macro-F1: 0.8930164157916249
Micro-F1: 0.8959821211679542
Epoch 8 completed, average loss: 14.109249965564624, duration: 21.42 seconds
Macro-F1: 0.8931521160509819
Micro-F1: 0.8960671427877375
Epoch 9 completed, average loss: 13.981236831561938, duration: 22.31 seconds
Macro-F1: 0.8943254263973316
Micro-F1: 0.897002380605354
Epoch 10 completed, average loss: 13.87615983550613, duration: 21.36 seconds
Macro-F1: 0.8957727188748028
Micro-F1: 0.898326288684837
Epoch 11 completed, average loss: 13.77660004390775, duration: 21.45 seconds
Macro-F1: 0.8810966632477728
Micro-F1: 0.8850872078900063
Epoch 12 completed, average loss: 13.665186239386058, duration: 21.65 seconds
Macro-F1: 0.8843721600022518
Micro-F1: 0.8881115483651557
Epoch 13 completed, average loss: 13.564967974334673, duration: 21.57 seconds
Macro-F1: 0.8804062836877254
Micro-F1: 0.8845406403342563
Epoch 14 completed, average loss: 13.54020650757761, duration: 21.48 seconds
Macro-F1: 0.8908561323430377
Micro-F1: 0.8939051644561046
Epoch 15 completed, average loss: 13.402599953664664, duration: 22.43 seconds
Macro-F1: 0.8880107488995359
Micro-F1: 0.8912087645144051
Epoch 16 completed, average loss: 13.317255319340374, duration: 22.23 seconds
Macro-F1: 0.8825716765411846
Micro-F1: 0.8862653646212895
Epoch 17 completed, average loss: 13.228481055873427, duration: 21.38 seconds
Macro-F1: 0.8799395182344767
Micro-F1: 0.8837997376475732
Epoch 18 completed, average loss: 13.140342539640306, duration: 21.27 seconds
Macro-F1: 0.8805263015888616
Micro-F1: 0.8842977214205898
Epoch 19 completed, average loss: 13.04581376598907, duration: 21.39 seconds
Macro-F1: 0.8785002073388315
Micro-F1: 0.8821721809260069
Epoch 20 completed, average loss: 12.971599866213635, duration: 21.33 seconds
Macro-F1: 0.8817065519860194
Micro-F1: 0.884819997084973
loss_history [22.9005447820297, 16.09267405404759, 15.40768706145471, 14.93527752121841, 14.584666713299413, 14.38524060461798, 14.245381089872996, 14.109249965564624, 13.981236831561938, 13.87615983550613, 13.77660004390775, 13.665186239386058, 13.564967974334673, 13.54020650757761, 13.402599953664664, 13.317255319340374, 13.228481055873427, 13.140342539640306, 13.04581376598907, 12.971599866213635]
macro_F1List [0.8568721760676286, 0.8965529806150707, 0.8929213428557548, 0.8996744886556868, 0.8965286887237041, 0.893480056357188, 0.8959821211679542, 0.8960671427877375, 0.897002380605354, 0.898326288684837, 0.8850872078900063, 0.8881115483651557, 0.8845406403342563, 0.8939051644561046, 0.8912087645144051, 0.8862653646212895, 0.8837997376475732, 0.8842977214205898, 0.8821721809260069, 0.884819997084973]
micro_F1List [0.8557065135391844, 0.8942981420162075, 0.8903516479283761, 0.8969051173403104, 0.8937899092802792, 0.890598487987114, 0.8930164157916249, 0.8931521160509819, 0.8943254263973316, 0.8957727188748028, 0.8810966632477728, 0.8843721600022518, 0.8804062836877254, 0.8908561323430377, 0.8880107488995359, 0.8825716765411846, 0.8799395182344767, 0.8805263015888616, 0.8785002073388315, 0.8817065519860194]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.8039459459459459 29746 37000
1 0.950829436159887 43103 45332
Top-1 accuracy: 0.884819997084973
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8817065519860194
Micro-F1: 0.884819997084973

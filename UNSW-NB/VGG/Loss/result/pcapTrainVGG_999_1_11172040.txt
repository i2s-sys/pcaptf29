2024-11-16 20:40:32.319503: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
当前脚本的文件名是: pcapTrainVGG_999_1.py
2024-11-16 20:40:34.384277: I tensorflow/core/platform/cpu_feature_guard.cc:142] This TensorFlow binary is optimized with oneAPI Deep Neural Network Library (oneDNN) to use the following CPU instructions in performance-critical operations:  AVX512F
To enable them in other operations, rebuild TensorFlow with the appropriate compiler flags.
2024-11-16 20:40:34.392434: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 20:40:34.393491: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcuda.so.1
2024-11-16 20:40:34.412756: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-16 20:40:34.412794: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 20:40:34.415951: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 20:40:34.416031: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 20:40:34.417181: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 20:40:34.417459: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 20:40:34.420506: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 20:40:34.421189: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 20:40:34.455281: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 20:40:34.456413: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 20:40:34.466150: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 20:40:37.249981: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 20:40:37.250050: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 20:40:37.250066: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 20:40:37.251307: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
BETA = 0.999, GAMMA = 1
init data completed!
2024-11-16 20:40:51.646194: I tensorflow/compiler/jit/xla_cpu_device.cc:41] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 20:40:51.646594: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-16 20:40:51.646631: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 20:40:51.646683: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 20:40:51.646699: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 20:40:51.646714: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 20:40:51.646742: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 20:40:51.646756: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 20:40:51.646770: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 20:40:51.646785: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 20:40:51.647101: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 20:40:51.692341: I tensorflow/compiler/jit/xla_gpu_device.cc:99] Not creating XLA devices, tf_xla_enable_xla_devices not set
2024-11-16 20:40:51.692626: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1720] Found device 0 with properties: 
pciBusID: 0000:3b:00.0 name: NVIDIA GeForce RTX 4090 computeCapability: 8.9
coreClock: 2.625GHz coreCount: 128 deviceMemorySize: 23.65GiB deviceMemoryBandwidth: 938.86GiB/s
2024-11-16 20:40:51.692656: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudart.so.11.0
2024-11-16 20:40:51.692691: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 20:40:51.692706: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 20:40:51.692720: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcufft.so.10
2024-11-16 20:40:51.692734: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcurand.so.10
2024-11-16 20:40:51.692748: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusolver.so.10
2024-11-16 20:40:51.692762: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcusparse.so.11
2024-11-16 20:40:51.692777: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 20:40:51.693051: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1862] Adding visible gpu devices: 0
2024-11-16 20:40:51.693083: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1261] Device interconnect StreamExecutor with strength 1 edge matrix:
2024-11-16 20:40:51.693091: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1267]      0 
2024-11-16 20:40:51.693098: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1280] 0:   N 
2024-11-16 20:40:51.693400: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1406] Created TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 22259 MB memory) -> physical GPU (device: 0, name: NVIDIA GeForce RTX 4090, pci bus id: 0000:3b:00.0, compute capability: 8.9)
2024-11-16 20:40:52.077806: I tensorflow/compiler/mlir/mlir_graph_optimization_pass.cc:196] None of the MLIR optimization passes are enabled (registered 0 passes)
2024-11-16 20:40:52.092027: I tensorflow/core/platform/profile_utils/cpu_utils.cc:112] CPU Frequency: 2100000000 Hz
2024-11-16 20:40:52.832586: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublas.so.11
2024-11-16 20:40:55.111021: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcublasLt.so.11
2024-11-16 20:40:55.120035: I tensorflow/stream_executor/platform/default/dso_loader.cc:49] Successfully opened dynamic library libcudnn.so.8
2024-11-16 20:41:12.740364: W tensorflow/stream_executor/gpu/asm_compiler.cc:63] Running ptxas --version returned 256
2024-11-16 20:41:12.947996: W tensorflow/stream_executor/gpu/redzone_allocator.cc:314] Internal: ptxas exited with non-zero error code 256, output: 
Relying on driver to perform ptx compilation. 
Modify $PATH to customize ptxas location.
This message will be only logged once.
2024-11-16 20:41:48.908408: I tensorflow/stream_executor/cuda/cuda_blas.cc:1838] TensorFloat-32 will be used for the matrix multiplication. This will only be logged once.
Epoch 1 completed, average loss: 11.160628838640134, duration: 132.36 seconds
Macro-F1: 0.8745040065852671
Micro-F1: 0.8764271486177914
Epoch 2 completed, average loss: 8.11464263523818, duration: 24.46 seconds
Macro-F1: 0.8819971780912157
Micro-F1: 0.88331389982024
Epoch 3 completed, average loss: 7.834861356555502, duration: 24.81 seconds
Macro-F1: 0.8857931651031727
Micro-F1: 0.8875771267550892
Epoch 4 completed, average loss: 7.593412119772767, duration: 23.94 seconds
Macro-F1: 0.8930345484081317
Micro-F1: 0.8959699752222708
Epoch 5 completed, average loss: 7.4151938304664275, duration: 24.09 seconds
Macro-F1: 0.8999251541386912
Micro-F1: 0.9020429480639363
Epoch 6 completed, average loss: 7.298579338957046, duration: 24.28 seconds
Macro-F1: 0.8952573146108229
Micro-F1: 0.8980347859884371
Epoch 7 completed, average loss: 7.213728583233473, duration: 24.45 seconds
Macro-F1: 0.8908291325477246
Micro-F1: 0.8941845212068211
Epoch 8 completed, average loss: 7.150806364306052, duration: 24.60 seconds
Macro-F1: 0.8921863336735043
Micro-F1: 0.8950833211873876
Epoch 9 completed, average loss: 7.099271072794522, duration: 24.36 seconds
Macro-F1: 0.8836236550758916
Micro-F1: 0.8876378564835058
Epoch 10 completed, average loss: 7.030389627807762, duration: 24.37 seconds
Macro-F1: 0.8750670380293308
Micro-F1: 0.8791478404508575
Epoch 11 completed, average loss: 7.002199272067988, duration: 23.72 seconds
Macro-F1: 0.8809151762517711
Micro-F1: 0.8842855754749065
Epoch 12 completed, average loss: 6.940224284756523, duration: 24.53 seconds
Macro-F1: 0.8774244333273893
Micro-F1: 0.8810547539231405
Epoch 13 completed, average loss: 6.890804491920833, duration: 24.11 seconds
Macro-F1: 0.8793497989934509
Micro-F1: 0.8829009376670068
Epoch 14 completed, average loss: 6.841925142279848, duration: 24.43 seconds
Macro-F1: 0.8799840971622093
Micro-F1: 0.8834960890054899
Epoch 15 completed, average loss: 6.797344773071712, duration: 24.59 seconds
Macro-F1: 0.8840671441640489
Micro-F1: 0.8872856240586892
Epoch 16 completed, average loss: 6.754560592576829, duration: 24.31 seconds
Macro-F1: 0.8710639446737927
Micro-F1: 0.8753825972890249
Epoch 17 completed, average loss: 6.707545178575704, duration: 24.49 seconds
Macro-F1: 0.880072952991027
Micro-F1: 0.8837875917018899
Epoch 18 completed, average loss: 6.666428699991492, duration: 23.54 seconds
Macro-F1: 0.8692729178170009
Micro-F1: 0.8739493756983919
Epoch 19 completed, average loss: 6.619066957229241, duration: 23.25 seconds
Macro-F1: 0.8622658497002014
Micro-F1: 0.8674512947578098
Epoch 20 completed, average loss: 6.568705282740736, duration: 23.17 seconds
Macro-F1: 0.8478935410936473
Micro-F1: 0.8542607977457125
loss_history [11.160628838640134, 8.11464263523818, 7.834861356555502, 7.593412119772767, 7.4151938304664275, 7.298579338957046, 7.213728583233473, 7.150806364306052, 7.099271072794522, 7.030389627807762, 7.002199272067988, 6.940224284756523, 6.890804491920833, 6.841925142279848, 6.797344773071712, 6.754560592576829, 6.707545178575704, 6.666428699991492, 6.619066957229241, 6.568705282740736]
macro_F1List [0.8764271486177914, 0.88331389982024, 0.8875771267550892, 0.8959699752222708, 0.9020429480639363, 0.8980347859884371, 0.8941845212068211, 0.8950833211873876, 0.8876378564835058, 0.8791478404508575, 0.8842855754749065, 0.8810547539231405, 0.8829009376670068, 0.8834960890054899, 0.8872856240586892, 0.8753825972890249, 0.8837875917018899, 0.8739493756983919, 0.8674512947578098, 0.8542607977457125]
micro_F1List [0.8745040065852671, 0.8819971780912157, 0.8857931651031727, 0.8930345484081317, 0.8999251541386912, 0.8952573146108229, 0.8908291325477246, 0.8921863336735043, 0.8836236550758916, 0.8750670380293308, 0.8809151762517711, 0.8774244333273893, 0.8793497989934509, 0.8799840971622093, 0.8840671441640489, 0.8710639446737927, 0.880072952991027, 0.8692729178170009, 0.8622658497002014, 0.8478935410936473]
start testing...
Processed 10000 rows
Processed 20000 rows
Processed 30000 rows
Processed 40000 rows
Processed 50000 rows
Processed 60000 rows
Processed 70000 rows
Processed 80000 rows
0 0.7228108108108108 26744 37000
1 0.961550339715874 43589 45332
Top-1 accuracy: 0.8542607977457125
Top-3 accuracy: 1.0
Top-5 accuracy: 1.0
Macro-F1: 0.8478935410936473
Micro-F1: 0.8542607977457125

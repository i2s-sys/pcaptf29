import matplotlib.pyplot as plt
import numpy as np

# 假设30个epoch的选择因子数组数据保存在一个列表中
epochs = [
    [1.0] * 72,
    [0.9815, 0.9775, 0.9962, 0.9872, 0.9872, 0.9670, 0.9920, 0.9993, 1.0014, 1.0029, 0.9768, 1.0122, 0.9996, 0.9805, 0.9961, 0.9801, 1.0029, 1.0168, 0.9972, 1.0040, 1.0048, 1.0081, 1.0044, 1.0108, 1.0146, 0.9819, 1.0146, 1.0299, 1.0020, 1.0010, 1.0002, 1.0172, 1.0039, 1.0048, 1.0045, 0.9847, 0.9956, 0.9786, 0.9922, 0.9971, 1.0098, 1.0145, 0.9858, 1.0092, 1.0078, 0.9786, 0.9718, 0.9958, 0.9928, 0.9849, 1.0149, 0.9809, 1.0145, 0.9712, 1.0263, 1.0213, 1.0159, 1.0134, 1.0088, 0.9634, 0.9634, 0.9634, 1.0218, 0.9634, 1.0092, 0.9634, 0.9995, 1.0001, 1.0034, 0.9839, 1.0048, 0.9895],
    [0.9726, 0.9501, 1.0056, 0.9867, 0.9851, 0.9516, 0.9923, 1.0012, 0.9998, 1.0025, 0.9759, 1.0080, 1.0002, 0.9861,
     1.0087, 0.9739, 1.0060, 1.0183, 0.9994, 1.0049, 1.0129, 1.0062, 1.0078, 1.0063, 1.0166, 0.9929, 1.0158, 1.0314,
     1.0028, 0.9994, 0.9987, 1.0130, 1.0039, 1.0038, 1.0045, 0.9861, 1.0085, 0.9815, 0.9941, 1.0009, 0.9963, 1.0217,
     0.9964, 1.0131, 0.9955, 0.9805, 0.9674, 0.9880, 0.9952, 0.9832, 1.0162, 0.9900, 1.0181, 0.9649, 1.0344, 1.0251,
     1.0229, 1.0140, 1.0070, 0.9268, 0.9268, 0.9268, 1.0225, 0.9268, 1.0104, 0.9268, 0.9973, 0.9970, 1.0046, 0.9776,
     1.0084, 0.9750],
    [0.9650, 0.9291, 1.0103, 0.9905, 0.9882, 0.9323, 0.9912, 1.0004, 0.9993, 1.0020, 0.9725, 1.0041, 1.0000, 0.9886,
     1.0129, 0.9712, 1.0079, 1.0180, 0.9983, 1.0024, 1.0187, 1.0063, 1.0115, 1.0027, 1.0148, 0.9973, 1.0199, 1.0329,
     1.0027, 0.9986, 0.9981, 1.0090, 1.0040, 1.0017, 1.0036, 0.9915, 1.0156, 0.9735, 0.9932, 0.9995, 0.9902, 1.0284,
     1.0023, 1.0123, 0.9903, 0.9822, 0.9663, 0.9781, 0.9967, 0.9836, 1.0137, 0.9927, 1.0185, 0.9622, 1.0387, 1.0270,
     1.0260, 1.0139, 1.0064, 0.8902, 0.8902, 0.8902, 1.0221, 0.8902, 1.0109, 0.8902, 0.9950, 0.9951, 1.0047, 0.9741,
     1.0090, 0.9712],
    [0.9604, 0.9106, 1.0112, 0.9908, 0.9911, 0.9091, 0.9884, 0.9982, 0.9989, 1.0018, 0.9686, 1.0001, 1.0004, 0.9891,
     1.0143, 0.9718, 1.0088, 1.0174, 0.9975, 1.0011, 1.0232, 1.0061, 1.0136, 1.0000, 1.0130, 1.0011, 1.0221, 1.0347,
     1.0027, 0.9980, 0.9977, 1.0063, 1.0035, 1.0014, 1.0034, 0.9932, 1.0173, 0.9671, 0.9923, 0.9972, 0.9870, 1.0305,
     1.0037, 1.0107, 0.9881, 0.9827, 0.9659, 0.9673, 0.9971, 0.9845, 1.0106, 0.9932, 1.0170, 0.9616, 1.0400, 1.0279,
     1.0266, 1.0140, 1.0057, 0.8536, 0.8536, 0.8536, 1.0217, 0.8536, 1.0103, 0.8536, 0.9936, 0.9945, 1.0046, 0.9717,
     1.0088, 0.9695],
    [0.9561, 0.8894, 1.0126, 0.9903, 0.9930, 0.8827, 0.9827, 0.9941, 0.9983, 1.0017, 0.9644, 0.9964, 1.0007, 0.9906,
     1.0163, 0.9716, 1.0092, 1.0168, 0.9972, 1.0005, 1.0272, 1.0058, 1.0150, 0.9974, 1.0108, 1.0055, 1.0233, 1.0362,
     1.0028, 0.9973, 0.9973, 1.0036, 1.0028, 1.0002, 1.0032, 0.9951, 1.0191, 0.9611, 0.9912, 0.9951, 0.9841, 1.0317,
     1.0041, 1.0090, 0.9857, 0.9835, 0.9662, 0.9556, 0.9972, 0.9849, 1.0064, 0.9938, 1.0155, 0.9610, 1.0418, 1.0287,
     1.0270, 1.0138, 1.0049, 0.8170, 0.8170, 0.8170, 1.0216, 0.8170, 1.0088, 0.8170, 0.9927, 0.9932, 1.0040, 0.9700,
     1.0067, 0.9674],
    [0.9514, 0.8691, 1.0130, 0.9892, 0.9957, 0.8540, 0.9761, 0.9898, 0.9976, 1.0016, 0.9625, 0.9919, 1.0008, 0.9913,
     1.0175, 0.9720, 1.0091, 1.0168, 0.9960, 0.9994, 1.0300, 1.0059, 1.0169, 0.9957, 1.0088, 1.0092, 1.0245, 1.0378,
     1.0027, 0.9966, 0.9967, 1.0006, 1.0024, 0.9990, 1.0022, 0.9962, 1.0203, 0.9572, 0.9901, 0.9939, 0.9809, 1.0314,
     1.0036, 1.0079, 0.9832, 0.9840, 0.9659, 0.9430, 0.9967, 0.9852, 1.0013, 0.9946, 1.0135, 0.9605, 1.0433, 1.0294,
     1.0256, 1.0133, 1.0042, 0.7804, 0.7804, 0.7804, 1.0213, 0.7804, 1.0076, 0.7804, 0.9918, 0.9930, 1.0038, 0.9688,
     1.0029, 0.9647],
    [0.9477, 0.8469, 1.0100, 0.9839, 0.9958, 0.8237, 0.9679, 0.9847, 0.9969, 1.0016, 0.9596, 0.9875, 1.0013, 0.9925,
     1.0184, 0.9723, 1.0088, 1.0168, 0.9955, 0.9990, 1.0324, 1.0053, 1.0183, 0.9947, 1.0073, 1.0121, 1.0257, 1.0392,
     1.0022, 0.9959, 0.9963, 0.9972, 1.0017, 0.9975, 1.0017, 0.9973, 1.0214, 0.9521, 0.9891, 0.9927, 0.9775, 1.0312,
     1.0028, 1.0074, 0.9808, 0.9846, 0.9661, 0.9315, 0.9956, 0.9854, 0.9949, 0.9952, 1.0114, 0.9603, 1.0447, 1.0303,
     1.0241, 1.0131, 1.0031, 0.7438, 0.7438, 0.7438, 1.0211, 0.7438, 1.0060, 0.7438, 0.9910, 0.9923, 1.0035, 0.9684,
     0.9980, 0.9613],
    [0.9437, 0.8234, 1.0076, 0.9801, 0.9991, 0.7930, 0.9582, 0.9789, 0.9962, 1.0013, 0.9572, 0.9832, 1.0014, 0.9933,
     1.0195, 0.9727, 1.0080, 1.0171, 0.9951, 0.9986, 1.0341, 1.0050, 1.0200, 0.9932, 1.0057, 1.0150, 1.0265, 1.0405,
     1.0019, 0.9949, 0.9955, 0.9929, 1.0014, 0.9965, 1.0010, 0.9982, 1.0228, 0.9478, 0.9889, 0.9911, 0.9730, 1.0295,
     1.0028, 1.0064, 0.9778, 0.9851, 0.9666, 0.9206, 0.9962, 0.9855, 0.9868, 0.9954, 1.0094, 0.9595, 1.0458, 1.0313,
     1.0242, 1.0120, 1.0020, 0.7072, 0.7072, 0.7072, 1.0208, 0.7072, 1.0038, 0.7072, 0.9908, 0.9898, 1.0022, 0.9680,
     0.9964, 0.9574],
    [0.9386, 0.7995, 1.0046, 0.9754, 1.0013, 0.7626, 0.9474, 0.9726, 0.9958, 1.0011, 0.9520, 0.9788, 1.0014, 0.9942,
     1.0206, 0.9729, 1.0080, 1.0171, 0.9938, 0.9979, 1.0364, 1.0047, 1.0211, 0.9928, 1.0045, 1.0171, 1.0270, 1.0415,
     1.0014, 0.9938, 0.9946, 0.9878, 1.0012, 0.9945, 1.0005, 0.9988, 1.0232, 0.9433, 0.9878, 0.9907, 0.9692, 1.0292,
     1.0018, 1.0058, 0.9753, 0.9846, 0.9663, 0.9083, 0.9961, 0.9855, 0.9771, 0.9953, 1.0083, 0.9591, 1.0464, 1.0314,
     1.0241, 1.0116, 1.0013, 0.6706, 0.6706, 0.6706, 1.0208, 0.6706, 1.0013, 0.6706, 0.9896, 0.9875, 1.0014, 0.9672,
     0.9942, 0.9545],
    [0.9334, 0.7748, 1.0016, 0.9704, 1.0033, 0.7327, 0.9364, 0.9664, 0.9952, 1.0009, 0.9474, 0.9747, 1.0017, 0.9938,
     1.0216, 0.9732, 1.0077, 1.0166, 0.9934, 0.9974, 1.0361, 1.0040, 1.0217, 0.9921, 1.0032, 1.0169, 1.0277, 1.0418,
     1.0011, 0.9930, 0.9939, 0.9817, 1.0013, 0.9930, 0.9998, 0.9990, 1.0233, 0.9387, 0.9871, 0.9904, 0.9655, 1.0288,
     1.0009, 1.0047, 0.9722, 0.9841, 0.9657, 0.8965, 0.9963, 0.9853, 0.9655, 0.9951, 1.0064, 0.9585, 1.0471, 1.0315,
     1.0235, 1.0110, 1.0011, 0.6339, 0.6339, 0.6339, 1.0207, 0.6339, 0.9984, 0.6339, 0.9892, 0.9847, 0.9999, 0.9670,
     0.9925, 0.9511],
    [0.9297, 0.7486, 0.9971, 0.9643, 1.0036, 0.7030, 0.9264, 0.9588, 0.9946, 1.0016, 0.9436, 0.9684, 1.0017, 0.9941,
     1.0222, 0.9731, 1.0076, 1.0173, 0.9916, 0.9956, 1.0350, 1.0039, 1.0228, 0.9918, 1.0027, 1.0163, 1.0282, 1.0419,
     1.0001, 0.9923, 0.9936, 0.9744, 1.0003, 0.9919, 0.9991, 0.9996, 1.0240, 0.9326, 0.9871, 0.9892, 0.9604, 1.0289,
     1.0002, 1.0040, 0.9685, 0.9840, 0.9655, 0.8865, 0.9953, 0.9856, 0.9520, 0.9955, 1.0057, 0.9575, 1.0476, 1.0320,
     1.0223, 1.0103, 1.0000, 0.5973, 0.5973, 0.5973, 1.0207, 0.5973, 0.9957, 0.5973, 0.9880, 0.9828, 0.9987, 0.9650,
     0.9895, 0.9470],
    [0.9242, 0.7206, 0.9949, 0.9599, 1.0045, 0.6737, 0.9197, 0.9526, 0.9940, 1.0007, 0.9365, 0.9630, 1.0011, 0.9967,
     1.0240, 0.9740, 1.0073, 1.0166, 0.9914, 0.9957, 1.0371, 1.0025, 1.0231, 0.9907, 1.0002, 1.0176, 1.0286, 1.0422,
     0.9989, 0.9915, 0.9932, 0.9657, 0.9991, 0.9898, 0.9991, 1.0005, 1.0250, 0.9273, 0.9856, 0.9887, 0.9554, 1.0279,
     0.9995, 1.0029, 0.9646, 0.9829, 0.9649, 0.8749, 0.9952, 0.9852, 0.9361, 0.9952, 1.0040, 0.9562, 1.0469, 1.0321,
     1.0195, 1.0107, 1.0003, 0.5607, 0.5607, 0.5607, 1.0211, 0.5607, 0.9924, 0.5607, 0.9870, 0.9787, 0.9968, 0.9656,
     0.9882, 0.9433],
    [0.9188, 0.6962, 0.9913, 0.9539, 1.0047, 0.6437, 0.9113, 0.9460, 0.9937, 1.0002, 0.9305, 0.9576, 1.0017, 0.9961,
     1.0238, 0.9740, 1.0065, 1.0164, 0.9902, 0.9947, 1.0361, 1.0021, 1.0234, 0.9905, 0.9983, 1.0162, 1.0290, 1.0418,
     0.9982, 0.9911, 0.9931, 0.9554, 0.9964, 0.9877, 0.9987, 1.0007, 1.0249, 0.9207, 0.9845, 0.9874, 0.9533, 1.0295,
     0.9962, 1.0023, 0.9604, 0.9826, 0.9642, 0.8618, 0.9943, 0.9859, 0.9175, 0.9952, 1.0025, 0.9559, 1.0463, 1.0322,
     1.0183, 1.0106, 1.0003, 0.5241, 0.5241, 0.5241, 1.0212, 0.5241, 0.9900, 0.5241, 0.9862, 0.9760, 0.9951, 0.9639,
     0.9860, 0.9390],
    [0.9150, 0.6693, 0.9877, 0.9487, 1.0072, 0.6142, 0.9004, 0.9364, 0.9927, 1.0006, 0.9247, 0.9505, 1.0013, 0.9970,
     1.0246, 0.9741, 1.0067, 1.0164, 0.9895, 0.9940, 1.0362, 1.0011, 1.0239, 0.9896, 0.9967, 1.0155, 1.0299, 1.0425,
     0.9976, 0.9900, 0.9920, 0.9431, 0.9963, 0.9856, 0.9974, 1.0016, 1.0256, 0.9170, 0.9844, 0.9856, 0.9462, 1.0278,
     0.9975, 1.0018, 0.9555, 0.9815, 0.9636, 0.8508, 0.9954, 0.9847, 0.8964, 0.9944, 1.0016, 0.9547, 1.0463, 1.0325,
     1.0168, 1.0091, 0.9994, 0.4875, 0.4875, 0.4875, 1.0213, 0.4875, 0.9843, 0.4875, 0.9868, 0.9723, 0.9913, 0.9644,
     0.9849, 0.9350],
    [0.9084, 0.6428, 0.9851, 0.9431, 1.0041, 0.5833, 0.8912, 0.9297, 0.9918, 1.0002, 0.9183, 0.9448, 1.0007, 0.9979,
     1.0251, 0.9741, 1.0058, 1.0193, 0.9891, 0.9936, 1.0365, 1.0005, 1.0243, 0.9891, 0.9959, 1.0153, 1.0308, 1.0416,
     0.9964, 0.9887, 0.9906, 0.9289, 0.9955, 0.9827, 0.9977, 1.0037, 1.0270, 0.9134, 0.9827, 0.9822, 0.9415, 1.0277,
     0.9970, 1.0005, 0.9507, 0.9796, 0.9618, 0.8406, 0.9972, 0.9842, 0.8730, 0.9927, 0.9987, 0.9521, 1.0465, 1.0343,
     1.0153, 1.0082, 0.9986, 0.4509, 0.4509, 0.4509, 1.0206, 0.4509, 0.9801, 0.4509, 0.9880, 0.9707, 0.9886, 0.9633,
     0.9827, 0.9272],
    [0.9009, 0.6146, 0.9834, 0.9398, 1.0040, 0.5539, 0.8799, 0.9210, 0.9902, 0.9989, 0.9112, 0.9380, 1.0003, 0.9986,
     1.0261, 0.9744, 1.0056, 1.0179, 0.9896, 0.9947, 1.0395, 1.0009, 1.0263, 0.9883, 0.9946, 1.0182, 1.0316, 1.0426,
     0.9934, 0.9869, 0.9897, 0.9119, 0.9953, 0.9806, 0.9947, 1.0039, 1.0274, 0.9092, 0.9825, 0.9826, 0.9400, 1.0286,
     0.9962, 1.0002, 0.9477, 0.9801, 0.9611, 0.8291, 0.9970, 0.9830, 0.8474, 0.9932, 0.9965, 0.9513, 1.0465, 1.0338,
     1.0118, 1.0080, 0.9994, 0.4143, 0.4143, 0.4143, 1.0203, 0.4143, 0.9763, 0.4143, 0.9869, 0.9668, 0.9867, 0.9631,
     0.9793, 0.9220],
    [0.8928, 0.5856, 0.9813, 0.9360, 1.0020, 0.5235, 0.8673, 0.9113, 0.9896, 0.9994, 0.9037, 0.9315, 1.0004, 0.9982,
     1.0261, 0.9744, 1.0057, 1.0174, 0.9879, 0.9935, 1.0388, 1.0007, 1.0261, 0.9883, 0.9937, 1.0174, 1.0317, 1.0419,
     0.9929, 0.9868, 0.9896, 0.8929, 0.9943, 0.9783, 0.9942, 1.0029, 1.0259, 0.9044, 0.9816, 0.9825, 0.9360, 1.0299,
     0.9939, 1.0000, 0.9428, 0.9785, 0.9598, 0.8179, 0.9963, 0.9830, 0.8192, 0.9925, 0.9948, 0.9502, 1.0470, 1.0338,
     1.0107, 1.0070, 0.9990, 0.3777, 0.3777, 0.3777, 1.0201, 0.3777, 0.9728, 0.3777, 0.9861, 0.9635, 0.9846, 0.9620,
     0.9779, 0.9166],
    [0.8843, 0.5565, 0.9775, 0.9293, 0.9993, 0.4925, 0.8561, 0.9008, 0.9885, 0.9989, 0.8963, 0.9247, 1.0004, 0.9977,
     1.0261, 0.9743, 1.0051, 1.0172, 0.9876, 0.9927, 1.0380, 0.9999, 1.0260, 0.9880, 0.9930, 1.0160, 1.0313, 1.0409,
     0.9927, 0.9864, 0.9892, 0.8713, 0.9934, 0.9759, 0.9937, 1.0019, 1.0251, 0.9014, 0.9812, 0.9820, 0.9317, 1.0288,
     0.9902, 0.9986, 0.9397, 0.9777, 0.9588, 0.8057, 0.9958, 0.9820, 0.7891, 0.9921, 0.9922, 0.9491, 1.0460, 1.0331,
     1.0093, 1.0064, 0.9986, 0.3411, 0.3411, 0.3411, 1.0198, 0.3411, 0.9684, 0.3411, 0.9857, 0.9598, 0.9826, 0.9605,
     0.9758, 0.9092],
    [0.8754, 0.5241, 0.9771, 0.9273, 0.9971, 0.4609, 0.8419, 0.8918, 0.9857, 0.9996, 0.8883, 0.9147, 1.0004, 0.9976,
     1.0264, 0.9743, 1.0053, 1.0163, 0.9869, 0.9924, 1.0375, 0.9997, 1.0264, 0.9880, 0.9940, 1.0130, 1.0308, 1.0401,
     0.9921, 0.9858, 0.9887, 0.8472, 0.9912, 0.9720, 0.9947, 1.0028, 1.0261, 0.8945, 0.9792, 0.9813, 0.9283, 1.0294,
     0.9871, 0.9981, 0.9359, 0.9759, 0.9579, 0.7912, 0.9955, 0.9828, 0.7574, 0.9907, 0.9893, 0.9469, 1.0480, 1.0343,
     1.0082, 1.0047, 0.9962, 0.3045, 0.3045, 0.3045, 1.0206, 0.3045, 0.9639, 0.3045, 0.9834, 0.9553, 0.9800, 0.9622,
     0.9744, 0.9055],
    [0.8700, 0.4932, 0.9753, 0.9252, 0.9968, 0.4302, 0.8305, 0.8834, 0.9851, 0.9981, 0.8799, 0.9092, 1.0002, 0.9986,
     1.0269, 0.9744, 1.0047, 1.0154, 0.9863, 0.9909, 1.0378, 1.0000, 1.0279, 0.9881, 0.9935, 1.0117, 1.0308, 1.0402,
     0.9901, 0.9852, 0.9882, 0.8259, 0.9881, 0.9671, 0.9919, 1.0034, 1.0275, 0.8909, 0.9773, 0.9820, 0.9251, 1.0282,
     0.9840, 0.9969, 0.9341, 0.9766, 0.9590, 0.7860, 0.9964, 0.9824, 0.7329, 0.9897, 0.9859, 0.9439, 1.0502, 1.0358,
     1.0059, 1.0024, 0.9935, 0.2679, 0.2679, 0.2679, 1.0222, 0.2679, 0.9591, 0.2679, 0.9847, 0.9512, 0.9747, 0.9615,
     0.9750, 0.9038],
    [0.8631, 0.4619, 0.9733, 0.9224, 0.9950, 0.3974, 0.8170, 0.8738, 0.9834, 0.9970, 0.8712, 0.9043, 1.0000, 0.9986,
     1.0271, 0.9746, 1.0048, 1.0157, 0.9865, 0.9899, 1.0373, 0.9994, 1.0289, 0.9881, 0.9919, 1.0113, 1.0317, 1.0405,
     0.9902, 0.9834, 0.9865, 0.8050, 0.9881, 0.9646, 0.9904, 1.0039, 1.0263, 0.8860, 0.9764, 0.9827, 0.9202, 1.0288,
     0.9834, 0.9951, 0.9299, 0.9754, 0.9574, 0.7784, 0.9953, 0.9823, 0.7081, 0.9896, 0.9834, 0.9441, 1.0506, 1.0366,
     1.0034, 1.0020, 0.9932, 0.2313, 0.2313, 0.2313, 1.0210, 0.2313, 0.9570, 0.2313, 0.9846, 0.9469, 0.9713, 0.9612,
     0.9746, 0.8994],
    [0.8557, 0.4303, 0.9703, 0.9177, 0.9915, 0.3653, 0.8034, 0.8629, 0.9821, 0.9968, 0.8647, 0.8983, 1.0000, 0.9984,
     1.0270, 0.9745, 1.0045, 1.0157, 0.9857, 0.9894, 1.0358, 0.9985, 1.0283, 0.9879, 0.9917, 1.0097, 1.0319, 1.0390,
     0.9898, 0.9830, 0.9864, 0.7809, 0.9870, 0.9625, 0.9897, 1.0030, 1.0256, 0.8834, 0.9757, 0.9818, 0.9167, 1.0277,
     0.9807, 0.9945, 0.9276, 0.9738, 0.9554, 0.7695, 0.9956, 0.9812, 0.6811, 0.9886, 0.9813, 0.9426, 1.0496, 1.0356,
     1.0003, 1.0016, 0.9932, 0.1947, 0.1947, 0.1947, 1.0208, 0.1947, 0.9531, 0.1947, 0.9845, 0.9450, 0.9701, 0.9598,
     0.9709, 0.8927],
    [0.8437, 0.3959, 0.9696, 0.9153, 0.9931, 0.3347, 0.7881, 0.8523, 0.9829, 0.9943, 0.8538, 0.8897, 0.9999, 0.9983,
     1.0273, 0.9749, 1.0031, 1.0159, 0.9878, 0.9905, 1.0391, 0.9978, 1.0317, 0.9870, 0.9918, 1.0134, 1.0329, 1.0410,
     0.9873, 0.9797, 0.9845, 0.7547, 0.9862, 0.9603, 0.9868, 1.0038, 1.0277, 0.8792, 0.9740, 0.9797, 0.9150, 1.0297,
     0.9803, 0.9944, 0.9248, 0.9737, 0.9562, 0.7630, 0.9975, 0.9798, 0.6521, 0.9861, 0.9758, 0.9382, 1.0537, 1.0418,
     0.9969, 0.9955, 0.9863, 0.1581, 0.1581, 0.1581, 1.0229, 0.1581, 0.9552, 0.1581, 0.9863, 0.9365, 0.9644, 0.9623,
     0.9751, 0.8911],
    [0.8345, 0.3733, 0.9701, 0.9142, 0.9895, 0.3019, 0.7684, 0.8413, 0.9811, 0.9946, 0.8496, 0.8847, 0.9998, 0.9982,
     1.0274, 0.9748, 1.0033, 1.0165, 0.9867, 0.9885, 1.0379, 0.9977, 1.0319, 0.9870, 0.9916, 1.0124, 1.0334, 1.0407,
     0.9868, 0.9794, 0.9844, 0.7261, 0.9860, 0.9560, 0.9839, 1.0043, 1.0284, 0.8762, 0.9732, 0.9789, 0.9137, 1.0288,
     0.9801, 0.9942, 0.9224, 0.9737, 0.9560, 0.7541, 0.9983, 0.9799, 0.6213, 0.9856, 0.9730, 0.9365, 1.0541, 1.0415,
     0.9937, 0.9952, 0.9869, 0.1215, 0.1215, 0.1215, 1.0220, 0.1215, 0.9536, 0.1215, 0.9861, 0.9363, 0.9644, 0.9621,
     0.9739, 0.8879],
    [0.8262, 0.3480, 0.9671, 0.9093, 0.9864, 0.2686, 0.7531, 0.8289, 0.9800, 0.9942, 0.8454, 0.8795, 0.9997, 0.9984,
     1.0276, 0.9747, 1.0032, 1.0165, 0.9861, 0.9877, 1.0367, 0.9974, 1.0318, 0.9871, 0.9901, 1.0109, 1.0342, 1.0405,
     0.9866, 0.9786, 0.9838, 0.6955, 0.9858, 0.9527, 0.9824, 1.0041, 1.0280, 0.8721, 0.9719, 0.9789, 0.9124, 1.0281,
     0.9799, 0.9931, 0.9201, 0.9728, 0.9548, 0.7437, 0.9980, 0.9793, 0.5889, 0.9853, 0.9718, 0.9350, 1.0535, 1.0412,
     0.9893, 0.9951, 0.9869, 0.0849, 0.0849, 0.0849, 1.0220, 0.0849, 0.9527, 0.0849, 0.9857, 0.9357, 0.9642, 0.9617,
     0.9724, 0.8844],
    [0.8168, 0.3216, 0.9637, 0.9042, 0.9832, 0.2348, 0.7362, 0.8160, 0.9785, 0.9942, 0.8404, 0.8752, 0.9999, 0.9983,
     1.0274, 0.9745, 1.0032, 1.0163, 0.9857, 0.9871, 1.0354, 0.9964, 1.0307, 0.9871, 0.9896, 1.0089, 1.0341, 1.0394,
     0.9864, 0.9783, 0.9838, 0.6633, 0.9839, 0.9497, 0.9809, 1.0036, 1.0280, 0.8694, 0.9713, 0.9787, 0.9113, 1.0270,
     0.9786, 0.9916, 0.9179, 0.9727, 0.9540, 0.7306, 0.9971, 0.9779, 0.5553, 0.9841, 0.9707, 0.9336, 1.0533, 1.0405,
     0.9857, 0.9952, 0.9870, 0.0483, 0.0483, 0.0483, 1.0219, 0.0483, 0.9513, 0.0483, 0.9854, 0.9346, 0.9636, 0.9613,
     0.9714, 0.8802],
    [0.8062, 0.2935, 0.9599, 0.8981, 0.9780, 0.1996, 0.7175, 0.8011, 0.9768, 0.9934, 0.8331, 0.8684, 0.9997, 0.9980,
     1.0275, 0.9744, 1.0030, 1.0167, 0.9853, 0.9861, 1.0344, 0.9960, 1.0302, 0.9868, 0.9883, 1.0074, 1.0343, 1.0386,
     0.9862, 0.9778, 0.9834, 0.6300, 0.9831, 0.9470, 0.9800, 1.0023, 1.0273, 0.8657, 0.9702, 0.9781, 0.9102, 1.0260,
     0.9771, 0.9905, 0.9152, 0.9719, 0.9529, 0.7190, 0.9966, 0.9771, 0.5209, 0.9836, 0.9687, 0.9319, 1.0522, 1.0398,
     0.9793, 0.9946, 0.9868, 0.0117, 0.0117, 0.0117, 1.0216, 0.0117, 0.9497, 0.0117, 0.9852, 0.9338, 0.9632, 0.9611,
     0.9700, 0.8759],
    [0.7933, 0.2638, 0.9574, 0.8942, 0.9729, 0.1646, 0.6970, 0.7863, 0.9753, 0.9929, 0.8251, 0.8591, 0.9996, 0.9975,
     1.0279, 0.9746, 1.0035, 1.0167, 0.9853, 0.9862, 1.0344, 0.9945, 1.0295, 0.9861, 0.9867, 1.0064, 1.0338, 1.0385,
     0.9858, 0.9773, 0.9834, 0.6036, 0.9832, 0.9422, 0.9772, 1.0020, 1.0268, 0.8604, 0.9678, 0.9792, 0.9092, 1.0246,
     0.9761, 0.9888, 0.9110, 0.9708, 0.9526, 0.7089, 0.9969, 0.9755, 0.4864, 0.9818, 0.9666, 0.9274, 1.0510, 1.0412,
     0.9738, 0.9937, 0.9874, -0.00003, -0.0003, -0.00003, 1.02167, -0.00003, 0.94647, -0.00003, 0.98541, 0.93290,
     0.96235, 0.95973, 0.9698, 0.87047],
    [0.7809, 0.2333, 0.9553, 0.8911, 0.9659, 0.1337, 0.6834, 0.7742, 0.9734, 0.9922, 0.8174, 0.8519, 0.9997, 0.9973,
     1.0277, 0.9744, 1.0031, 1.0175, 0.9839, 0.9851, 1.0339, 0.9944, 1.0296, 0.9854, 0.9877, 1.0046, 1.0338, 1.0369,
     0.9853, 0.9767, 0.9826, 0.5756, 0.9831, 0.9406, 0.9774, 1.0023, 1.0263, 0.8562, 0.9650, 0.9782, 0.9079, 1.0232,
     0.9741, 0.9879, 0.9093, 0.9701, 0.9510, 0.6947, 0.9956, 0.9744, 0.4509, 0.9811, 0.9671, 0.9268, 1.05110, 1.04135,
     0.97116, 0.99263, 0.98711, 0.00001, 0.0000, 0.00001, 1.02044, 0.00001, 0.94615, 0.00001, 0.98564, 0.93107, 0.96142,
     0.95936, 0.9673, 0.86433],
    [0.7697, 0.2012, 0.9520, 0.8869, 0.9607, 0.1012, 0.6724, 0.7625, 0.9709, 0.9917, 0.8110, 0.8430, 0.9996, 0.9972,
     1.0278, 0.9744, 1.0030, 1.0159, 0.9834, 0.9836, 1.0317, 0.9940, 1.0302, 0.9852, 0.9872, 1.0010, 1.0345, 1.0362,
     0.9846, 0.9753, 0.9815, 0.5505, 0.9810, 0.9389, 0.9767, 1.0009, 1.0267, 0.8522, 0.9647, 0.9779, 0.9062, 1.0214,
     0.9721, 0.9859, 0.9067, 0.9694, 0.9502, 0.6772, 0.9943, 0.9747, 0.4198, 0.9799, 0.9643, 0.9244, 1.0504, 1.0403,
     0.9661, 0.9917, 0.9867, 0.00002, 0.0000, 0.00002, 1.0213, 0.00002, 0.94414, 0.00002, 0.9846, 0.9305, 0.9610,
     0.95736, 0.9650, 0.85678],

]
# 获取第30个epoch的选择因子数组
epoch_30 = epochs[-1]

# 排序并选择最大的6个值和最小的6个值的下标
sorted_indices = np.argsort(epoch_30)
min_indices = sorted_indices[:6]
max_indices = sorted_indices[-6:]

# 提取这些下标在30个epoch对应的选择因子值
selected_indices = np.concatenate([min_indices, max_indices])
selected_factors = np.array(epochs)[:, selected_indices]

# 画图
plt.figure(figsize=(12, 6))
colors = ['b', 'g', 'r', 'c', 'm', 'y']  # 彩色线颜色

for i in range(len(max_indices)):
    plt.plot(range(31), selected_factors[:, len(min_indices) + i], color=colors[i % len(colors)], label=f'Index {max_indices[i]}')

for i in range(len(min_indices)):
    plt.plot(range(31), selected_factors[:, i], color='brown', label=f'Index {min_indices[i]}')


plt.ylim(0, 1.5)
plt.xlabel('Epoch')
plt.ylabel('factor_value')
plt.legend()
plt.show()

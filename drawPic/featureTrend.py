import time

import numpy as np
import matplotlib.pyplot as plt
import os
Epoch0 = [1] * 72
Epoch1 = [0.9700000286102295, 0.8500000238418579, 0.9200000166893005, 0.949999988079071, 0.970000286102295, 0.8999999761581421, 0.9399999976158142, 0.9300000071525574, 1.0, 1.0, 0.970000286102295, 0.9599999785423279, 0.9900000095367432, 1.0299999713897705, 0.9900000095367432, 1.10000023841858, 1.0199999809265137, 0.9800000190734863, 0.9800000190734863, 1.0, 1.0, 1.009999904632568, 0.9800000190734863, 1.0099999904632568, 1.0, 0.9700000286102295, 1.0, 0.94999988079071, 1.0099999904632568, 1.0199999809265137, 1.0, 1.0199999809265137, 1.0, 1.009999904632568, 0.9900000095367432, 1.0099999904632568, 1.0199999809265137, 1.0299999713897705, 1.009999904632568, 1.0, 1.0199999809265137, 0.9900000095367432, 1.0299999713897705, 0.9800000190734863, 0.990000095367432, 0.9900000095367432, 1.0199999809265137, 1.0099999904632568, 1.0, 1.0099999904632568, 1.009999904632568, 1.0099999904632568, 0.9900000095367432, 1.0199999809265137, 1.0199999809265137, 1.029999713897705, 1.0499999523162842, 0.9599999785423279, 1.0, 0.7599999904632568, 0.9800000190734863, 1.009999904632568, 1.0099999904632568, 0.7599999904632568, 1.0199999809265137, 0.7599999904632568, 0.990000095367432, 1.0099999904632568, 1.0, 0.9700000286102295, 1.0299999713897705, 0.9800000190734863]
Epoch2 = [0.9599999785423279, 0.7300000190734863, 0.8899999856948853, 0.9399999976158142, 0.970000286102295, 0.8600000143051147, 0.9300000071525574, 0.9200000166893005, 1.0, 0.9900000095367432, 0.959999785423279, 0.9399999976158142, 0.9900000095367432, 1.0299999713897705, 1.0, 1.1200000047683716, 1.029999713897705, 0.9800000190734863, 0.9800000190734863, 1.0, 1.0, 1.0099999904632568, 0.970000286102295, 1.0199999809265137, 1.0099999904632568, 0.949999988079071, 1.0, 0.9399999976158142, 1.009999904632568, 1.0199999809265137, 1.0, 1.0199999809265137, 1.0099999904632568, 1.0099999904632568, 1.0, 1.099999904632568, 1.0199999809265137, 1.0199999809265137, 1.0, 1.0099999904632568, 1.009999904632568, 0.9900000095367432, 1.0299999713897705, 0.9800000190734863, 1.0, 0.9900000095367432, 1.029999713897705, 1.0299999713897705, 1.0, 1.0, 1.0099999904632568, 1.0099999904632568, 0.990000095367432, 1.0199999809265137, 1.0099999904632568, 1.0499999523162842, 1.090000033378601, 0.939999976158142, 1.0, 0.5199999809265137, 0.9800000190734863, 1.0099999904632568, 1.0099999904632568, 0.519999809265137, 1.0199999809265137, 0.5199999809265137, 0.9900000095367432, 1.0099999904632568, 1.0, 0.959999785423279, 1.0299999713897705, 0.9800000190734863]
Epoch3 = [0.9399999976158142, 0.6000000238418579, 0.8500000238418579, 0.9300000071525574, 0.970000286102295, 0.8299999833106995, 0.9100000262260437, 0.9100000262260437, 1.0, 0.9900000095367432, 0.959999785423279, 0.9300000071525574, 0.9800000190734863, 1.0399999618530273, 1.0, 1.1399999856948853, 1.029999713897705, 0.9800000190734863, 0.9900000095367432, 1.0, 1.0199999809265137, 1.0099999904632568, 0.970000286102295, 1.0199999809265137, 1.0099999904632568, 0.9399999976158142, 1.0, 0.9399999976158142, 1.009999904632568, 1.0199999809265137, 1.0, 1.0199999809265137, 1.0099999904632568, 1.0099999904632568, 1.0, 1.099999904632568, 1.0199999809265137, 1.0199999809265137, 1.0, 1.0099999904632568, 1.009999904632568, 0.9800000190734863, 1.0199999809265137, 0.9700000286102295, 1.0, 0.9800000190734863, 1.039999618530273, 1.0299999713897705, 0.9900000095367432, 1.0, 1.0099999904632568, 1.0, 0.990000095367432, 1.0299999713897705, 1.0099999904632568, 1.059999942779541, 1.1100000143051147, 0.930000071525574, 1.0, 0.2800000011920929, 0.9800000190734863, 1.0099999904632568, 1.0099999904632568, 0.280000011920929, 1.0299999713897705, 0.2800000011920929, 0.9900000095367432, 1.0099999904632568, 1.0, 0.94999988079071, 1.0299999713897705, 0.9800000190734863]
Epoch4 = [0.9100000262260437, 0.550000011920929, 0.7799999713897705, 0.9200000166893005, 0.970000286102295, 0.7900000214576721, 0.8799999952316284, 0.8899999856948853, 1.0, 0.9900000095367432, 0.959999785423279, 0.9300000071525574, 0.9800000190734863, 1.0399999618530273, 1.0099999904632568, 1.14999976158142, 1.0299999713897705, 0.9800000190734863, 0.9800000190734863, 1.0199999809265137, 1.05999942779541, 1.0099999904632568, 0.9700000286102295, 1.0299999713897705, 1.0199999809265137, 0.930000071525574, 1.0, 0.9300000071525574, 1.0099999904632568, 1.0299999713897705, 1.0, 1.019999809265137, 1.0099999904632568, 1.0099999904632568, 1.0, 1.0099999904632568, 1.0199999809265137, 1.009999904632568, 1.0099999904632568, 1.0, 1.0099999904632568, 0.9800000190734863, 1.0099999904632568, 0.970000286102295, 0.9900000095367432, 0.9800000190734863, 1.0399999618530273, 1.0199999809265137, 0.990000095367432, 0.9900000095367432, 1.0099999904632568, 1.0, 0.9900000095367432, 1.0299999713897705, 1.009999904632568, 1.059999942779541, 1.1200000047683716, 0.9300000071525574, 1.0, 0.05000000074505806, 0.970000286102295, 1.0099999904632568, 1.0199999809265137, 0.05000000074505806, 1.0299999713897705, 0.0500000074505806, 0.9800000190734863, 1.0, 1.0, 0.949999988079071, 1.0399999618530273, 0.980000190734863]
Epoch5 = [0.8899999856948853, 0.5099999904632568, 0.75, 0.9200000166893005, 0.9800000190734863, 0.740000095367432, 0.8399999737739563, 0.8700000047683716, 1.0, 0.9900000095367432, 0.9700000286102295, 0.939999976158142, 0.9800000190734863, 1.0399999618530273, 1.0099999904632568, 1.159999966621399, 1.029999713897705, 0.9800000190734863, 0.9800000190734863, 1.0299999713897705, 1.0800000429153442, 1.009999904632568, 0.9599999785423279, 1.0299999713897705, 1.0199999809265137, 0.9300000071525574, 1.0, 0.930000071525574, 1.0, 1.0299999713897705, 0.9900000095367432, 1.0099999904632568, 1.0099999904632568, 1.009999904632568, 1.0099999904632568, 1.0099999904632568, 1.0199999809265137, 1.0, 1.0099999904632568, 1.0, 1.099999904632568, 0.9800000190734863, 1.0099999904632568, 0.9700000286102295, 1.0, 0.980000190734863, 1.0399999618530273, 1.0099999904632568, 0.9800000190734863, 0.9900000095367432, 1.009999904632568, 1.0, 0.9900000095367432, 1.0299999713897705, 1.0099999904632568, 1.0700000524520874, 1.129999952316284, 0.9200000166893005, 1.0, -0.0, 0.9800000190734863, 1.0099999904632568, 1.019999809265137, -0.0, 1.0299999713897705, -0.0, 0.9800000190734863, 1.0, 1.0, 0.9399999976158142, 1.039999618530273, 0.9700000286102295]
Epoch6 = [0.8700000047683716, 0.44999998807907104, 0.7099999785423279, 0.9200000166893005, 0.990000095367432, 0.6800000071525574, 0.7900000214576721, 0.8199999928474426, 1.0, 0.9900000095367432, 0.990000095367432, 0.9300000071525574, 0.9800000190734863, 1.0399999618530273, 1.0, 1.159999966621399, 1.039999618530273, 0.9800000190734863, 0.9900000095367432, 1.0399999618530273, 1.090000033378601, 1.009999904632568, 0.9599999785423279, 1.0299999713897705, 1.0299999713897705, 0.9300000071525574, 1.0, 0.930000071525574, 1.0, 1.0199999809265137, 0.9900000095367432, 1.0, 1.0, 1.0099999904632568, 1.0, 1.009999904632568, 1.0199999809265137, 1.0, 1.0099999904632568, 1.0, 1.0099999904632568, 0.980000190734863, 1.0099999904632568, 0.9700000286102295, 0.9900000095367432, 0.9700000286102295, 1.039999618530273, 1.0099999904632568, 0.9800000190734863, 0.9900000095367432, 1.0099999904632568, 1.0, 0.990000095367432, 1.0299999713897705, 1.0099999904632568, 1.0700000524520874, 1.1299999952316284, 0.920000166893005, 1.0, 0.0, 0.9700000286102295, 1.0099999904632568, 1.0199999809265137, 0.0, 1.039999618530273, 0.0, 0.9800000190734863, 1.0, 1.0, 0.9399999976158142, 1.0399999618530273, 0.970000286102295]
Epoch7 = [0.8399999737739563, 0.3799999952316284, 0.6800000071525574, 0.9399999976158142, 1.019999809265137, 0.6200000047683716, 0.7300000190734863, 0.7699999809265137, 0.9900000095367432, 0.980000190734863, 1.0, 0.9300000071525574, 0.9800000190734863, 1.0399999618530273, 1.0, 1.169999570846558, 1.0399999618530273, 0.9800000190734863, 0.9800000190734863, 1.0399999618530273, 1.10000023841858, 1.0099999904632568, 0.9599999785423279, 1.0299999713897705, 1.0299999713897705, 0.930000071525574, 1.0099999904632568, 0.9300000071525574, 1.0, 1.0199999809265137, 0.9800000190734863, 0.990000095367432, 1.0, 1.0099999904632568, 1.0099999904632568, 1.0, 1.0199999809265137, 1.0, 1.0, 1.0, 1.019999809265137, 0.9800000190734863, 1.0099999904632568, 0.9800000190734863, 1.0, 0.9700000286102295, 1.039999618530273, 1.0, 0.9700000286102295, 0.9900000095367432, 1.0099999904632568, 1.0, 0.990000095367432, 1.0299999713897705, 1.0, 1.0800000429153442, 1.1399999856948853, 0.9100000262260437, 0.990000095367432, -0.0, 0.9700000286102295, 1.0, 1.0199999809265137, -0.0, 1.0499999523162842, -0.0, 0.980000190734863, 0.9900000095367432, 1.0, 0.9399999976158142, 1.0499999523162842, 0.9599999785423279]
Epoch8 = [0.7900000214576721, 0.3199999928474426, 0.6499999761581421, 0.9399999976158142, 1.029999713897705, 0.5600000023841858, 0.6899999976158142, 0.7300000190734863, 0.9900000095367432, 0.980000190734863, 1.0099999904632568, 0.9399999976158142, 0.9800000190734863, 1.0499999523162842, 1.009999904632568, 1.1799999475479126, 1.0399999618530273, 0.9800000190734863, 0.9800000190734863, 1.049999523162842, 1.1100000143051147, 1.0099999904632568, 0.9599999785423279, 1.0299999713897705, 1.029999713897705, 0.9200000166893005, 1.0, 0.9200000166893005, 0.9900000095367432, 1.0199999809265137, 0.980000190734863, 0.9900000095367432, 1.0, 1.0099999904632568, 1.0099999904632568, 1.0, 1.019999809265137, 1.0, 1.0099999904632568, 1.0, 1.0199999809265137, 0.9700000286102295, 1.009999904632568, 0.9700000286102295, 1.0, 0.9599999785423279, 1.0399999618530273, 1.0, 0.970000286102295, 0.9900000095367432, 1.0099999904632568, 1.0, 0.9900000095367432, 1.0299999713897705, 1.0, 1.800000429153442, 1.149999976158142, 0.9100000262260437, 0.9900000095367432, -0.0, 0.970000286102295, 1.0, 1.0199999809265137, -0.0, 1.0499999523162842, -0.0, 0.9800000190734863, 0.990000095367432, 1.0, 0.949999988079071, 1.0499999523162842, 0.9599999785423279]
Epoch9 = [0.7400000095367432, 0.23000000417232513, 0.6000000238418579, 0.9599999785423279, 1.05999942779541, 0.5, 0.6499999761581421, 0.6700000166893005, 0.9900000095367432, 0.9800000190734863, 1.019999809265137, 0.9399999976158142, 0.9700000286102295, 1.0499999523162842, 1.0099999904632568, 1.179999475479126, 1.0399999618530273, 0.9700000286102295, 0.9800000190734863, 1.059999942779541, 1.120000047683716, 1.0, 0.9599999785423279, 1.0299999713897705, 1.0399999618530273, 0.9200000166893005, 1.009999904632568, 0.9200000166893005, 0.9900000095367432, 1.0199999809265137, 0.9800000190734863, 0.990000095367432, 1.0, 1.0099999904632568, 1.0099999904632568, 1.0, 1.0199999809265137, 0.990000095367432, 1.0099999904632568, 0.9900000095367432, 1.0199999809265137, 0.9700000286102295, 1.009999904632568, 0.9800000190734863, 1.0, 0.9599999785423279, 1.0399999618530273, 1.0, 0.970000286102295, 0.9900000095367432, 1.0099999904632568, 1.0, 0.9900000095367432, 1.0299999713897705, 1.009999904632568, 1.0800000429153442, 1.149999976158142, 0.9100000262260437, 0.9900000095367432, 0.0, 0.970000286102295, 1.0099999904632568, 1.0299999713897705, 0.0, 1.0499999523162842, 0.0, 0.980000190734863, 0.9800000190734863, 1.0, 0.949999988079071, 1.059999942779541, 0.9599999785423279]
Epoch10 = [0.6800000071525574, 0.14000000059604645, 0.5400000214576721, 0.9700000286102295, 1.080000429153442, 0.41999998688697815, 0.6200000047683716, 0.6100000143051147, 0.9900000095367432, 0.980000190734863, 1.0299999713897705, 0.9399999976158142, 0.9700000286102295, 1.0499999523162842, 1.009999904632568, 1.190000057220459, 1.0399999618530273, 0.9700000286102295, 0.9800000190734863, 1.05999942779541, 1.1200000047683716, 1.0, 0.9599999785423279, 1.0299999713897705, 1.0399999618530273, 0.920000166893005, 1.0099999904632568, 0.9200000166893005, 0.9900000095367432, 1.0199999809265137, 0.970000286102295, 0.9900000095367432, 1.0, 1.0099999904632568, 1.0099999904632568, 1.0, 1.019999809265137, 0.9900000095367432, 1.0099999904632568, 0.9900000095367432, 1.0199999809265137, 0.970000286102295, 1.0099999904632568, 0.9800000190734863, 1.0, 0.9599999785423279, 1.0399999618530273, 1.0, 0.700000286102295, 0.9900000095367432, 1.0, 1.0, 0.9800000190734863, 1.0299999713897705, 1.009999904632568, 1.0800000429153442, 1.159999966621399, 0.9100000262260437, 0.9900000095367432, 0.0, 0.970000286102295, 1.0099999904632568, 1.0299999713897705, 0.0, 1.0499999523162842, 0.0, 0.980000190734863, 0.9800000190734863, 0.9900000095367432, 0.949999988079071, 1.059999942779541, 0.94999988079071]
Epoch11 = [0.6299999952316284, 0.07000000029802322, 0.47999998927116394, 0.9900000095367432, 1.10000023841858, 0.36000001430511475, 0.6000000238418579, 0.5699999928474426, 0.9900000095367432, 0.980000190734863, 1.0499999523162842, 0.9399999976158142, 0.9700000286102295, 1.0499999523162842, 1.009999904632568, 1.190000057220459, 1.0399999618530273, 0.9700000286102295, 0.9900000095367432, 1.070000524520874, 1.1200000047683716, 1.0, 0.9599999785423279, 1.0299999713897705, 1.0399999618530273, 0.920000166893005, 1.0, 0.9200000166893005, 0.9800000190734863, 1.0199999809265137, 0.9700000286102295, 0.980000190734863, 1.0, 1.0099999904632568, 1.0099999904632568, 1.0, 1.0299999713897705, 1.0, 1.009999904632568, 0.9900000095367432, 1.0199999809265137, 0.9700000286102295, 1.0, 0.9800000190734863, 1.0, 0.49999988079071, 1.0399999618530273, 0.9900000095367432, 0.9599999785423279, 0.9900000095367432, 1.0, 1., 0.9800000190734863, 1.0299999713897705, 1.0, 1.0800000429153442, 1.159999966621399, 0.910000262260437, 0.9900000095367432, -0.0, 0.9700000286102295, 1.0, 1.0299999713897705, -0.0, 1.049999523162842, -0.0, 0.9800000190734863, 0.9800000190734863, 0.9900000095367432, 0.9599999785423279, 1.05999942779541, 0.949999988079071]
Epoch12 = [0.5899999737739563, 0.03999999910593033, 0.41999998688697815, 0.9900000095367432, 1.120000047683716, 0.28999999165534973, 0.5600000023841858, 0.5199999809265137, 0.9800000190734863, 0.980000190734863, 1.0700000524520874, 0.9399999976158142, 0.9700000286102295, 1.0499999523162842, 1.009999904632568, 1.190000057220459, 1.0399999618530273, 0.9700000286102295, 0.9900000095367432, 1.070000524520874, 1.1299999952316284, 1.0, 0.9599999785423279, 1.0299999713897705, 1.0399999618530273, 0.910000262260437, 1.0, 0.9200000166893005, 0.9800000190734863, 1.0199999809265137, 0.9700000286102295, 0.980000190734863, 1.0, 1.0199999809265137, 1.0099999904632568, 1.0, 1.0299999713897705, 1.0, 1.009999904632568, 0.9900000095367432, 1.0199999809265137, 0.9700000286102295, 1.0, 0.9800000190734863, 1.0, 0.49999988079071, 1.0299999713897705, 0.9900000095367432, 0.9700000286102295, 0.9900000095367432, 1.0, 1., 0.9700000286102295, 1.0199999809265137, 1.0, 1.0800000429153442, 1.159999966621399, 0.910000262260437, 0.9800000190734863, 0.0, 0.9700000286102295, 1.0, 1.0299999713897705, 0.0, 1.049999523162842, 0.0, 0.9800000190734863, 0.9800000190734863, 0.9900000095367432, 0.9599999785423279, 1.070000524520874, 0.949999988079071]
Epoch13 = [0.5600000023841858, 0.009999999776482582, 0.36000001430511475, 1.0, 1.1299999952316284, 0.219999988079071, 0.5199999809265137, 0.49000000953674316, 0.9800000190734863, 0.9800000190734863, 1.080000429153442, 0.949999988079071, 0.9700000286102295, 1.0499999523162842, 1.0099999904632568, 1.200000476837158, 1.0399999618530273, 0.9700000286102295, 0.9900000095367432, 1.0800000429153442, 1.129999952316284, 1.0, 0.9599999785423279, 1.0399999618530273, 1.0499999523162842, 0.9100000262260437, 1.0, 0.200000166893005, 0.9800000190734863, 1.0199999809265137, 0.9599999785423279, 0.9800000190734863, 1.009999904632568, 1.0099999904632568, 1.0099999904632568, 1.0, 1.0299999713897705, 1.0, 1.009999904632568, 0.9900000095367432, 1.0199999809265137, 0.9700000286102295, 1.0, 0.9800000190734863, 1.0, 0.49999988079071, 1.0299999713897705, 0.9900000095367432, 0.9700000286102295, 0.9900000095367432, 1.0, 1., 0.9700000286102295, 1.0199999809265137, 1.0, 1.090000033378601, 1.1699999570846558, 0.899999761581421, 0.9800000190734863, 0.0, 0.9599999785423279, 1.0, 1.0299999713897705, 0.0, 1.05999942779541, 0.0, 0.9700000286102295, 0.9700000286102295, 0.9900000095367432, 0.9599999785423279, 1.05999942779541, 0.9399999976158142]
Epoch14 = [0.550000011920929, -0.0, 0.2800000011920929, 1.0, 1.1299999952316284, 0.14000000059604645, 0.519999809265137, 0.47999998927116394, 0.9800000190734863, 0.9700000286102295, 1.090000033378601, 0.959999785423279, 0.9700000286102295, 1.0499999523162842, 1.0099999904632568, 1.2000000476837158, 1.049999523162842, 0.9700000286102295, 0.9800000190734863, 1.0800000429153442, 1.1399999856948853, 1.0, 0.959999785423279, 1.0399999618530273, 1.0499999523162842, 0.9100000262260437, 1.0, 0.9200000166893005, 0.980000190734863, 1.0099999904632568, 0.9599999785423279, 0.9800000190734863, 1.0, 1.0099999904632568, 1.009999904632568, 1.0, 1.0299999713897705, 1.0, 1.0099999904632568, 0.9900000095367432, 1.019999809265137, 0.9700000286102295, 1.0, 0.9800000190734863, 1.0, 0.9399999976158142, 1.029999713897705, 0.9900000095367432, 0.9599999785423279, 0.9900000095367432, 1.0, 0.9900000095367432, 0.970000286102295, 1.0199999809265137, 1.0, 1.090000033378601, 1.1699999570846558, 0.8999999761581421, 0.980000190734863, -0.0, 0.9599999785423279, 0.9900000095367432, 1.0399999618530273, -0.0, 1.05999942779541, -0.0, 0.9700000286102295, 0.9700000286102295, 0.9800000190734863, 0.9599999785423279, 1.05999942779541, 0.9399999976158142]
Epoch15 = [0.5199999809265137, 0.0, 0.20999999344348907, 1.0099999904632568, 1.149999976158142, 0.0599999865889549, 0.49000000953674316, 0.44999998807907104, 0.9800000190734863, 0.9700000286102295, 1.110000143051147, 0.9599999785423279, 0.9599999785423279, 1.0499999523162842, 1.0099999904632568, 1.200000476837158, 1.0499999523162842, 0.9700000286102295, 0.9800000190734863, 1.0800000429153442, 1.139999856948853, 1.0, 0.9599999785423279, 1.0299999713897705, 1.0499999523162842, 0.9100000262260437, 1.009999904632568, 0.9200000166893005, 0.9800000190734863, 1.0099999904632568, 0.9599999785423279, 0.980000190734863, 1.0099999904632568, 1.0199999809265137, 1.0099999904632568, 0.9900000095367432, 1.029999713897705, 1.0, 1.0099999904632568, 0.9900000095367432, 1.0099999904632568, 0.9700000286102295, 1.0, 0.800000190734863, 1.0, 0.9399999976158142, 1.0299999713897705, 0.9900000095367432, 0.959999785423279, 0.9900000095367432, 0.9900000095367432, 0.9900000095367432, 0.9700000286102295, 1.019999809265137, 1.0, 1.090000033378601, 1.1699999570846558, 0.8999999761581421, 0.9800000190734863, -0.0, 0.599999785423279, 0.9800000190734863, 1.0399999618530273, -0.0, 1.059999942779541, -0.0, 0.970000286102295, 0.9700000286102295, 0.9800000190734863, 0.9700000286102295, 1.059999942779541, 0.939999976158142]
Epoch16 = [0.5099999904632568, -0.0, 0.18000000715255737, 1.0099999904632568, 1.159999966621399, 0.02999999329447746, 0.47999998927116394, 0.41999998688697815, 0.9800000190734863, 0.9700000286102295, 1.110000143051147, 0.9700000286102295, 0.9599999785423279, 1.059999942779541, 1.0099999904632568, 1.210000381469727, 1.0499999523162842, 0.9700000286102295, 0.9800000190734863, 1.0800000429153442, 1.14999976158142, 1.0, 0.9599999785423279, 1.0399999618530273, 1.0499999523162842, 0.9100000262260437, 1.009999904632568, 0.9200000166893005, 0.9800000190734863, 1.0099999904632568, 0.949999988079071, 0.980000190734863, 1.0, 1.0199999809265137, 1.0099999904632568, 0.9900000095367432, 1.0299999713897705, 1.0, 1.099999904632568, 0.9900000095367432, 1.0199999809265137, 0.9700000286102295, 1.0, 0.980000190734863, 1.0, 0.9300000071525574, 1.0299999713897705, 0.9900000095367432, 0.9599999785423279, 0.990000095367432, 0.9900000095367432, 0.9900000095367432, 0.9700000286102295, 1.0299999713897705, 1.0, 1.09000033378601, 1.1699999570846558, 0.8999999761581421, 0.9800000190734863, 0.0, 0.9599999785423279, 0.980000190734863, 1.0399999618530273, 0.0, 1.059999942779541, 0.0, 0.9700000286102295, 0.970000286102295, 0.9800000190734863, 0.9700000286102295, 1.059999942779541, 0.9399999976158142]
Epoch17 = [0.49000000953674316, 0.0, 0.17000000178813934, 1.0099999904632568, 1.159999966621399, 0.0, 0.4799998927116394, 0.41999998688697815, 0.9800000190734863, 0.9700000286102295, 1.1200000047683716, 0.970000286102295, 0.9599999785423279, 1.059999942779541, 1.0099999904632568, 1.2100000381469727, 1.049999523162842, 0.9700000286102295, 0.9800000190734863, 1.090000033378601, 1.149999976158142, 1.0, 0.959999785423279, 1.0299999713897705, 1.059999942779541, 0.8999999761581421, 1.0099999904632568, 0.920000166893005, 0.9700000286102295, 1.0099999904632568, 0.949999988079071, 0.9800000190734863, 1.0, 1.019999809265137, 1.0099999904632568, 0.9900000095367432, 1.0299999713897705, 1.0, 1.0099999904632568, 0.990000095367432, 1.0199999809265137, 0.9599999785423279, 1.0, 0.9800000190734863, 1.0, 0.930000071525574, 1.0299999713897705, 0.9800000190734863, 0.9599999785423279, 0.9900000095367432, 0.990000095367432, 0.9900000095367432, 0.9700000286102295, 1.0199999809265137, 1.0, 1.090000033378601, 1.169999570846558, 0.8999999761581421, 0.9800000190734863, -0.0, 0.949999988079071, 0.9700000286102295, 1.039999618530273, -0.0, 1.059999942779541, -0.0, 0.9700000286102295, 0.9599999785423279, 0.980000190734863, 0.9700000286102295, 1.059999942779541, 0.9300000071525574]
Epoch18 = [0.44999998807907104, 0.0, 0.14000000059604645, 1.0099999904632568, 1.1699999570846558, 0.0, 0.4499998807907104, 0.38999998569488525, 0.9700000286102295, 0.9700000286102295, 1.1299999952316284, 0.980000190734863, 0.9599999785423279, 1.0499999523162842, 1.0099999904632568, 1.2100000381469727, 1.049999523162842, 0.9700000286102295, 0.9800000190734863, 1.090000033378601, 1.159999966621399, 1.0, 0.959999785423279, 1.0399999618530273, 1.059999942779541, 0.8999999761581421, 1.0099999904632568, 0.920000166893005, 0.9700000286102295, 1.0, 0.949999988079071, 0.9800000190734863, 1.0, 1.019999809265137, 1.0099999904632568, 0.9900000095367432, 1.0299999713897705, 1.0099999904632568, 1.009999904632568, 0.9900000095367432, 1.0199999809265137, 0.9599999785423279, 1.0, 0.9800000190734863, 1.0, 0.200000166893005, 1.0199999809265137, 0.9800000190734863, 0.9599999785423279, 0.9900000095367432, 0.990000095367432, 0.9900000095367432, 0.9700000286102295, 1.0199999809265137, 0.9900000095367432, 1.09000033378601, 1.1699999570846558, 0.8999999761581421, 0.9800000190734863, -0.0, 0.9399999976158142, 0.959999785423279, 1.0399999618530273, -0.0, 1.059999942779541, -0.0, 0.9700000286102295, 0.959999785423279, 0.9800000190734863, 0.9700000286102295, 1.059999942779541, 0.9300000071525574]
Epoch19 = [0.4099999964237213, 0.0, 0.07999999821186066, 1.0199999809265137, 1.1799999475479126, -0.0, 0.409999964237213, 0.3499999940395355, 0.9700000286102295, 0.9700000286102295, 1.149999976158142, 0.980000190734863, 0.9599999785423279, 1.0499999523162842, 1.0, 1.2200000286102295, 1.0499999523162842, 0.970000286102295, 0.9900000095367432, 1.100000023841858, 1.159999966621399, 1.0099999904632568, 0.959999785423279, 1.0399999618530273, 1.059999942779541, 0.8999999761581421, 1.0099999904632568, 0.920000166893005, 0.9599999785423279, 1.0, 0.9399999976158142, 0.9800000190734863, 1.0, 1.019999809265137, 1.0099999904632568, 0.9900000095367432, 1.0299999713897705, 1.0099999904632568, 1.009999904632568, 0.9900000095367432, 1.0099999904632568, 0.9599999785423279, 1.0, 0.9800000190734863, 1.0, 0.200000166893005, 1.0199999809265137, 0.9800000190734863, 0.9599999785423279, 0.9900000095367432, 0.990000095367432, 0.9800000190734863, 0.9599999785423279, 1.0199999809265137, 0.9900000095367432, 1.09000033378601, 1.1699999570846558, 0.8899999856948853, 0.9800000190734863, 0.0, 0.9300000071525574, 0.930000071525574, 1.0399999618530273, 0.0, 1.059999942779541, 0.0, 0.9700000286102295, 0.94999988079071, 0.9800000190734863, 0.9700000286102295, 1.059999942779541, 0.9300000071525574]
Epoch20 = [0.38999998569488525, -0.0, 0.029999999329447746, 1.0299999713897705, 1.2000000476837158, 0.0, 0.499999940395355, 0.30000001192092896, 0.9700000286102295, 0.9700000286102295, 1.1699999570846558, 0.980000190734863, 0.9599999785423279, 1.059999942779541, 1.0, 1.2200000286102295, 1.0499999523162842, 0.970000286102295, 0.9900000095367432, 1.100000023841858, 1.159999966621399, 1.0099999904632568, 0.94999988079071, 1.0299999713897705, 1.059999942779541, 0.8999999761581421, 1.0, 0.9200000166893005, 0.959999785423279, 1.0, 0.9399999976158142, 0.9800000190734863, 1.0, 1.0199999809265137, 1.009999904632568, 0.9900000095367432, 1.0299999713897705, 1.0099999904632568, 1.0099999904632568, 0.990000095367432, 1.0099999904632568, 0.9599999785423279, 0.9900000095367432, 0.9800000190734863, 1.0, 0.920000166893005, 1.0199999809265137, 0.9800000190734863, 0.9599999785423279, 0.9800000190734863, 0.990000095367432, 0.9800000190734863, 0.9599999785423279, 1.0199999809265137, 0.9900000095367432, 1.09000033378601, 1.1699999570846558, 0.8899999856948853, 0.9800000190734863, 0.0, 0.9200000166893005, 0.899999761581421, 1.0499999523162842, 0.0, 1.059999942779541, 0.0, 0.9700000286102295, 0.94999988079071, 0.9800000190734863, 0.9700000286102295, 1.059999942779541, 0.9200000166893005]
Epoch21 = [0.36000001430511475, 0.0, -0.0, 1.0299999713897705, 1.2100000381469727, -0.0, 0.2899999165534973, 0.25, 0.9700000286102295, 0.9599999785423279, 1.2000000476837158, 0.9900000095367432, 0.959999785423279, 1.059999942779541, 1.0, 1.2200000286102295, 1.0399999618530273, 0.9700000286102295, 0.990000095367432, 1.100000023841858, 1.159999966621399, 1.0099999904632568, 0.949999988079071, 1.029999713897705, 1.059999942779541, 0.8999999761581421, 1.0, 0.9200000166893005, 0.9599999785423279, 1.0, 0.399999976158142, 0.9800000190734863, 1.0, 1.0199999809265137, 1.0099999904632568, 0.990000095367432, 1.0299999713897705, 1.0099999904632568, 1.0099999904632568, 0.9900000095367432, 1.009999904632568, 0.9599999785423279, 0.9900000095367432, 0.9800000190734863, 1.0, 0.9100000262260437, 1.009999904632568, 0.9800000190734863, 0.9599999785423279, 0.9800000190734863, 0.9800000190734863, 0.980000190734863, 0.9599999785423279, 1.0199999809265137, 0.9900000095367432, 1.100000023841858, 1.169999570846558, 0.8899999856948853, 0.9800000190734863, -0.0, 0.9100000262260437, 0.8600000143051147, 1.049999523162842, -0.0, 1.059999942779541, -0.0, 0.9599999785423279, 0.949999988079071, 0.970000286102295, 0.9700000286102295, 1.059999942779541, 0.9200000166893005]
Epoch22 = [0.3100000023841858, 0.0, -0.0, 1.0399999618530273, 1.2300000190734863, -0.0, 0.2399999463558197, 0.20000000298023224, 0.9700000286102295, 0.9599999785423279, 1.2100000381469727, 0.990000095367432, 0.9599999785423279, 1.0499999523162842, 1.0, 1.2200000286102295, 1.0499999523162842, 0.970000286102295, 0.9900000095367432, 1.1100000143051147, 1.1699999570846558, 1.0099999904632568, 0.94999988079071, 1.0299999713897705, 1.0700000524520874, 0.8999999761581421, 1.0, 0.9200000166893005, 0.959999785423279, 1.0, 0.9300000071525574, 0.9800000190734863, 1.0, 1.0199999809265137, 1.009999904632568, 0.9800000190734863, 1.0299999713897705, 1.0099999904632568, 1.0099999904632568, 0.990000095367432, 1.0099999904632568, 0.9599999785423279, 0.9900000095367432, 0.9800000190734863, 1.0, 0.910000262260437, 1.0099999904632568, 0.9800000190734863, 0.9599999785423279, 0.9800000190734863, 0.980000190734863, 0.9800000190734863, 0.9599999785423279, 1.0199999809265137, 0.9900000095367432, 1.10000023841858, 1.1799999475479126, 0.8799999952316284, 0.9700000286102295, 0.0, 0.8999999761581421, 0.80000011920929, 1.0499999523162842, 0.0, 1.059999942779541, 0.0, 0.9599999785423279, 0.939999976158142, 0.9700000286102295, 0.9700000286102295, 1.059999942779541, 0.9100000262260437]
Epoch23 = [0.28999999165534973, -0.0, 0.0, 1.0499999523162842, 1.2400000095367432, 0.0, 0.2099999344348907, 0.18000000715255737, 0.9599999785423279, 0.9599999785423279, 1.2200000286102295, 0.990000095367432, 0.9599999785423279, 1.059999942779541, 1.0, 1.2300000190734863, 1.0499999523162842, 0.970000286102295, 0.9900000095367432, 1.1100000143051147, 1.1699999570846558, 1.0099999904632568, 0.94999988079071, 1.0299999713897705, 1.0700000524520874, 0.8999999761581421, 1.0, 0.9200000166893005, 0.94999988079071, 0.9900000095367432, 0.9300000071525574, 0.9800000190734863, 0.9900000095367432, 1.019999809265137, 1.0, 0.9900000095367432, 1.0299999713897705, 1.0199999809265137, 1.0199999809265137, 0.990000095367432, 1.0099999904632568, 0.9599999785423279, 0.9900000095367432, 0.9800000190734863, 1.0, 0.910000262260437, 1.0099999904632568, 0.9800000190734863, 0.9599999785423279, 0.9800000190734863, 0.980000190734863, 0.9700000286102295, 0.9599999785423279, 1.0199999809265137, 0.9900000095367432, 1.10000023841858, 1.1799999475479126, 0.8799999952316284, 0.9700000286102295, 0.0, 0.8899999856948853, 0.769999809265137, 1.0499999523162842, 0.0, 1.0700000524520874, 0.0, 0.9599999785423279, 0.930000071525574, 0.9700000286102295, 0.9800000190734863, 1.059999942779541, 0.9100000262260437]
Epoch24 = [0.2800000011920929, 0.0, 0.0, 1.0499999523162842, 1.2400000095367432, 0.0, 0.2000000298023224, 0.18000000715255737, 0.9599999785423279, 0.9599999785423279, 1.2200000286102295, 1.0, 0.959999785423279, 1.059999942779541, 1.0, 1.2300000190734863, 1.0399999618530273, 0.9700000286102295, 0.990000095367432, 1.1100000143051147, 1.1699999570846558, 1.0099999904632568, 0.949999988079071, 1.029999713897705, 1.0700000524520874, 0.8999999761581421, 1.0, 0.9100000262260437, 0.949999988079071, 0.990000095367432, 0.9300000071525574, 0.9800000190734863, 0.9900000095367432, 1.0199999809265137, 1.009999904632568, 0.9800000190734863, 1.0299999713897705, 1.0199999809265137, 1.0199999809265137, 0.990000095367432, 1.0099999904632568, 0.9599999785423279, 0.9900000095367432, 0.9800000190734863, 1.0, 0.899999761581421, 1.0, 0.9900000095367432, 0.9599999785423279, 0.9800000190734863, 0.9800000190734863, 0.970000286102295, 0.9599999785423279, 1.0199999809265137, 0.9900000095367432, 1.100000023841858, 1.169999570846558, 0.8799999952316284, 0.9700000286102295, -0.0, 0.8799999952316284, 0.7599999904632568, 1.049999523162842, -0.0, 1.059999942779541, -0.0, 0.9599999785423279, 0.9300000071525574, 0.959999785423279, 0.9800000190734863, 1.059999942779541, 0.8999999761581421]
Epoch25 = [0.27000001072883606, -0.0, -0.0, 1.059999942779541, 1.25, 0.0, 0.15000000596046448, 0.1800000715255737, 0.9599999785423279, 0.9599999785423279, 1.2200000286102295, 1.0, 0.9599999785423279, 1.05999942779541, 1.0, 1.2300000190734863, 1.0399999618530273, 0.9700000286102295, 0.9900000095367432, 1.110000143051147, 1.1699999570846558, 1.0099999904632568, 0.949999988079071, 1.0299999713897705, 1.070000524520874, 0.8899999856948853, 1.0, 0.9100000262260437, 0.949999988079071, 0.9900000095367432, 0.930000071525574, 0.9800000190734863, 0.9900000095367432, 1.0199999809265137, 1.0099999904632568, 0.980000190734863, 1.0299999713897705, 1.0199999809265137, 1.0199999809265137, 0.9900000095367432, 1.009999904632568, 0.9599999785423279, 0.9900000095367432, 0.9800000190734863, 1.0, 0.8999999761581421, 1.0, 0.900000095367432, 0.9599999785423279, 0.9800000190734863, 0.9800000190734863, 0.9700000286102295, 0.959999785423279, 1.0199999809265137, 0.9900000095367432, 1.100000023841858, 1.1799999475479126, 0.879999952316284, 0.9700000286102295, -0.0, 0.8700000047683716, 0.7200000286102295, 1.0499999523162842, -0.0,1.059999942779541, -0.0, 0.9599999785423279, 0.9300000071525574, 0.9599999785423279, 0.980000190734863, 1.059999942779541, 0.8999999761581421]
Epoch26 = [0.25, 0.0, 0.0, 1.059999942779541, 1.2599999904632568, -0.0, 0.10999999940395355, 0.159999964237213, 0.9599999785423279, 0.9599999785423279, 1.2300000190734863, 1.0099999904632568, 0.959999785423279, 1.059999942779541, 1.0, 1.2300000190734863, 1.0399999618530273, 0.9700000286102295, 0.990000095367432, 1.1200000047683716, 1.1799999475479126, 1.0099999904632568, 0.9399999976158142, 1.029999713897705, 1.0800000429153442, 0.8899999856948853, 1.0099999904632568, 0.9100000262260437, 0.94999988079071, 0.9900000095367432, 0.9200000166893005, 0.9800000190734863, 1.0, 1.0199999809265137, 1.009999904632568, 0.9800000190734863, 1.0299999713897705, 1.0199999809265137, 1.0199999809265137, 0.990000095367432, 1.0099999904632568, 0.949999988079071, 0.9900000095367432, 0.9700000286102295, 1.0, 0.889999856948853, 1.0, 0.9900000095367432, 0.949999988079071, 0.9900000095367432, 0.9800000190734863, 0.970000286102295, 0.949999988079071, 1.0199999809265137, 0.9900000095367432, 1.100000023841858, 1.169999570846558, 0.8700000047683716, 0.9700000286102295, 0.0, 0.8700000047683716, 0.6800000071525574, 1.049999523162842, 0.0, 1.059999942779541, 0.0, 0.9599999785423279, 0.9300000071525574, 0.959999785423279, 0.9800000190734863, 1.059999942779541, 0.8999999761581421]
Epoch27 = [0.2199999988079071, -0.0, -0.0, 1.0700000524520874, 1.2699999809265137, -0.0, 0.0900000357627869, 0.15000000596046448, 0.9599999785423279, 0.9599999785423279, 1.2400000095367432, 1.019999809265137, 0.9599999785423279, 1.059999942779541, 1.0, 1.2300000190734863, 1.0399999618530273, 0.970000286102295, 0.9900000095367432, 1.1200000047683716, 1.1799999475479126, 1.0099999904632568, 0.939999976158142, 1.0199999809265137, 1.0700000524520874, 0.8899999856948853, 1.0099999904632568, 0.910000262260437, 0.949999988079071, 0.9900000095367432, 0.9200000166893005, 0.9800000190734863, 1.0, 1.019999809265137, 1.0099999904632568, 0.9800000190734863, 1.0299999713897705, 1.0199999809265137, 1.009999904632568, 0.9900000095367432, 1.0099999904632568, 0.949999988079071, 0.9800000190734863, 0.980000190734863, 1.0, 0.8899999856948853, 1.0, 0.9900000095367432, 0.949999988079071, 0.990000095367432, 0.9800000190734863, 0.9700000286102295, 0.949999988079071, 1.0199999809265137, 0.990000095367432, 1.100000023841858, 1.1799999475479126, 0.8700000047683716, 0.9700000286102295, -0.0, 0.860000143051147, 0.6600000262260437, 1.059999942779541, -0.0, 1.0700000524520874, -0.0, 0.959999785423279, 0.9200000166893005, 0.9599999785423279, 0.9800000190734863, 1.0499999523162842, 0.889999856948853]
Epoch28 = [0.18000000715255737, -0.009999999776482582, -0.0, 1.0700000524520874, 1.2699999809265137, -0.0, 0.7999999821186066, 0.14000000059604645, 0.9599999785423279, 0.9599999785423279, 1.25, 1.029999713897705, 0.9599999785423279, 1.059999942779541, 1.0, 1.2200000286102295, 1.0399999618530273, 0.970000286102295, 0.9900000095367432, 1.1200000047683716, 1.1799999475479126, 1.0099999904632568, 0.939999976158142, 1.0299999713897705, 1.0800000429153442, 0.8899999856948853, 1.0, 0.9100000262260437, 0.94999988079071, 0.9900000095367432, 0.9200000166893005, 0.9800000190734863, 1.0, 1.0199999809265137, 1.009999904632568, 0.9700000286102295, 1.0299999713897705, 1.0199999809265137, 1.0099999904632568, 1.0, 1.009999904632568, 0.9599999785423279, 0.9800000190734863, 0.9800000190734863, 1.0, 0.8899999856948853, 1.0, 1., 0.949999988079071, 0.9800000190734863, 0.9700000286102295, 0.9700000286102295, 0.94999988079071, 1.0199999809265137, 0.9900000095367432, 1.100000023841858, 1.1799999475479126, 0.870000047683716, 0.9700000286102295, -0.0, 0.8600000143051147, 0.6600000262260437, 1.059999942779541, -0.0,1.0700000524520874, -0.0, 0.9599999785423279, 0.9200000166893005, 0.9599999785423279, 0.990000095367432, 1.0499999523162842, 0.8899999856948853]
Epoch29 = [0.15000000596046448, -0.009999999776482582, 0.0, 1.0700000524520874, 1.2699999809265137, 0.0, 0.5000000074505806, 0.10999999940395355, 0.9599999785423279, 0.9599999785423279, 1.25, 1.029999713897705, 0.949999988079071, 1.059999942779541, 1.0, 1.2300000190734863, 1.0399999618530273, 0.970000286102295, 0.9900000095367432, 1.1200000047683716, 1.1799999475479126, 1.0099999904632568, 0.939999976158142, 1.0199999809265137, 1.0800000429153442, 0.8899999856948853, 1.0, 0.9100000262260437, 0.94999988079071, 0.9900000095367432, 0.9200000166893005, 0.9800000190734863, 1.0, 1.0199999809265137, 1.009999904632568, 0.9700000286102295, 1.0299999713897705, 1.0199999809265137, 1.0099999904632568, 1.0, 1.009999904632568, 0.9599999785423279, 0.9800000190734863, 0.9800000190734863, 1.0, 0.8899999856948853, 1.0, 1.099999904632568, 0.949999988079071, 0.9800000190734863, 0.9700000286102295, 0.9700000286102295, 0.94999988079071, 1.0199999809265137, 0.9900000095367432, 1.100000023841858, 1.190000057220459, 0.870000047683716, 0.9700000286102295, 0.0, 0.8600000143051147, 0.6600000262260437, 1.059999942779541, 0.0, 1.700000524520874, 0.0, 0.9599999785423279, 0.9200000166893005, 0.9599999785423279, 0.990000095367432, 1.0499999523162842, 0.8899999856948853]
Epoch30 = [0.10999999940395355, -0.0, -0.0, 1.059999942779541, 1.2799999713897705, 0.0, 0.019999999552965164, 0.07999999821186066, 0.9599999785423279, 0.9599999785423279, 1.2599999904632568, 1.0299999713897705, 0.949999988079071, 1.059999942779541, 0.9900000095367432, 1.2300000190734863, 1.0399999618530273, 0.9700000286102295, 0.9900000095367432, 1.1299999952316284, 1.190000057220459, 1.0099999904632568, 0.9399999976158142, 1.0199999809265137, 1.0800000429153442, 0.8799999952316284, 1.0, 0.9100000262260437, 0.949999988079071, 0.9900000095367432, 0.9200000166893005, 0.9800000190734863, 0.9900000095367432, 1.0199999809265137, 1.0099999904632568, 0.9700000286102295, 1.0299999713897705, 1.0199999809265137, 1.0099999904632568, 1.0, 1.0099999904632568, 0.949999988079071, 0.9800000190734863, 0.9700000286102295, 1.0, 0.8899999856948853, 1.0, 1.0099999904632568, 0.949999988079071, 0.9800000190734863, 0.9700000286102295, 0.9700000286102295, 0.949999988079071, 1.0099999904632568, 0.9900000095367432, 1.100000023841858, 1.190000057220459, 0.8700000047683716, 0.9700000286102295, 0.0, 0.8600000143051147, 0.6399999856948853, 1.059999942779541, 0.0, 1.0700000524520874, 0.0, 0.9599999785423279, 0.9200000166893005, 0.949999988079071, 0.9900000095367432, 1.0499999523162842, 0.8799999952316284]

# 获取第30个epoch的因子值
epoch30_factors = Epoch30
scaling_factors_history = [ Epoch0, Epoch1, Epoch2, Epoch3, Epoch4, Epoch5, Epoch6, Epoch7, Epoch8, Epoch9, Epoch10, Epoch11, Epoch12, Epoch13, Epoch14, Epoch15, Epoch16, Epoch17, Epoch18, Epoch19, Epoch20, Epoch21, Epoch22, Epoch23, Epoch24, Epoch25, Epoch26, Epoch27, Epoch28, Epoch29, Epoch30 ]
# 找到最大的5个因子和最小的5个因子的下标
top_k_indices = np.argsort(epoch30_factors)[-5:]
bottom_k_indices = np.argsort(epoch30_factors)[:5]

# 初始化列表存储各个epoch的因子值
top_k_factors = []
bottom_k_factors = []

# 提取每个epoch的对应因子值
for scaling_factors in scaling_factors_history:
    top_k_factors.append([scaling_factors[idx] for idx in top_k_indices])
    bottom_k_factors.append([scaling_factors[idx] for idx in bottom_k_indices])

# 创建存放图片的文件夹
fig_dir = "figs"
if not os.path.exists(fig_dir):
    os.makedirs(fig_dir)

# 定义图片存放路径
curr_time = "current_time"  # 替换为实际时间字符串
tb_k_fig_path = os.path.join(fig_dir, f"tb_k_factors_{curr_time}.png")

# 将收集的缩放因子数据转换为数组
top_k_factors = np.array(top_k_factors)
bottom_k_factors = np.array(bottom_k_factors)

# 设置横坐标和纵坐标范围以及刻度
epochs = np.arange(1, len(scaling_factors_history) + 1)
x_ticks = np.arange(0, 31, 5)
y_ticks = np.arange(0, 1.5, 0.5)

# 设置字体
plt.rcParams["font.family"] = "Times New Roman"
plt.rcParams["font.weight"] = "bold"
plt.rcParams["font.size"] = 16

# 绘制缩放因子的散点图和折线图
plt.figure(figsize=(6, 6))
for i in range(5):
    plt.scatter(epochs, top_k_factors[:, i], label=f'{top_k_indices[i]}')  # 不显示 "feature"
    plt.plot(epochs, top_k_factors[:, i])
for i in range(5):
    plt.scatter(epochs, bottom_k_factors[:, i], label=f'{bottom_k_indices[i]}', color='brown')  # 不显示 "feature"
    plt.plot(epochs, bottom_k_factors[:, i], color='brown')

# 设置坐标轴标签和图例
plt.xlabel('Epoch', fontweight='bold')
plt.ylabel('Scaling Factor Value', fontweight='bold')
plt.ylim(0, 1.5)

# 修改图例，将top_k_indices放在第一行，bottom_k_indices放在第二行
plt.legend(ncol=5, loc='upper right', bbox_to_anchor=(1, 1), prop={'size': 12})

# 自动调整布局以适应图例
plt.tight_layout()

# 获取当前时间
current_time = time.strftime("%Y%m%d%H%M%S", time.localtime())

# 保存并显示图像，裁剪白边并设置更高的 DPI
plt.savefig(f'{current_time}_Resnet_microF1_vs_features.png', dpi=600, bbox_inches='tight', pad_inches=0.1)
plt.show()
